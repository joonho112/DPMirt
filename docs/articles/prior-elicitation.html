<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Principled Prior Elicitation for the DP Concentration Parameter • DPMirt</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Principled Prior Elicitation for the DP Concentration Parameter">
<meta name="description" content="Learn why the DP concentration parameter alpha matters, how the Paganin
default compares to principled elicitation via DPprior, and how to integrate both approaches into your DPMirt workflow --- including sensitivity analysis and custom base measure tuning.
">
<meta property="og:description" content="Learn why the DP concentration parameter alpha matters, how the Paganin
default compares to principled elicitation via DPprior, and how to integrate both approaches into your DPMirt workflow --- including sensitivity analysis and custom base measure tuning.
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DPMirt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><h6 class="dropdown-header" data-toc-skip>--- Getting Started ---</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/quick-start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/models-and-workflow.html">Models &amp; Workflow</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>--- Theory &amp; Methods ---</h6></li>
    <li><a class="dropdown-item" href="../articles/theory-irt-dpm.html">IRT &amp; DPM Theory</a></li>
    <li><a class="dropdown-item" href="../articles/posterior-summaries.html">Posterior Summaries</a></li>
    <li><a class="dropdown-item" href="../articles/prior-elicitation.html">Prior Elicitation</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>--- Advanced ---</h6></li>
    <li><a class="dropdown-item" href="../articles/nimble-internals.html">NIMBLE Internals</a></li>
    <li><a class="dropdown-item" href="../articles/simulation-study.html">Simulation Study</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joonho112/DPMirt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Principled Prior Elicitation for the DP Concentration Parameter</h1>
                        <h4 data-toc-skip class="author">JoonHo Lee</h4>
            
            <h4 data-toc-skip class="date">2026-02-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/joonho112/DPMirt/blob/HEAD/vignettes/prior-elicitation.Rmd" class="external-link"><code>vignettes/prior-elicitation.Rmd</code></a></small>
      <div class="d-none name"><code>prior-elicitation.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Every Dirichlet Process Mixture (DPM) model contains a concentration
parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
that controls how much the nonparametric prior deviates from a single
parametric component. Choosing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
well is not just a technical detail — it shapes cluster formation,
posterior shrinkage, and the balance between flexibility and
parsimony.</p>
<p>This vignette covers:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Why
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
matters</strong> — its three operational dimensions.</li>
<li>
<strong>Paganin default vs. principled elicitation</strong> — when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Gamma</mtext><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>3</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{Gamma}(1,3)</annotation></semantics></math>
is adequate and when it is not.</li>
<li>
<strong>DPprior integration</strong> — three routes to set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
in DPMirt.</li>
<li>
<strong>Two strategies from Lee (2026)</strong> — DP-diffuse and
DP-inform.</li>
<li>
<strong>Sensitivity analysis</strong> — comparing posteriors under
different priors.</li>
<li>
<strong>Fallback behavior</strong> — what happens when DPprior is
not installed.</li>
<li>
<strong>Custom base measure tuning</strong> — advanced
hyperparameter control.</li>
</ol>
</div>
<div class="section level2">
<h2 id="why-alpha-matters">Why Alpha Matters<a class="anchor" aria-label="anchor" href="#why-alpha-matters"></a>
</h2>
<p>The concentration parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
operates along three dimensions that jointly determine the behavior of
the DP prior.</p>
<div class="section level3">
<h3 id="dimension-1-number-of-clusters">Dimension 1: Number of Clusters<a class="anchor" aria-label="anchor" href="#dimension-1-number-of-clusters"></a>
</h3>
<p>The expected number of distinct clusters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
among
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
observations is approximately</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">E</mi><mo stretchy="false" form="prefix">[</mo><mi>K</mi><mo>∣</mo><mi>α</mi><mo>,</mo><mi>N</mi><mo stretchy="false" form="postfix">]</mo><mo>≈</mo><mi>α</mi><mrow><mi mathvariant="normal">log</mi><mo>⁡</mo></mrow><mspace width="-0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mfrac><mi>N</mi><mi>α</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\mathrm{E}[K \mid \alpha, N] \approx \alpha \log\!\left(1 + \frac{N}{\alpha}\right).
</annotation></semantics></math></p>
<p>Larger
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
implies more clusters; smaller
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
concentrates the posterior onto fewer groups.</p>
</div>
<div class="section level3">
<h3 id="dimension-2-weight-concentration">Dimension 2: Weight Concentration<a class="anchor" aria-label="anchor" href="#dimension-2-weight-concentration"></a>
</h3>
<p>The first stick-breaking weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mn>1</mn></msub><annotation encoding="application/x-tex">w_1</annotation></semantics></math>
follows
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Beta</mtext><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>α</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{Beta}(1, \alpha)</annotation></semantics></math>.
When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
is small,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">E</mi><mo stretchy="false" form="prefix">[</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\mathrm{E}[w_1]</annotation></semantics></math>
is large and most mass is captured by a single component. When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
is large, mass spreads across many components.</p>
</div>
<div class="section level3">
<h3 id="dimension-3-posterior-shrinkage">Dimension 3: Posterior Shrinkage<a class="anchor" aria-label="anchor" href="#dimension-3-posterior-shrinkage"></a>
</h3>
<p>In IRT, the prior on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
acts as a regularizer. A DPM prior with small
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
shrinks person abilities toward fewer cluster centers, closely
resembling a parametric Normal prior. A DPM prior with large
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
allows each person to retain more of their data-driven estimate,
reducing shrinkage at the cost of higher variance.</p>
<blockquote>
<p><strong>Key insight:</strong> The choice of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
is not merely a tuning knob — it encodes a substantive belief about the
heterogeneity of the latent trait distribution. Getting it wrong can
either mask genuine subgroups (too small) or fragment a homogeneous
population (too large).</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="paganin-default-vs--principled-elicitation">Paganin Default vs. Principled Elicitation<a class="anchor" aria-label="anchor" href="#paganin-default-vs--principled-elicitation"></a>
</h2>
<p>Paganin et al. (2023) use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>∼</mo><mtext mathvariant="normal">Gamma</mtext><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>3</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\alpha \sim \text{Gamma}(1, 3)</annotation></semantics></math>
as a default. This prior has mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">E</mi><mo stretchy="false" form="prefix">[</mo><mi>α</mi><mo stretchy="false" form="postfix">]</mo><mo>=</mo><mn>1</mn><mi>/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">\mathrm{E}[\alpha] = 1/3</annotation></semantics></math>
and is concentrated near zero, strongly favoring few clusters.</p>
<p>For many educational testing applications where the latent trait is
approximately unimodal, this default is reasonable. However, it can be
overly restrictive when: - The population is known to be heterogeneous
(e.g., mixed clinical groups). - Sample size is large
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>&gt;</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">N &gt; 500</annotation></semantics></math>)
and the data can support many clusters. - The research question
specifically concerns subgroup detection.</p>
<p>Lee (2026) provides a principled alternative through the
<strong>DPprior</strong> package, which translates a researcher’s belief
about the expected number of clusters into a calibrated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Gamma</mtext><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{Gamma}(a, b)</annotation></semantics></math>
hyperprior.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, length.out <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">dens_default</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">alpha_grid</span>, shape <span class="op">=</span> <span class="fl">1</span>, rate <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">alpha_grid</span>, <span class="va">dens_default</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">reference</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Paganin default: "</span>, <span class="va">alpha</span>, <span class="st">" ~ Gamma(1, 3)"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">reference</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">dens_default</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.8</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">E</span><span class="op">[</span><span class="va">alpha</span><span class="op">]</span> <span class="op">==</span> <span class="fu">.</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">reference</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="prior-elicitation_files/figure-html/paganin-default-1.png" class="r-plt" alt="The Paganin default Gamma(1, 3) prior for alpha, with implied E[alpha] = 0.33." width="85%"><p class="caption">
The Paganin default Gamma(1, 3) prior for alpha, with implied E[alpha] =
0.33.
</p>
</div>
</div>
<div class="section level2">
<h2 id="dpprior-integration">DPprior Integration<a class="anchor" aria-label="anchor" href="#dpprior-integration"></a>
</h2>
<p>DPMirt offers three ways to set the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
prior, ranging from fully automated to fully manual.</p>
<div class="section level3">
<h3 id="method-1-dpmirt_alpha_prior-wrapper">Method 1: <code>dpmirt_alpha_prior()</code> Wrapper<a class="anchor" aria-label="anchor" href="#method-1-dpmirt_alpha_prior-wrapper"></a>
</h3>
<p>The simplest approach is the standalone elicitation function, which
returns a named vector <code>c(a = ..., b = ...)</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Expect ~5 clusters among 200 persons, medium confidence</span></span>
<span><span class="va">ab</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_alpha_prior.html">dpmirt_alpha_prior</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">200</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, confidence <span class="op">=</span> <span class="st">"medium"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 60.4% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (RN-07).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="co">#&gt; Alpha prior: Gamma(1.85, 2.21) [E[alpha]=0.84]</span></span>
<span><span class="va">ab</span></span>
<span><span class="co">#&gt;        a        b </span></span>
<span><span class="co">#&gt; 1.848904 2.212652</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DPprior not installed --- showing expected output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Alpha prior: Gamma(1.60, 0.82) [E[alpha]=1.96]\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  a     b \n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"1.60  0.82\n"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="method-2-elicit-then-pass-to-dpmirt">Method 2: Elicit Then Pass to <code>dpmirt()</code><a class="anchor" aria-label="anchor" href="#method-2-elicit-then-pass-to-dpmirt"></a>
</h3>
<p>Elicit the prior first with <code><a href="../reference/dpmirt_alpha_prior.html">dpmirt_alpha_prior()</a></code>, then
pass the result directly as <code>alpha_prior</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ab</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_alpha_prior.html">dpmirt_alpha_prior</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">200</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, confidence <span class="op">=</span> <span class="st">"medium"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  model       <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  prior       <span class="op">=</span> <span class="st">"dpm"</span>,</span>
<span>  alpha_prior <span class="op">=</span> <span class="va">ab</span>,</span>
<span>  niter       <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  nburnin     <span class="op">=</span> <span class="fl">2000</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="method-3-manual-dpprior-workflow">Method 3: Manual DPprior Workflow<a class="anchor" aria-label="anchor" href="#method-3-manual-dpprior-workflow"></a>
</h3>
<p>For maximum control, call DPprior directly and pass the result:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JoonHoLee/DPprior" class="external-link">DPprior</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DPprior/man/DPprior_fit.html" class="external-link">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">200</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, confidence <span class="op">=</span> <span class="st">"medium"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 60.4% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (RN-07).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_prior</span><span class="op">)</span></span>
<span><span class="co">#&gt; DPprior Prior Elicitation Result</span></span>
<span><span class="co">#&gt; ============================================= </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Gamma Hyperprior: α ~ Gamma(a = 1.8489, b = 2.2127)</span></span>
<span><span class="co">#&gt;   E[α] = 0.836, SD[α] = 0.615</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Target (J = 200):</span></span>
<span><span class="co">#&gt;   E[K_J]   = 5.00</span></span>
<span><span class="co">#&gt;   Var(K_J) = 10.00</span></span>
<span><span class="co">#&gt;   (from confidence = 'medium')</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Achieved:</span></span>
<span><span class="co">#&gt;   E[K_J] = 5.000000, Var(K_J) = 10.000000</span></span>
<span><span class="co">#&gt;   Residual = 6.79e-11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method: A2-MN (6 iterations)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dominance Risk: HIGH ✘ (P(w₁&gt;0.5) = 60%)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pass the DPprior_fit object to dpmirt</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  model       <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  prior       <span class="op">=</span> <span class="st">"dpm"</span>,</span>
<span>  alpha_prior <span class="op">=</span> <span class="va">fit_prior</span>,</span>
<span>  niter       <span class="op">=</span> <span class="fl">10000</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="confidence-levels">Confidence Levels<a class="anchor" aria-label="anchor" href="#confidence-levels"></a>
</h3>
<p>The <code>confidence</code> argument controls how tightly the prior
concentrates around the expected cluster count. It maps to the variance
of the implied prior on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conf_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span><span class="op">)</span></span>
<span><span class="va">conf_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">conf_levels</span>, <span class="kw">function</span><span class="op">(</span><span class="va">cl</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DPprior/man/DPprior_fit.html" class="external-link">DPprior_fit</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fl">200</span>, mu_K <span class="op">=</span> <span class="fl">5</span>, confidence <span class="op">=</span> <span class="va">cl</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Confidence <span class="op">=</span> <span class="va">cl</span>,</span>
<span>    a          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fp</span><span class="op">$</span><span class="va">a</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    b          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fp</span><span class="op">$</span><span class="va">b</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    E_alpha    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fp</span><span class="op">$</span><span class="va">a</span> <span class="op">/</span> <span class="va">fp</span><span class="op">$</span><span class="va">b</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    CV_alpha   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">fp</span><span class="op">$</span><span class="va">a</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    Var_K      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fp</span><span class="op">$</span><span class="va">target</span><span class="op">$</span><span class="va">var_K</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 64.3% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (RN-07).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 60.4% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (RN-07).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 58.7% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (RN-07).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="va">conf_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">conf_results</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">conf_table</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Confidence levels and their implied hyperparameters (N = 200, mu_K = 5)."</span>,</span>
<span>             align <span class="op">=</span> <span class="st">"lccccc"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Confidence levels and their implied hyperparameters (N = 200,
mu_K = 5).</caption>
<thead><tr class="header">
<th align="left">Confidence</th>
<th align="center">a</th>
<th align="center">b</th>
<th align="center">E_alpha</th>
<th align="center">CV_alpha</th>
<th align="center">Var_K</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">low</td>
<td align="center">0.695</td>
<td align="center">0.779</td>
<td align="center">0.892</td>
<td align="center">1.200</td>
<td align="center">20</td>
</tr>
<tr class="even">
<td align="left">medium</td>
<td align="center">1.849</td>
<td align="center">2.213</td>
<td align="center">0.836</td>
<td align="center">0.735</td>
<td align="center">10</td>
</tr>
<tr class="odd">
<td align="left">high</td>
<td align="center">4.944</td>
<td align="center">6.087</td>
<td align="center">0.812</td>
<td align="center">0.450</td>
<td align="center">6</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Interpretation:</strong> Higher confidence concentrates the
Gamma prior (lower CV), constraining
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
and thereby the cluster count. Low confidence yields a diffuse prior
that lets the data determine cluster structure. All three levels share
the same prior mean for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
differing only in spread.</p>
</blockquote>
<p>Note that DPprior calls are analytic (closed-form or fast Newton
iteration) and complete in milliseconds — no MCMC is involved.</p>
</div>
</div>
<div class="section level2">
<h2 id="two-strategies-from-lee-2026">Two Strategies from Lee (2026)<a class="anchor" aria-label="anchor" href="#two-strategies-from-lee-2026"></a>
</h2>
<p>The APM manuscript (Lee &amp; Wind) identifies two complementary
approaches to specifying
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>:</p>
<div class="section level3">
<h3 id="dp-diffuse-exploratory">DP-Diffuse (Exploratory)<a class="anchor" aria-label="anchor" href="#dp-diffuse-exploratory"></a>
</h3>
<p>Use when you have little domain knowledge about population
heterogeneity. The goal is a prior that is minimally informative yet
properly calibrated to the sample size:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DP-diffuse: set mu_K to log(N), low confidence</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">mu_K_diffuse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  <span class="co"># ~5 for N=200</span></span>
<span></span>
<span><span class="va">ab_diffuse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_alpha_prior.html">dpmirt_alpha_prior</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">N</span>, mu_K <span class="op">=</span> <span class="va">mu_K_diffuse</span>,</span>
<span>                                  confidence <span class="op">=</span> <span class="st">"low"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 57.2% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (RN-07).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="co">#&gt; Alpha prior: Gamma(0.84, 0.74) [E[alpha]=1.14]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"DP-diffuse: Gamma("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ab_diffuse</span><span class="op">[</span><span class="st">"a"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">", "</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ab_diffuse</span><span class="op">[</span><span class="st">"b"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">")\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="co">#&gt; DP-diffuse: Gamma(0.84, 0.74)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  E[alpha] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ab_diffuse</span><span class="op">[</span><span class="st">"a"</span><span class="op">]</span> <span class="op">/</span> <span class="va">ab_diffuse</span><span class="op">[</span><span class="st">"b"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   E[alpha] = 1.14</span></span></code></pre></div>
<p>This is the strategy DPMirt uses when <code>mu_K = NULL</code> is
left at its default.</p>
</div>
<div class="section level3">
<h3 id="dp-inform-domain-driven">DP-Inform (Domain-Driven)<a class="anchor" aria-label="anchor" href="#dp-inform-domain-driven"></a>
</h3>
<p>Use when substantive knowledge suggests a specific number of latent
subgroups. For example, an assessment designed to distinguish remedial,
proficient, and advanced learners might target
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>K</mi></msub><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">\mu_K = 3</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DP-inform: domain-driven belief of 3 subgroups, high confidence</span></span>
<span><span class="va">ab_inform</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_alpha_prior.html">dpmirt_alpha_prior</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">200</span>, mu_K <span class="op">=</span> <span class="fl">3</span>, confidence <span class="op">=</span> <span class="st">"high"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: HIGH DOMINANCE RISK: P(w1 &gt; 0.5) = 77.8% exceeds 40%.</span></span>
<span><span class="co">#&gt;   This may indicate unintended prior behavior (RN-07).</span></span>
<span><span class="co">#&gt;   Consider using DPprior_dual() for weight-constrained elicitation.</span></span>
<span><span class="co">#&gt;   See ?DPprior_diagnostics for interpretation.</span></span>
<span><span class="co">#&gt; Alpha prior: Gamma(2.88, 7.61) [E[alpha]=0.38]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"DP-inform: Gamma("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ab_inform</span><span class="op">[</span><span class="st">"a"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">", "</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ab_inform</span><span class="op">[</span><span class="st">"b"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">")\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="co">#&gt; DP-inform: Gamma(2.88, 7.61)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  E[alpha] ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ab_inform</span><span class="op">[</span><span class="st">"a"</span><span class="op">]</span> <span class="op">/</span> <span class="va">ab_inform</span><span class="op">[</span><span class="st">"b"</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   E[alpha] = 0.38</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visual-comparison">Visual Comparison<a class="anchor" aria-label="anchor" href="#visual-comparison"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">8</span>, length.out <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dens_diffuse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">alpha_grid</span>, shape <span class="op">=</span> <span class="va">ab_diffuse</span><span class="op">[</span><span class="st">"a"</span><span class="op">]</span>,</span>
<span>                        rate <span class="op">=</span> <span class="va">ab_diffuse</span><span class="op">[</span><span class="st">"b"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dens_inform</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">alpha_grid</span>, shape <span class="op">=</span> <span class="va">ab_inform</span><span class="op">[</span><span class="st">"a"</span><span class="op">]</span>,</span>
<span>                        rate <span class="op">=</span> <span class="va">ab_inform</span><span class="op">[</span><span class="st">"b"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dens_paganin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">alpha_grid</span>, shape <span class="op">=</span> <span class="fl">1</span>, rate <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">alpha_grid</span>, <span class="va">dens_diffuse</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">semiparametric</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dens_diffuse</span>, <span class="va">dens_inform</span>, <span class="va">dens_paganin</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.1</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Alpha prior comparison"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">alpha_grid</span>, <span class="va">dens_inform</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">parametric</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">alpha_grid</span>, <span class="va">dens_paganin</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">reference</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DP-diffuse (low, mu_K=5)"</span>,</span>
<span>                   <span class="st">"DP-inform (high, mu_K=3)"</span>,</span>
<span>                   <span class="st">"Paganin Gamma(1,3)"</span><span class="op">)</span>,</span>
<span>       col    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pal</span><span class="op">$</span><span class="va">semiparametric</span>, <span class="va">pal</span><span class="op">$</span><span class="va">parametric</span>, <span class="va">pal</span><span class="op">$</span><span class="va">reference</span><span class="op">)</span>,</span>
<span>       lwd    <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="prior-elicitation_files/figure-html/compare-strategies-1.png" class="r-plt" alt="Comparing DP-diffuse and DP-inform alpha priors." width="85%"><p class="caption">
Comparing DP-diffuse and DP-inform alpha priors.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="sensitivity-analysis">Sensitivity Analysis<a class="anchor" aria-label="anchor" href="#sensitivity-analysis"></a>
</h2>
<p>A responsible Bayesian analysis examines how conclusions change under
different prior specifications. Here we compare posterior results from
three
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
priors applied to the same data.</p>
<p>The fits below were pre-computed. Each used a Rasch-DPM model on the
same bimodal data set
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">N = 200</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>=</mo><mn>25</mn></mrow><annotation encoding="application/x-tex">I = 25</annotation></semantics></math>):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">find_extdata</span><span class="op">(</span><span class="st">"vignette_sensitivity_fits.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># sens contains:</span></span>
<span><span class="co">#   $default   - Gamma(1, 3) [Paganin default]</span></span>
<span><span class="co">#   $broad     - DP-diffuse</span></span>
<span><span class="co">#   $inform    - DP-inform</span></span></code></pre></div>
<div class="section level3">
<h3 id="posterior-density-comparison">Posterior Density Comparison<a class="anchor" aria-label="anchor" href="#posterior-density-comparison"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract posterior mean theta for each fit</span></span>
<span><span class="va">est_paganin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_estimates.html">dpmirt_estimates</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">default</span>, methods <span class="op">=</span> <span class="st">"pm"</span><span class="op">)</span></span>
<span><span class="va">est_diffuse</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_estimates.html">dpmirt_estimates</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">broad</span>, methods <span class="op">=</span> <span class="st">"pm"</span><span class="op">)</span></span>
<span><span class="va">est_inform</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_estimates.html">dpmirt_estimates</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">inform</span>,  methods <span class="op">=</span> <span class="st">"pm"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dens_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">est_paganin</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_pm</span><span class="op">)</span></span>
<span><span class="va">dens_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">est_diffuse</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_pm</span><span class="op">)</span></span>
<span><span class="va">dens_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">est_inform</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_pm</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xlim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dens_p</span><span class="op">$</span><span class="va">x</span>, <span class="va">dens_d</span><span class="op">$</span><span class="va">x</span>, <span class="va">dens_i</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dens_p</span><span class="op">$</span><span class="va">y</span>, <span class="va">dens_d</span><span class="op">$</span><span class="va">y</span>, <span class="va">dens_i</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dens_p</span>, xlim <span class="op">=</span> <span class="va">xlim</span>, ylim <span class="op">=</span> <span class="va">ylim</span>, col <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">reference</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     lty <span class="op">=</span> <span class="fl">2</span>, main <span class="op">=</span> <span class="st">"Posterior theta density under different alpha priors"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">dens_d</span>, col <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">semiparametric</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">dens_i</span>, col <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">parametric</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Paganin Gamma(1,3)"</span>, <span class="st">"DP-diffuse"</span>, <span class="st">"DP-inform"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pal</span><span class="op">$</span><span class="va">reference</span>, <span class="va">pal</span><span class="op">$</span><span class="va">semiparametric</span>, <span class="va">pal</span><span class="op">$</span><span class="va">parametric</span><span class="op">)</span>,</span>
<span>       lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="prior-elicitation_files/figure-html/sensitivity-density-1.png" class="r-plt" alt="Posterior mean theta densities under three alpha priors.  When the data are informative, the posteriors converge despite different priors." width="85%"><p class="caption">
Posterior mean theta densities under three alpha priors. When the data
are informative, the posteriors converge despite different priors.
</p>
</div>
</div>
<div class="section level3">
<h3 id="cluster-count-comparison">Cluster Count Comparison<a class="anchor" aria-label="anchor" href="#cluster-count-comparison"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cluster_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Prior          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Paganin Gamma(1,3)"</span>, <span class="st">"DP-diffuse"</span>, <span class="st">"DP-inform"</span><span class="op">)</span>,</span>
<span>  Median_K       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">default</span><span class="op">$</span><span class="va">cluster_info</span><span class="op">$</span><span class="va">n_clusters</span><span class="op">)</span>,</span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">broad</span><span class="op">$</span><span class="va">cluster_info</span><span class="op">$</span><span class="va">n_clusters</span><span class="op">)</span>,</span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">inform</span><span class="op">$</span><span class="va">cluster_info</span><span class="op">$</span><span class="va">n_clusters</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Mean_K         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">default</span><span class="op">$</span><span class="va">cluster_info</span><span class="op">$</span><span class="va">n_clusters</span><span class="op">)</span>,</span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">broad</span><span class="op">$</span><span class="va">cluster_info</span><span class="op">$</span><span class="va">n_clusters</span><span class="op">)</span>,</span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">inform</span><span class="op">$</span><span class="va">cluster_info</span><span class="op">$</span><span class="va">n_clusters</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Posterior_alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">default</span><span class="op">$</span><span class="va">other_samp</span><span class="op">[</span>, <span class="st">"alpha"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">broad</span><span class="op">$</span><span class="va">other_samp</span><span class="op">[</span>, <span class="st">"alpha"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">inform</span><span class="op">$</span><span class="va">other_samp</span><span class="op">[</span>, <span class="st">"alpha"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  WAIC           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sens</span><span class="op">$</span><span class="va">default</span><span class="op">$</span><span class="va">waic</span>,</span>
<span>                     <span class="va">sens</span><span class="op">$</span><span class="va">broad</span><span class="op">$</span><span class="va">waic</span>,</span>
<span>                     <span class="va">sens</span><span class="op">$</span><span class="va">inform</span><span class="op">$</span><span class="va">waic</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">cluster_summary</span><span class="op">$</span><span class="va">Median_K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cluster_summary</span><span class="op">$</span><span class="va">Median_K</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">cluster_summary</span><span class="op">$</span><span class="va">Mean_K</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cluster_summary</span><span class="op">$</span><span class="va">Mean_K</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">cluster_summary</span><span class="op">$</span><span class="va">Posterior_alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cluster_summary</span><span class="op">$</span><span class="va">Posterior_alpha</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">cluster_summary</span><span class="op">$</span><span class="va">WAIC</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cluster_summary</span><span class="op">$</span><span class="va">WAIC</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">cluster_summary</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Sensitivity analysis: cluster counts and WAIC under three alpha priors."</span>,</span>
<span>             align <span class="op">=</span> <span class="st">"lcccc"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Sensitivity analysis: cluster counts and WAIC under three alpha
priors.</caption>
<thead><tr class="header">
<th align="left">Prior</th>
<th align="center">Median_K</th>
<th align="center">Mean_K</th>
<th align="center">Posterior_alpha</th>
<th align="center">WAIC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Paganin Gamma(1,3)</td>
<td align="center">3</td>
<td align="center">3.1</td>
<td align="center">0.377</td>
<td align="center">4010.5</td>
</tr>
<tr class="even">
<td align="left">DP-diffuse</td>
<td align="center">2</td>
<td align="center">3.1</td>
<td align="center">0.442</td>
<td align="center">4009.8</td>
</tr>
<tr class="odd">
<td align="left">DP-inform</td>
<td align="center">9</td>
<td align="center">10.0</td>
<td align="center">2.331</td>
<td align="center">4011.5</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Takeaway:</strong> When data are moderately informative (say,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>≥</mo><mn>0.7</mn></mrow><annotation encoding="application/x-tex">\bar{w} \ge 0.7</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>≥</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">N \ge 100</annotation></semantics></math>),
the posterior distributions of theta tend to be robust to the choice of
alpha prior. The main differences appear in the number of active
clusters and the posterior uncertainty around alpha itself. WAIC can
help discriminate, but differences are often small.</p>
</blockquote>
<p>The convergence observed here reflects the moderately high
reliability
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>≈</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\bar{w} \approx 0.8</annotation></semantics></math>)
of the 25-item test. For shorter tests with lower reliability
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>≈</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\bar{w} \approx 0.5</annotation></semantics></math>),
the alpha prior may exert stronger influence on the posterior because
the data provide less information to overcome the prior. See
<code><a href="../articles/posterior-summaries.html">vignette("posterior-summaries")</a></code> for a detailed analysis of
how reliability moderates both estimator choice and prior choice.</p>
</div>
</div>
<div class="section level2">
<h2 id="fallback-behavior">Fallback Behavior<a class="anchor" aria-label="anchor" href="#fallback-behavior"></a>
</h2>
<p>When the DPprior package is not installed, DPMirt falls back
gracefully to the Paganin default with an informative message:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate what happens without DPprior</span></span>
<span><span class="co"># (dpmirt_alpha_prior handles this internally)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">has_dpprior</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ab_fallback</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_alpha_prior.html">dpmirt_alpha_prior</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Returned:"</span>, <span class="va">ab_fallback</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"With DPprior installed, the package uses principled elicitation.\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Without DPprior, it returns c(a = 1, b = 3) with a message:\n\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'  "DPprior not installed. Using default: Gamma(1, 3)\n'</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'   [Paganin et al., 2023].\n'</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'   Install DPprior for principled alpha elicitation:\n'</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'   remotes::install_github(\\"joonho112/DPprior\\")"\n'</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; With DPprior installed, the package uses principled elicitation.</span></span>
<span><span class="co">#&gt; Without DPprior, it returns c(a = 1, b = 3) with a message:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   "DPprior not installed. Using default: Gamma(1, 3)</span></span>
<span><span class="co">#&gt;    [Paganin et al., 2023].</span></span>
<span><span class="co">#&gt;    Install DPprior for principled alpha elicitation:</span></span>
<span><span class="co">#&gt;    remotes::install_github(\"joonho112/DPprior\")"</span></span></code></pre></div>
<p>This design ensures that DPMirt works out of the box while
encouraging users to install DPprior for better-calibrated priors.
DPprior is listed in <code>Suggests</code>, not <code>Imports</code>, so
it is never a hard dependency.</p>
</div>
<div class="section level2">
<h2 id="advanced-custom-base-measure">Advanced: Custom Base Measure<a class="anchor" aria-label="anchor" href="#advanced-custom-base-measure"></a>
</h2>
<p>The DP base measure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>G</mi><mn>0</mn></msub><annotation encoding="application/x-tex">G_0</annotation></semantics></math>
determines the shape of each mixture component. DPMirt uses a
Normal–Inverse-Gamma base:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mn>0</mn></msub><mo>=</mo><mi mathvariant="script">𝒩</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>s</mi><mi>μ</mi><mn>2</mn></msubsup><mo stretchy="false" form="postfix">)</mo><mo>×</mo><mtext mathvariant="normal">InvGamma</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>ν</mi><mn>1</mn></msub><mo>,</mo><msub><mi>ν</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">
G_0 = \mathcal{N}(0, s^2_\mu) \times \text{InvGamma}(\nu_1, \nu_2)
</annotation></semantics></math></p>
<p>The Paganin defaults are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>s</mi><mi>μ</mi><mn>2</mn></msubsup><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">s^2_\mu = 2</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ν</mi><mn>1</mn></msub><mo>=</mo><mn>2.01</mn></mrow><annotation encoding="application/x-tex">\nu_1 = 2.01</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ν</mi><mn>2</mn></msub><mo>=</mo><mn>1.01</mn></mrow><annotation encoding="application/x-tex">\nu_2 = 1.01</annotation></semantics></math>.
These yield wide cluster means and diffuse cluster variances,
appropriate for standardized IRT scales.</p>
<p>To customize:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Wider cluster means, more concentrated cluster variances</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  model        <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  prior        <span class="op">=</span> <span class="st">"dpm"</span>,</span>
<span>  mu_K         <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  confidence   <span class="op">=</span> <span class="st">"medium"</span>,</span>
<span>  base_measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>s2_mu <span class="op">=</span> <span class="fl">3</span>, nu1 <span class="op">=</span> <span class="fl">2.01</span>, nu2 <span class="op">=</span> <span class="fl">1.01</span><span class="op">)</span>,</span>
<span>  niter        <span class="op">=</span> <span class="fl">10000</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The step-by-step interface gives direct access:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_spec.html">dpmirt_spec</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  model        <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  prior        <span class="op">=</span> <span class="st">"dpm"</span>,</span>
<span>  alpha_prior  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1.6</span>, b <span class="op">=</span> <span class="fl">0.82</span><span class="op">)</span>,</span>
<span>  base_measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>s2_mu <span class="op">=</span> <span class="fl">3</span>, nu1 <span class="op">=</span> <span class="fl">2.01</span>, nu2 <span class="op">=</span> <span class="fl">1.01</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect what was set</span></span>
<span><span class="va">spec</span><span class="op">$</span><span class="va">constants</span><span class="op">$</span><span class="va">s2_mu</span>   <span class="co"># 3</span></span>
<span><span class="va">spec</span><span class="op">$</span><span class="va">constants</span><span class="op">$</span><span class="va">nu1</span>     <span class="co"># 2.01</span></span>
<span><span class="va">spec</span><span class="op">$</span><span class="va">constants</span><span class="op">$</span><span class="va">nu2</span>     <span class="co"># 1.01</span></span></code></pre></div>
<div class="section level3">
<h3 id="base-measure-hyperparameter-effects">Base Measure Hyperparameter Effects<a class="anchor" aria-label="anchor" href="#base-measure-hyperparameter-effects"></a>
</h3>
<table class="table">
<colgroup>
<col width="34%">
<col width="19%">
<col width="46%">
</colgroup>
<thead><tr class="header">
<th align="center">Hyperparameter</th>
<th align="center">Default</th>
<th align="left">Effect of Increasing</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>s</mi><mi>μ</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">s^2_\mu</annotation></semantics></math></td>
<td align="center">2</td>
<td align="left">Wider spread of cluster means — clusters can be further
apart</td>
</tr>
<tr class="even">
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ν</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\nu_1</annotation></semantics></math></td>
<td align="center">2.01</td>
<td align="left">Tighter cluster variances (more concentrated
components)</td>
</tr>
<tr class="odd">
<td align="center"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ν</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\nu_2</annotation></semantics></math></td>
<td align="center">1.01</td>
<td align="left">Wider cluster variances (more diffuse components)</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Practical guidance:</strong> For most IRT applications, the
Paganin defaults work well. Increase
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>s</mi><mi>μ</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">s^2_\mu</annotation></semantics></math>
if you expect latent subgroups separated by more than 3–4 standard
deviations (e.g., combined clinical and non-clinical samples).</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="elicitation-decision-flowchart">Elicitation Decision Flowchart<a class="anchor" aria-label="anchor" href="#elicitation-decision-flowchart"></a>
</h2>
<p>The following summary may help decide which approach to use:</p>
<table class="table">
<colgroup>
<col width="26%">
<col width="57%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="left">Scenario</th>
<th align="left">Recommended approach</th>
<th align="left">Code</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">No domain knowledge, exploratory</td>
<td align="left">DP-diffuse</td>
<td align="left"><code>dpmirt(data, prior = "dpm")</code></td>
</tr>
<tr class="even">
<td align="left">Substantive belief about subgroups</td>
<td align="left">DP-inform</td>
<td align="left"><code>dpmirt(data, prior = "dpm", mu_K = 3, confidence = "high")</code></td>
</tr>
<tr class="odd">
<td align="left">Reproducing Paganin et al.</td>
<td align="left">Manual Gamma(1,3)</td>
<td align="left"><code>dpmirt(data, prior = "dpm", alpha_prior = c(1, 3))</code></td>
</tr>
<tr class="even">
<td align="left">Comparing priors</td>
<td align="left">Sensitivity analysis</td>
<td align="left">Fit multiple models, compare WAIC and posteriors</td>
</tr>
<tr class="odd">
<td align="left">DPprior not available</td>
<td align="left">Automatic fallback</td>
<td align="left">
<code>dpmirt(data, prior = "dpm")</code> — uses
Gamma(1,3) with message</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="whats-next">What’s Next?<a class="anchor" aria-label="anchor" href="#whats-next"></a>
</h2>
<p>Now that you can set principled priors for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
the following vignettes show how to put them to work:</p>
<table class="table">
<colgroup>
<col width="43%">
<col width="56%">
</colgroup>
<thead><tr class="header">
<th align="left">Vignette</th>
<th align="left">Why read it</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><em>Quick Start</em></td>
<td align="left">End-to-end pipeline with data simulation, fitting, and
estimation</td>
</tr>
<tr class="even">
<td align="left"><em>Simulation Study</em></td>
<td align="left">Full factorial study comparing Normal vs. DPM priors
under different conditions</td>
</tr>
<tr class="odd">
<td align="left"><em>Under the Hood</em></td>
<td align="left">How DPMirt generates NIMBLE code, compiles, and
samples</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Lee, J. (2026). Design-conditional prior elicitation for Dirichlet
Process mixtures: A unified framework for cluster counts and weight
control. arXiv preprint arXiv:2602.06301. <a href="https://arxiv.org/abs/2602.06301" class="external-link uri">https://arxiv.org/abs/2602.06301</a></p>
<p>Lee, J. &amp; Wind, S. Targeting toward inferential goals in Bayesian
Rasch models for estimating person-specific latent traits. <em>OSF
Preprint</em>. <a href="https://doi.org/10.31219/osf.io/qrw4n" class="external-link uri">https://doi.org/10.31219/osf.io/qrw4n</a></p>
<p>Paganin, S., Paciorek, C. J., Wehrhahn, C., Rodríguez, A.,
Rabe-Hesketh, S., &amp; de Valpine, P. (2023). Computational strategies
and estimation performance with Bayesian semiparametric item response
theory models. <em>Journal of Educational and Behavioral
Statistics</em>, 48(2), 147–188. <a href="https://doi.org/10.3102/10769986221136105" class="external-link uri">https://doi.org/10.3102/10769986221136105</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/joonho112" class="external-link">JoonHo Lee</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
