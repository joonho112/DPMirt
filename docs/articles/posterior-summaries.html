<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Posterior Summary Methods: Matching Estimators to Inferential Goals • DPMirt</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Posterior Summary Methods: Matching Estimators to Inferential Goals">
<meta name="description" content="How to choose among posterior mean (PM), constrained Bayes (CB), and triple-goal (GR) estimators depending on whether the goal is individual scoring, ranking, or distribution recovery.  Tied closely to the APM manuscript (Lee &amp; Wind).
">
<meta property="og:description" content="How to choose among posterior mean (PM), constrained Bayes (CB), and triple-goal (GR) estimators depending on whether the goal is individual scoring, ranking, or distribution recovery.  Tied closely to the APM manuscript (Lee &amp; Wind).
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DPMirt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><h6 class="dropdown-header" data-toc-skip>--- Getting Started ---</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/quick-start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/models-and-workflow.html">Models &amp; Workflow</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>--- Theory &amp; Methods ---</h6></li>
    <li><a class="dropdown-item" href="../articles/theory-irt-dpm.html">IRT &amp; DPM Theory</a></li>
    <li><a class="dropdown-item" href="../articles/posterior-summaries.html">Posterior Summaries</a></li>
    <li><a class="dropdown-item" href="../articles/prior-elicitation.html">Prior Elicitation</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>--- Advanced ---</h6></li>
    <li><a class="dropdown-item" href="../articles/nimble-internals.html">NIMBLE Internals</a></li>
    <li><a class="dropdown-item" href="../articles/simulation-study.html">Simulation Study</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joonho112/DPMirt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Posterior Summary Methods: Matching Estimators to Inferential Goals</h1>
                        <h4 data-toc-skip class="author">JoonHo Lee</h4>
            
            <h4 data-toc-skip class="date">2026-02-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/joonho112/DPMirt/blob/HEAD/vignettes/posterior-summaries.Rmd" class="external-link"><code>vignettes/posterior-summaries.Rmd</code></a></small>
      <div class="d-none name"><code>posterior-summaries.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">1. Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>A Bayesian IRT model delivers a full posterior distribution for every
person parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>p</mi></msub><annotation encoding="application/x-tex">\theta_p</annotation></semantics></math>.
Collapsing each posterior to a single point estimate is unavoidable for
operational decisions – but <em>which</em> point estimate should you
report?</p>
<p>The answer depends on <strong>what you plan to do with the
numbers</strong>. This vignette introduces three posterior summary
methods shipped with DPMirt — posterior mean (PM), constrained Bayes
(CB), and triple-goal (GR) — and shows how to match each one to the
inferential goal at hand. The discussion tracks the framework developed
in Lee &amp; Wind (APM manuscript) and the foundational theory of Louis
(1984), Ghosh (1992), and Shen &amp; Louis (1998).</p>
<blockquote>
<p><strong>Key take-away.</strong> No single set of point estimates
simultaneously minimises all three loss functions. Choosing an estimator
is choosing a loss function; choosing a loss function is choosing an
inferential goal.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="three-inferential-goals">2. Three Inferential Goals<a class="anchor" aria-label="anchor" href="#three-inferential-goals"></a>
</h2>
<p>Bayesian decision theory tells us that the optimal point estimate
minimises the expected posterior loss. Different loss functions lead to
different estimators. The table below maps three common inferential
goals in criterion-based assessment (CBA) to the loss function each
implies and the estimator that minimises it.</p>
<table class="table">
<caption>Three inferential goals and their optimal posterior
summaries.</caption>
<colgroup>
<col width="15%">
<col width="11%">
<col width="33%">
<col width="26%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">Goal</th>
<th align="left">Target</th>
<th align="left">Loss Function</th>
<th align="left">Example Question</th>
<th align="left">Optimal Estimator</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1. Individual traits</td>
<td align="left">True
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>p</mi></msub><annotation encoding="application/x-tex">\theta_p</annotation></semantics></math>
</td>
<td align="left">MSEL:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><mo>∑</mo><mo stretchy="false" form="prefix">(</mo><msub><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>p</mi></msub><mo>−</mo><msub><mi>θ</mi><mi>p</mi></msub><msup><mo stretchy="false" form="postfix">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\frac{1}{N}\sum(\hat{\theta}_p - \theta_p)^2</annotation></semantics></math>
</td>
<td align="left">What is this student’s ability?</td>
<td align="left">Posterior Mean (PM)</td>
</tr>
<tr class="even">
<td align="left">2. Ranking</td>
<td align="left">True rank
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>p</mi></msub><annotation encoding="application/x-tex">R_p</annotation></semantics></math>
</td>
<td align="left">MSELR:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><mo>∑</mo><mo stretchy="false" form="prefix">(</mo><msub><mover><mi>R</mi><mo accent="true">̂</mo></mover><mi>p</mi></msub><mi>/</mi><mi>N</mi><mo>−</mo><msub><mi>R</mi><mi>p</mi></msub><mi>/</mi><mi>N</mi><msup><mo stretchy="false" form="postfix">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\frac{1}{N}\sum(\hat{R}_p/N - R_p/N)^2</annotation></semantics></math>
</td>
<td align="left">Which 5 students need intervention?</td>
<td align="left">Triple-Goal (GR)</td>
</tr>
<tr class="odd">
<td align="left">3. Distribution recovery</td>
<td align="left">True EDF
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mi>N</mi></msub><mo stretchy="false" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">G_N(t)</annotation></semantics></math>
</td>
<td align="left">KS:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi mathvariant="normal">sup</mi><mo>⁡</mo></mrow><mi>t</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mover><mi>G</mi><mo accent="true">̂</mo></mover><mi>N</mi></msub><mo stretchy="false" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="postfix">)</mo><mo>−</mo><msub><mi>G</mi><mi>N</mi></msub><mo stretchy="false" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">|</mo></mrow><annotation encoding="application/x-tex">\sup_t \lvert\hat{G}_N(t) - G_N(t)\rvert</annotation></semantics></math>
</td>
<td align="left">What proportion scored below the cutoff?</td>
<td align="left">Triple-Goal (GR)</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="a-concrete-cba-scenario">A concrete CBA scenario<a class="anchor" aria-label="anchor" href="#a-concrete-cba-scenario"></a>
</h3>
<p>Consider a universal screening programme in which 200 elementary
students complete a 25-item mathematics assessment. A school
psychologist might ask three distinct questions about the same data:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Individual scoring.</strong> “What is Student 47’s latent
ability?” – Report the PM estimate and its credible interval.</li>
<li>
<strong>Ranking.</strong> “Which five students fall in the bottom 5%
and need Tier 2 support?” – Report the GR estimates and select the five
lowest.</li>
<li>
<strong>Distribution recovery.</strong> “What proportion of the
cohort falls below the state proficiency cutoff
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mi>−</mi><mn>0.5</mn></mrow><annotation encoding="application/x-tex">t = -0.5</annotation></semantics></math>?”
– Compute the empirical distribution of GR estimates and evaluate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>G</mi><mo accent="true">̂</mo></mover><mi>N</mi></msub><mo stretchy="false" form="prefix">(</mo><mi>−</mi><mn>0.5</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\hat{G}_N(-0.5)</annotation></semantics></math>.</li>
</ol>
<p>Each question calls for a different estimator. Using PM for all three
preserves the ranking, but the distribution-level summary is distorted
by shrinkage.</p>
<blockquote>
<p><strong>“No single set of point estimates simultaneously minimises
all three<strong> </strong>loss functions.”</strong> — Lee &amp; Wind
(APM manuscript)</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="the-shrinkage-problem">3. The Shrinkage Problem<a class="anchor" aria-label="anchor" href="#the-shrinkage-problem"></a>
</h2>
<div class="section level3">
<h3 id="why-posterior-means-compress-the-distribution">Why posterior means compress the distribution<a class="anchor" aria-label="anchor" href="#why-posterior-means-compress-the-distribution"></a>
</h3>
<p>The posterior mean for person
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
under an exchangeable hierarchical model can be written as a weighted
combination of the likelihood-based estimate and the prior mean:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>p</mi><mtext mathvariant="normal">PM</mtext></msubsup><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><msub><mi>w</mi><mi>p</mi></msub><mspace width="0.167em"></mspace><msubsup><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>p</mi><mtext mathvariant="normal">ML</mtext></msubsup><mspace width="0.278em"></mspace><mo>+</mo><mspace width="0.278em"></mspace><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>w</mi><mi>p</mi></msub><mo stretchy="false" form="postfix">)</mo><mspace width="0.167em"></mspace><msub><mi>μ</mi><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">
\hat{\theta}_p^{\text{PM}} \;=\; w_p\,\hat{\theta}_p^{\text{ML}}
  \;+\; (1 - w_p)\,\mu_\theta
</annotation></semantics></math></p>
<p>where the shrinkage weight is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>p</mi></msub><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mfrac><msubsup><mi>σ</mi><mi>θ</mi><mn>2</mn></msubsup><mrow><msubsup><mi>σ</mi><mi>θ</mi><mn>2</mn></msubsup><mo>+</mo><mtext mathvariant="normal">se</mtext><mo stretchy="false" form="prefix">(</mo><msub><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>p</mi></msub><msup><mo stretchy="false" form="postfix">)</mo><mn>2</mn></msup></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
w_p \;=\; \frac{\sigma^2_\theta}{\sigma^2_\theta + \text{se}(\hat{\theta}_p)^2}.
</annotation></semantics></math></p>
<p>For every person,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>w</mi><mi>p</mi></msub><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 &lt; w_p &lt; 1</annotation></semantics></math>,
so each PM estimate is pulled toward the grand mean. The direct
consequence is that the variance of the PM estimates is smaller than the
variance of the true abilities:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mo stretchy="false" form="prefix">(</mo><msup><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mtext mathvariant="normal">PM</mtext></msup><mo stretchy="false" form="postfix">)</mo><mspace width="0.278em"></mspace><mo>&lt;</mo><mspace width="0.278em"></mspace><mtext mathvariant="normal">Var</mtext><mo stretchy="false" form="prefix">(</mo><mi>θ</mi><mo stretchy="false" form="postfix">)</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">
\text{Var}(\hat{\theta}^{\text{PM}}) \;&lt;\; \text{Var}(\theta).
</annotation></semantics></math></p>
<p>This <em>under-dispersion</em> is a feature when the goal is
individual-level accuracy (Goal 1), because it reduces mean squared
error. But it is a liability for Goals 2 and 3: the empirical
distribution of PM estimates is too narrow, so tail probabilities are
systematically mis-estimated and extreme ranks are compressed toward the
centre.</p>
</div>
<div class="section level3">
<h3 id="visualising-shrinkage">Visualising shrinkage<a class="anchor" aria-label="anchor" href="#visualising-shrinkage"></a>
</h3>
<p>The figure below loads a pre-computed bimodal simulation
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">N = 200</annotation></semantics></math>,
25 items, Rasch). The true density has two modes; PM fills the
valley.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">find_extdata</span><span class="op">(</span><span class="st">"vignette_estimates_comparison.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">comp</span><span class="op">$</span><span class="va">true_theta</span><span class="op">)</span></span>
<span><span class="va">df_shrink</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">comp</span><span class="op">$</span><span class="va">true_theta</span>,</span>
<span>            <span class="va">comp</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_pm</span>,</span>
<span>            <span class="va">comp</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_cb</span>,</span>
<span>            <span class="va">comp</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_gr</span><span class="op">)</span>,</span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True"</span>, <span class="st">"PM"</span>, <span class="st">"CB"</span>, <span class="st">"GR"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">N</span><span class="op">)</span>,</span>
<span>                  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True"</span>, <span class="st">"PM"</span>, <span class="st">"CB"</span>, <span class="st">"GR"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_shrink</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, colour <span class="op">=</span> <span class="va">Method</span>, fill <span class="op">=</span> <span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.15</span>, linewidth <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>True <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"true"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                  PM   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"pm"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                  CB   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"cb"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                  GR   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"gr"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>True <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"true"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                PM   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"pm"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                CB   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"cb"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                GR   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"gr"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Shrinkage and de-shrinkage under a DPM prior"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Bimodal population, 25 items, 200 persons"</span>,</span>
<span>       x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="posterior-summaries_files/figure-html/shrinkage-figure-1.png" class="r-plt" alt="PM (red) compresses the distribution. CB (blue) and GR (green) progressively de-shrink the estimates, with GR tracking the true density most closely." width="85%"><p class="caption">
PM (red) compresses the distribution. CB (blue) and GR (green)
progressively de-shrink the estimates, with GR tracking the true density
most closely.
</p>
</div>
<blockquote>
<p><strong>What to look for.</strong> PM (red) is the most compressed:
the valley between the two modes is partially filled and the tails are
thin. CB (blue) widens the distribution by matching the first two
moments, restoring much of the true spread. GR (green) tracks the true
density (gray) most closely, preserving both modes and the valley
between them.</p>
</blockquote>
<p>If the pre-computed data are not installed, the figure above will not
render. See <code><a href="../articles/simulation-study.html">vignette("simulation-study")</a></code> for generation
instructions.</p>
</div>
</div>
<div class="section level2">
<h2 id="posterior-mean-pm-estimator">4. Posterior Mean (PM) Estimator<a class="anchor" aria-label="anchor" href="#posterior-mean-pm-estimator"></a>
</h2>
<div class="section level3">
<h3 id="definition">Definition<a class="anchor" aria-label="anchor" href="#definition"></a>
</h3>
<p>The posterior mean for person
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
is simply the average of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
retained MCMC draws:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>p</mi><mtext mathvariant="normal">PM</mtext></msubsup><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mfrac><mn>1</mn><mi>S</mi></mfrac><munderover><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><msubsup><mi>θ</mi><mi>p</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>s</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mi>.</mi></mrow><annotation encoding="application/x-tex">
\hat{\theta}_p^{\text{PM}}
  \;=\; \frac{1}{S}\sum_{s=1}^{S}\theta_p^{(s)}.
</annotation></semantics></math></p>
<p>Under squared-error loss this is the Bayes-optimal point estimate.
DPMirt returns it as <code>theta_pm</code> whenever you call
<code><a href="../reference/dpmirt_estimates.html">dpmirt_estimates()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="code">Code<a class="anchor" aria-label="anchor" href="#code"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute only the posterior mean</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_estimates.html">dpmirt_estimates</a></span><span class="op">(</span><span class="va">fit</span>, methods <span class="op">=</span> <span class="st">"pm"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect first few values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">est</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"theta_pm"</span>, <span class="st">"theta_psd"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="when-to-use-pm">When to use PM<a class="anchor" aria-label="anchor" href="#when-to-use-pm"></a>
</h3>
<table class="table">
<colgroup>
<col width="40%">
<col width="59%">
</colgroup>
<thead><tr class="header">
<th align="left">Situation</th>
<th align="left">Recommendation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Reporting a single ability score for an individual</td>
<td align="left">PM is optimal</td>
</tr>
<tr class="even">
<td align="left">Building a profile across multiple sub-tests</td>
<td align="left">PM for each sub-test</td>
</tr>
<tr class="odd">
<td align="left">Feeding estimates into a downstream regression</td>
<td align="left">PM minimises attenuation</td>
</tr>
<tr class="even">
<td align="left">Identifying extreme students for intervention</td>
<td align="left">Prefer GR (see Section 6)</td>
</tr>
</tbody>
</table>
<p>PM is the safest default when the consumer of the scores will
interpret them one person at a time.</p>
</div>
</div>
<div class="section level2">
<h2 id="constrained-bayes-cb-estimator">5. Constrained Bayes (CB) Estimator<a class="anchor" aria-label="anchor" href="#constrained-bayes-cb-estimator"></a>
</h2>
<div class="section level3">
<h3 id="idea">Idea<a class="anchor" aria-label="anchor" href="#idea"></a>
</h3>
<p>Ghosh (1992) proposed a simple moment-matching correction: rescale
the PM estimates so that their first two moments match those of the
marginal empirical distribution. This removes the systematic
under-dispersion caused by shrinkage while retaining the Bayesian
ranking.</p>
</div>
<div class="section level3">
<h3 id="formula">Formula<a class="anchor" aria-label="anchor" href="#formula"></a>
</h3>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>η</mi><mo accent="true">‾</mo></mover><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msub><mo>∑</mo><mi>p</mi></msub><msubsup><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>p</mi><mtext mathvariant="normal">PM</mtext></msubsup></mrow><annotation encoding="application/x-tex">\bar\eta = \frac{1}{N}\sum_p \hat{\theta}_p^{\text{PM}}</annotation></semantics></math>
be the grand mean of the PMs,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>η</mi></msub><mo>=</mo><mtext mathvariant="normal">Var</mtext><mo stretchy="false" form="prefix">(</mo><msup><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mtext mathvariant="normal">PM</mtext></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">V_\eta = \text{Var}(\hat{\theta}^{\text{PM}})</annotation></semantics></math>
their variance, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>λ</mi><mo accent="true">‾</mo></mover><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msub><mo>∑</mo><mi>p</mi></msub><mtext mathvariant="normal">Var</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>θ</mi><mi>p</mi></msub><mo>∣</mo><mtext mathvariant="normal">data</mtext><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\bar\lambda = \frac{1}{N}\sum_p \text{Var}(\theta_p \mid \text{data})</annotation></semantics></math>
the average posterior variance. Then</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>p</mi><mtext mathvariant="normal">CB</mtext></msubsup><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mover><mi>η</mi><mo accent="true">‾</mo></mover><mspace width="0.278em"></mspace><mo>+</mo><mspace width="0.278em"></mspace><mo stretchy="false" form="prefix">(</mo><msubsup><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>p</mi><mtext mathvariant="normal">PM</mtext></msubsup><mo>−</mo><mover><mi>η</mi><mo accent="true">‾</mo></mover><mo stretchy="false" form="postfix">)</mo><msqrt><mrow><mn>1</mn><mo>+</mo><mfrac><mover><mi>λ</mi><mo accent="true">‾</mo></mover><msub><mi>V</mi><mi>η</mi></msub></mfrac></mrow></msqrt><mi>.</mi></mrow><annotation encoding="application/x-tex">
\hat{\theta}_p^{\text{CB}}
  \;=\; \bar\eta
  \;+\; (\hat{\theta}_p^{\text{PM}} - \bar\eta)
        \sqrt{1 + \frac{\bar\lambda}{V_\eta}}.
</annotation></semantics></math></p>
<p>The two constraints are:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Mean preservation:</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><msub><mo>∑</mo><mi>p</mi></msub><msubsup><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>p</mi><mtext mathvariant="normal">CB</mtext></msubsup><mo>=</mo><mover><mi>η</mi><mo accent="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\frac{1}{N}\sum_p \hat{\theta}_p^{\text{CB}}
= \bar\eta</annotation></semantics></math> (same grand mean as PM).</li>
<li>
<strong>Variance inflation:</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mo stretchy="false" form="prefix">(</mo><msup><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mtext mathvariant="normal">CB</mtext></msup><mo stretchy="false" form="postfix">)</mo><mo>=</mo><msub><mi>V</mi><mi>η</mi></msub><mo>+</mo><mover><mi>λ</mi><mo accent="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\text{Var}(\hat{\theta}^{\text{CB}})
= V_\eta + \bar\lambda</annotation></semantics></math> (restores the
marginal variance).</li>
</ol>
<p>The correction factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msqrt><mrow><mn>1</mn><mo>+</mo><mover><mi>λ</mi><mo accent="true">‾</mo></mover><mi>/</mi><msub><mi>V</mi><mi>η</mi></msub></mrow></msqrt><annotation encoding="application/x-tex">\sqrt{1 + \bar\lambda / V_\eta}</annotation></semantics></math>
is always
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\geq 1</annotation></semantics></math>:
CB estimates are always at least as dispersed as PM estimates.</p>
</div>
<div class="section level3">
<h3 id="code-1">Code<a class="anchor" aria-label="anchor" href="#code-1"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute PM and CB</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_estimates.html">dpmirt_estimates</a></span><span class="op">(</span><span class="va">fit</span>, methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pm"</span>, <span class="st">"cb"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># CB estimates alongside PM</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">est</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"theta_pm"</span>, <span class="st">"theta_cb"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="quality-flags">Quality flags<a class="anchor" aria-label="anchor" href="#quality-flags"></a>
</h3>
<p>When the posterior means have near-zero variance (e.g., a very short
test or extremely strong prior), the CB scaling factor can become
numerically unstable. DPMirt detects this and falls back to PM:
<code>est$quality_flags$cb_fallback</code> will be <code>TRUE</code>. A
scaling factor above 5 triggers a warning stored in
<code>est$quality_flags$cb_extreme_factor</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check quality flags</span></span>
<span><span class="va">est</span><span class="op">$</span><span class="va">quality_flags</span><span class="op">$</span><span class="va">cb_fallback</span></span>
<span><span class="va">est</span><span class="op">$</span><span class="va">quality_flags</span><span class="op">$</span><span class="va">cb_extreme_factor</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="limitations">Limitations<a class="anchor" aria-label="anchor" href="#limitations"></a>
</h3>
<p>CB is derived under the assumption of an exchangeable Gaussian prior.
When the true latent distribution is strongly multimodal, rescaling the
first two moments alone cannot recover the shape. For multimodal
distributions, GR generally outperforms CB on both ranking and EDF
estimation.</p>
</div>
</div>
<div class="section level2">
<h2 id="triple-goal-gr-estimator">6. Triple-Goal (GR) Estimator<a class="anchor" aria-label="anchor" href="#triple-goal-gr-estimator"></a>
</h2>
<div class="section level3">
<h3 id="idea-1">Idea<a class="anchor" aria-label="anchor" href="#idea-1"></a>
</h3>
<p>Shen &amp; Louis (1998) designed an estimator that simultaneously
optimises three properties: it preserves Bayesian rankings, matches the
empirical distribution function, and remains close to the posterior
means. In DPMirt the estimator is labeled “GR” after its two key
ingredients: the estimated <strong>G</strong> function (the EDF of the
latent trait) and the posterior mean <strong>R</strong>anks.</p>
</div>
<div class="section level3">
<h3 id="algorithm-four-steps">Algorithm (four steps)<a class="anchor" aria-label="anchor" href="#algorithm-four-steps"></a>
</h3>
<p>The full triple-goal algorithm proceeds as follows:</p>
<p><strong>Step 1. Posterior mean ranks.</strong> For each MCMC
iteration
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>,
rank all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
persons by their
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>θ</mi><mi>p</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>s</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">\theta_p^{(s)}</annotation></semantics></math>
values. Average across iterations to obtain the posterior mean rank:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>R</mi><mo accent="true">‾</mo></mover><mi>p</mi></msub><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mfrac><mn>1</mn><mi>S</mi></mfrac><munderover><mo>∑</mo><mrow><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><msubsup><mi>R</mi><mi>p</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>s</mi><mo stretchy="false" form="postfix">)</mo></mrow></msubsup><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><munderover><mo>∑</mo><mrow><mi>q</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>P</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>θ</mi><mi>q</mi></msub><mo>≤</mo><msub><mi>θ</mi><mi>p</mi></msub><mo>∣</mo><mtext mathvariant="normal">data</mtext><mo stretchy="false" form="postfix">)</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">
\bar{R}_p \;=\; \frac{1}{S}\sum_{s=1}^{S} R_p^{(s)}
  \;=\; \sum_{q=1}^{N} P(\theta_q \le \theta_p \mid \text{data}).
</annotation></semantics></math></p>
<p><strong>Step 2. Integer ranks.</strong> Convert fractional posterior
mean ranks to integer ranks by ranking them:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>R</mi><mo accent="true">̂</mo></mover><mi>p</mi></msub><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mtext mathvariant="normal">rank</mtext><mo stretchy="false" form="prefix">(</mo><msub><mover><mi>R</mi><mo accent="true">‾</mo></mover><mi>p</mi></msub><mo stretchy="false" form="postfix">)</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">
\hat{R}_p \;=\; \text{rank}(\bar{R}_p).
</annotation></semantics></math></p>
<p><strong>Step 3. ISEL EDF.</strong> The integrated squared error loss
(ISEL) estimator of the latent EDF pools all posterior samples:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>G</mi><mo accent="true">̂</mo></mover><mi>N</mi></msub><mo stretchy="false" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="postfix">)</mo><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>P</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>θ</mi><mi>p</mi></msub><mo>≤</mo><mi>t</mi><mo>∣</mo><mtext mathvariant="normal">data</mtext><mo stretchy="false" form="postfix">)</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">
\hat{G}_N(t) \;=\; \frac{1}{N}\sum_{p=1}^{N}
  P(\theta_p \le t \mid \text{data}).
</annotation></semantics></math></p>
<p>In practice this is the ECDF of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>×</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">N \times S</annotation></semantics></math>
pooled draws.</p>
<p><strong>Step 4. Quantile placement.</strong> Each person’s GR
estimate is the quantile of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>G</mi><mo accent="true">̂</mo></mover><mi>N</mi></msub><annotation encoding="application/x-tex">\hat{G}_N</annotation></semantics></math>
that corresponds to their integer rank:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>p</mi><mtext mathvariant="normal">GR</mtext></msubsup><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><msubsup><mover><mi>G</mi><mo accent="true">̂</mo></mover><mi>N</mi><mrow><mi>−</mi><mn>1</mn></mrow></msubsup><mspace width="-0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mn>2</mn><msub><mover><mi>R</mi><mo accent="true">̂</mo></mover><mi>p</mi></msub><mo>−</mo><mn>1</mn></mrow><mrow><mn>2</mn><mi>N</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\hat{\theta}_p^{\text{GR}} \;=\; \hat{G}_N^{-1}
  \!\left(\frac{2\hat{R}_p - 1}{2N}\right).
</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="intuition">Intuition<a class="anchor" aria-label="anchor" href="#intuition"></a>
</h3>
<p>The GR estimator places one estimate at each of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
equally spaced quantiles of the estimated latent distribution. The
ranking step determines <em>which</em> quantile each person occupies;
the quantile step determines the <em>location</em> of that estimate on
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
scale. Because the quantile grid spans the full estimated distribution,
the GR estimates reproduce its shape — modes, tails, and gaps are all
represented faithfully.</p>
</div>
<div class="section level3">
<h3 id="code-2">Code<a class="anchor" aria-label="anchor" href="#code-2"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute all three estimators</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_estimates.html">dpmirt_estimates</a></span><span class="op">(</span><span class="va">fit</span>, methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pm"</span>, <span class="st">"cb"</span>, <span class="st">"gr"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># GR estimates with posterior mean ranks</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">est</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"theta_pm"</span>, <span class="st">"theta_gr"</span>, <span class="st">"rbar"</span>, <span class="st">"rhat"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="quality-flags-ties">Quality flags: ties<a class="anchor" aria-label="anchor" href="#quality-flags-ties"></a>
</h3>
<p>DPMirt breaks ties in posterior mean ranks randomly by default. Pass
<code>stop_if_ties = TRUE</code> to raise an error instead:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_estimates.html">dpmirt_estimates</a></span><span class="op">(</span><span class="va">fit</span>, methods <span class="op">=</span> <span class="st">"gr"</span>, stop_if_ties <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Ties are unusual with continuous posteriors; when they occur it
typically signals very low test information for a subset of persons.</p>
</div>
</div>
<div class="section level2">
<h2 id="side-by-side-comparison">7. Side-by-Side Comparison<a class="anchor" aria-label="anchor" href="#side-by-side-comparison"></a>
</h2>
<p>This section loads the same pre-computed estimates object and
produces four complementary views.</p>
<div class="section level3">
<h3 id="density-overlay">7.1 Density overlay<a class="anchor" aria-label="anchor" href="#density-overlay"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Build long-format data for ggplot</span></span>
<span><span class="va">df_dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">comp</span><span class="op">$</span><span class="va">true_theta</span>,</span>
<span>            <span class="va">comp</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_pm</span>,</span>
<span>            <span class="va">comp</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_cb</span>,</span>
<span>            <span class="va">comp</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_gr</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True"</span>, <span class="st">"PM"</span>, <span class="st">"CB"</span>, <span class="st">"GR"</span><span class="op">)</span>,</span>
<span>               each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">comp</span><span class="op">$</span><span class="va">true_theta</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df_dens</span><span class="op">$</span><span class="va">method</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">df_dens</span><span class="op">$</span><span class="va">method</span>,</span>
<span>                          levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True"</span>, <span class="st">"PM"</span>, <span class="st">"CB"</span>, <span class="st">"GR"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_dens</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, colour <span class="op">=</span> <span class="va">method</span>, fill <span class="op">=</span> <span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.12</span>, linewidth <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>True <span class="op">=</span> <span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"true"</span><span class="op">]</span>,</span>
<span>                                  PM   <span class="op">=</span> <span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"pm"</span><span class="op">]</span>,</span>
<span>                                  CB   <span class="op">=</span> <span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"cb"</span><span class="op">]</span>,</span>
<span>                                  GR   <span class="op">=</span> <span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"gr"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>True <span class="op">=</span> <span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"true"</span><span class="op">]</span>,</span>
<span>                                PM   <span class="op">=</span> <span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"pm"</span><span class="op">]</span>,</span>
<span>                                CB   <span class="op">=</span> <span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"cb"</span><span class="op">]</span>,</span>
<span>                                GR   <span class="op">=</span> <span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"gr"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"True vs. PM vs. CB vs. GR densities"</span>,</span>
<span>       x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>       colour <span class="op">=</span> <span class="st">"Method"</span>, fill <span class="op">=</span> <span class="st">"Method"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: No shared levels found between `names(values)` of the manual scale and the</span></span>
<span><span class="co">#&gt; data's <span style="color: #00BB00;">colour</span> values.</span></span>
<span><span class="co">#&gt; Warning: No shared levels found between `names(values)` of the manual scale and the</span></span>
<span><span class="co">#&gt; data's <span style="color: #00BB00;">fill</span> values.</span></span>
<span><span class="co">#&gt; Warning: No shared levels found between `names(values)` of the manual scale and the</span></span>
<span><span class="co">#&gt; data's <span style="color: #00BB00;">colour</span> values.</span></span>
<span><span class="co">#&gt; Warning: No shared levels found between `names(values)` of the manual scale and the</span></span>
<span><span class="co">#&gt; data's <span style="color: #00BB00;">fill</span> values.</span></span></code></pre></div>
<p><img src="posterior-summaries_files/figure-html/density-overlay-1.png" class="r-plt" width="85%" style="display: block; margin: auto;"></p>
<blockquote>
<p><strong>What to look for.</strong> PM (red) is the most compressed.
CB (blue) widens the distribution but may not recover multimodal shape.
GR (green) tracks the true density (grey) most closely, reproducing both
modes and the valley between them.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="caterpillar-plot">7.2 Caterpillar plot<a class="anchor" aria-label="anchor" href="#caterpillar-plot"></a>
</h3>
<p>When a <code>dpmirt_estimates</code> object is available, the
built-in <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method produces a caterpillar plot with all
three estimators overlaid.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Built-in caterpillar plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">est</span>, type <span class="op">=</span> <span class="st">"estimates"</span>, param <span class="op">=</span> <span class="st">"theta"</span><span class="op">)</span></span></code></pre></div>
<p>Persons are sorted by PM. CB and GR deviate most at the tails.</p>
</div>
<div class="section level3">
<h3 id="rank-scatter">7.3 Rank scatter<a class="anchor" aria-label="anchor" href="#rank-scatter"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_rank</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  rank_pm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></span><span class="op">(</span><span class="va">comp</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_pm</span><span class="op">)</span>,</span>
<span>  rank_gr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></span><span class="op">(</span><span class="va">comp</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_gr</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_rank</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rank_pm</span>, y <span class="op">=</span> <span class="va">rank_gr</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">1.5</span>, colour <span class="op">=</span> <span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"dpm"</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>              colour <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Rank agreement: PM vs. GR"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Rank (PM)"</span>, y <span class="op">=</span> <span class="st">"Rank (GR)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="posterior-summaries_files/figure-html/rank-scatter-1.png" class="r-plt" width="85%" style="display: block; margin: auto;"></p>
<p>Rank agreement is typically very high in the interior. Discrepancies
concentrate in the tails — precisely the students targeted by
classification decisions.</p>
</div>
<div class="section level3">
<h3 id="table-of-first-10-persons">7.4 Table of first 10 persons<a class="anchor" aria-label="anchor" href="#table-of-first-10-persons"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Person   <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>  True     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">comp</span><span class="op">$</span><span class="va">true_theta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  PM       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">comp</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_pm</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  CB       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">comp</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_cb</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  GR       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">comp</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_gr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  PM_rank  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></span><span class="op">(</span><span class="op">-</span><span class="va">comp</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_pm</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>,</span>
<span>  GR_rank  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></span><span class="op">(</span><span class="op">-</span><span class="va">comp</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_gr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">tab10</span>, caption <span class="op">=</span> <span class="st">"Estimates and ranks for the first 10 persons."</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Estimates and ranks for the first 10 persons.</caption>
<thead><tr class="header">
<th align="right">Person</th>
<th align="right">True</th>
<th align="right">PM</th>
<th align="right">CB</th>
<th align="right">GR</th>
<th align="right">PM_rank</th>
<th align="right">GR_rank</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1.081</td>
<td align="right">1.198</td>
<td align="right">1.347</td>
<td align="right">1.381</td>
<td align="right">26</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">-1.611</td>
<td align="right">-1.357</td>
<td align="right">-1.552</td>
<td align="right">-1.727</td>
<td align="right">191</td>
<td align="right">192</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">-1.530</td>
<td align="right">-1.878</td>
<td align="right">-2.142</td>
<td align="right">-2.228</td>
<td align="right">199</td>
<td align="right">198</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">-1.210</td>
<td align="right">-0.323</td>
<td align="right">-0.378</td>
<td align="right">-0.305</td>
<td align="right">127</td>
<td align="right">127</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">-0.442</td>
<td align="right">-0.606</td>
<td align="right">-0.699</td>
<td align="right">-0.770</td>
<td align="right">155</td>
<td align="right">156</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">-1.088</td>
<td align="right">-1.339</td>
<td align="right">-1.532</td>
<td align="right">-1.508</td>
<td align="right">186</td>
<td align="right">187</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">-1.360</td>
<td align="right">-1.862</td>
<td align="right">-2.125</td>
<td align="right">-2.098</td>
<td align="right">197</td>
<td align="right">197</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">-1.027</td>
<td align="right">-1.092</td>
<td align="right">-1.251</td>
<td align="right">-1.157</td>
<td align="right">176</td>
<td align="right">175</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">0.783</td>
<td align="right">-0.080</td>
<td align="right">-0.103</td>
<td align="right">-0.157</td>
<td align="right">117</td>
<td align="right">117</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">-0.994</td>
<td align="right">-0.358</td>
<td align="right">-0.418</td>
<td align="right">-0.505</td>
<td align="right">140</td>
<td align="right">140</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="the-role-of-test-reliability">8. The Role of Test Reliability<a class="anchor" aria-label="anchor" href="#the-role-of-test-reliability"></a>
</h2>
<div class="section level3">
<h3 id="reliability-as-the-dominant-moderator">Reliability as the dominant moderator<a class="anchor" aria-label="anchor" href="#reliability-as-the-dominant-moderator"></a>
</h3>
<p>The simulation studies in Lee &amp; Wind show that average test
reliability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>w</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{w}</annotation></semantics></math>
— not sample size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
— is the dominant moderator of estimator performance. Reliability
determines how much shrinkage occurs and therefore how much room there
is for estimator choice (and prior choice) to make a difference.</p>
<p>The average shrinkage weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>w</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{w}</annotation></semantics></math>
is related to the classical marginal reliability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
through
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>≈</mo><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\bar{w} \approx \rho</annotation></semantics></math>
for long tests under a Rasch model. A rough mapping from reliability to
test length is:</p>
<table class="table">
<caption>Reliability determines whether estimator choice or prior choice
has more influence on recovery.</caption>
<colgroup>
<col width="22%">
<col width="13%">
<col width="18%">
<col width="46%">
</colgroup>
<thead><tr class="header">
<th align="left">Reliability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>w</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{w}</annotation></semantics></math>
</th>
<th align="left">~Items needed</th>
<th align="left">Shrinkage severity</th>
<th align="left">What matters most?</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>≈</mo><mn>0.50</mn></mrow><annotation encoding="application/x-tex">\bar{w} \approx 0.50</annotation></semantics></math></td>
<td align="left">~10 items</td>
<td align="left">Severe</td>
<td align="left">Estimator choice matters MORE than prior choice</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>≈</mo><mn>0.70</mn></mrow><annotation encoding="application/x-tex">\bar{w} \approx 0.70</annotation></semantics></math></td>
<td align="left">~23 items</td>
<td align="left">Moderate</td>
<td align="left">Estimator and prior both matter</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>≈</mo><mn>0.90</mn></mrow><annotation encoding="application/x-tex">\bar{w} \approx 0.90</annotation></semantics></math></td>
<td align="left">~61 items</td>
<td align="left">Mild</td>
<td align="left">Prior choice matters MORE for non-normal G</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="practical-implications">Practical implications<a class="anchor" aria-label="anchor" href="#practical-implications"></a>
</h3>
<ul>
<li>
<strong>Low reliability</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>≈</mo><mn>0.50</mn></mrow><annotation encoding="application/x-tex">\bar{w} \approx 0.50</annotation></semantics></math>):
Shrinkage dominates. CB provides the largest EDF gains; model
flexibility matters less because posteriors concentrate around the prior
regardless.</li>
<li>
<strong>Moderate reliability</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>≈</mo><mn>0.70</mn></mrow><annotation encoding="application/x-tex">\bar{w} \approx 0.70</annotation></semantics></math>):
Both estimator and prior contribute meaningfully. DPM + GR starts to
outperform Normal + GR for non-normal populations. Most screening
instruments (20–30 items) fall in this regime.</li>
<li>
<strong>High reliability</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>≈</mo><mn>0.90</mn></mrow><annotation encoding="application/x-tex">\bar{w} \approx 0.90</annotation></semantics></math>):
All three estimators converge. Prior choice (DPM vs. Normal) becomes the
primary driver of EDF and ranking accuracy for non-normal
distributions.</li>
</ul>
<blockquote>
<p><strong>Rule of thumb.</strong> If you have a short test and a
non-normal population, start with CB. If you have a long test and
suspect non-normality, invest in the DPM prior and use GR.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="visualizing-the-reliability-effect">Visualizing the reliability effect<a class="anchor" aria-label="anchor" href="#visualizing-the-reliability-effect"></a>
</h3>
<p>The figure below makes the abstract table concrete. Both panels show
a bimodal population estimated with a DPM prior, but the left panel uses
a 10-item test
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>≈</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\bar{w} \approx 0.5</annotation></semantics></math>)
while the right uses a 25-item test
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>≈</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\bar{w} \approx 0.8</annotation></semantics></math>).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load both reliability conditions</span></span>
<span><span class="va">comp_hi</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">find_extdata</span><span class="op">(</span><span class="st">"vignette_estimates_comparison.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">comp_lo</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">find_extdata</span><span class="op">(</span><span class="st">"vignette_estimates_comparison_lowrel.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">build_panel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">comp_obj</span>, <span class="va">label</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">comp_obj</span><span class="op">$</span><span class="va">true_theta</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">comp_obj</span><span class="op">$</span><span class="va">true_theta</span>,</span>
<span>              <span class="va">comp_obj</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_pm</span>,</span>
<span>              <span class="va">comp_obj</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_cb</span>,</span>
<span>              <span class="va">comp_obj</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_gr</span><span class="op">)</span>,</span>
<span>    Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True"</span>, <span class="st">"PM"</span>, <span class="st">"CB"</span>, <span class="st">"GR"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">N</span><span class="op">)</span>,</span>
<span>                    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True"</span>, <span class="st">"PM"</span>, <span class="st">"CB"</span>, <span class="st">"GR"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    Reliability <span class="op">=</span> <span class="va">label</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">df_rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">build_panel</span><span class="op">(</span><span class="va">comp_lo</span>, <span class="st">"\u03C1 \u2248 0.5  (10 items)"</span><span class="op">)</span>,</span>
<span>  <span class="fu">build_panel</span><span class="op">(</span><span class="va">comp_hi</span>, <span class="st">"\u03C1 \u2248 0.8  (25 items)"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df_rel</span><span class="op">$</span><span class="va">Reliability</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">df_rel</span><span class="op">$</span><span class="va">Reliability</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"\u03C1 \u2248 0.5  (10 items)"</span>,</span>
<span>             <span class="st">"\u03C1 \u2248 0.8  (25 items)"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_rel</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, colour <span class="op">=</span> <span class="va">Method</span>, fill <span class="op">=</span> <span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.15</span>, linewidth <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Reliability</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>True <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"true"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                  PM   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"pm"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                  CB   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"cb"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                  GR   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"gr"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>True <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"true"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                PM   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"pm"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                CB   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"cb"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                GR   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">palette_dpmirt</span><span class="op">[</span><span class="st">"gr"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Reliability determines when estimator choice matters"</span>,</span>
<span>       x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="posterior-summaries_files/figure-html/reliability-comparison-1.png" class="r-plt" alt="Effect of reliability on estimator behavior.  Left ($\rho \approx 0.5$, 10 items): PM (red) collapses the bimodal distribution into a sharp unimodal peak --- the two modes are completely lost.  CB (blue) and GR (green) resist this compression, preserving the two-group structure even with severe shrinkage.  Right ($\rho \approx 0.8$, 25 items): all three estimators begin to recover the true bimodal shape, with GR tracking the truth most closely." width="85%"><p class="caption">
Effect of reliability on estimator behavior. Left
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>≈</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\rho \approx 0.5</annotation></semantics></math>,
10 items): PM (red) collapses the bimodal distribution into a sharp
unimodal peak — the two modes are completely lost. CB (blue) and GR
(green) resist this compression, preserving the two-group structure even
with severe shrinkage. Right
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>≈</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\rho \approx 0.8</annotation></semantics></math>,
25 items): all three estimators begin to recover the true bimodal shape,
with GR tracking the truth most closely.
</p>
</div>
<p>At low reliability (left panel), the posterior for each person is
heavily shrunk toward the prior center, so the PM distribution collapses
to a narrow unimodal peak. CB and GR resist this compression by
inflating the variance (CB) or placing estimates at quantiles of the
estimated EDF (GR), preserving the two-group structure.</p>
<p>At high reliability (right panel), the data speak loudly enough that
even PM preserves the bimodal shape. The three estimators converge, and
the primary gains come from using the DPM prior rather than the Normal
prior (see Section 5.4 of
<code><a href="../articles/models-and-workflow.html">vignette("models-and-workflow")</a></code>).</p>
</div>
<div class="section level3">
<h3 id="quantifying-the-shrinkage">Quantifying the shrinkage<a class="anchor" aria-label="anchor" href="#quantifying-the-shrinkage"></a>
</h3>
<p>The table below makes the shrinkage problem concrete with numbers,
comparing the standard deviation of each estimator to the true SD.</p>
<table class="table">
<caption>Dispersion of estimates relative to truth. At low reliability,
PM retains only ~50% of the true SD; CB and GR recover
~80-95%.</caption>
<thead><tr class="header">
<th align="left">Statistic</th>
<th align="right">ρ ≈ 0.5</th>
<th align="right">ρ ≈ 0.8</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SD(True)</td>
<td align="right">0.991</td>
<td align="right">0.955</td>
</tr>
<tr class="even">
<td align="left">SD(PM)</td>
<td align="right">0.493</td>
<td align="right">0.948</td>
</tr>
<tr class="odd">
<td align="left">SD(CB)</td>
<td align="right">0.700</td>
<td align="right">1.075</td>
</tr>
<tr class="even">
<td align="left">SD(GR)</td>
<td align="right">0.696</td>
<td align="right">1.073</td>
</tr>
<tr class="odd">
<td align="left">Ratio PM/True</td>
<td align="right">0.497</td>
<td align="right">0.992</td>
</tr>
<tr class="even">
<td align="left">Ratio CB/True</td>
<td align="right">0.707</td>
<td align="right">1.125</td>
</tr>
<tr class="odd">
<td align="left">Ratio GR/True</td>
<td align="right">0.703</td>
<td align="right">1.123</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Reading the table.</strong> The “Ratio” rows reveal the
shrinkage severity. At
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>≈</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\rho \approx 0.5</annotation></semantics></math>,
PM compresses the distribution to roughly half its true spread (ratio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≈</mo><mn>0.50</mn></mrow><annotation encoding="application/x-tex">\approx 0.50</annotation></semantics></math>).
CB and GR partially resist this compression, recovering about 70% of the
true SD (ratio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≈</mo><mn>0.70</mn></mrow><annotation encoding="application/x-tex">\approx 0.70</annotation></semantics></math>).
At
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>≈</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\rho \approx 0.8</annotation></semantics></math>,
all three estimators converge toward — or even slightly exceed — the
true dispersion (ratios near 1.0), confirming that reliability is the
dominant moderator of shrinkage severity.</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="practical-recommendations">9. Practical Recommendations<a class="anchor" aria-label="anchor" href="#practical-recommendations"></a>
</h2>
<p>The table below summarises estimator-prior pairings for common
operational goals.</p>
<table class="table">
<caption>Quick-reference guide: estimator and prior by goal.</caption>
<colgroup>
<col width="30%">
<col width="11%">
<col width="58%">
</colgroup>
<thead><tr class="header">
<th align="left">Primary Goal</th>
<th align="left">Estimator</th>
<th align="left">Prior Recommendation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Individual scoring</td>
<td align="left">PM</td>
<td align="left">Either (Normal or DPM)</td>
</tr>
<tr class="even">
<td align="left">Identify extreme students</td>
<td align="left">GR</td>
<td align="left">DPM if reliability &gt; 0.7 and non-normal
suspected</td>
</tr>
<tr class="odd">
<td align="left">Proportion below cutoff</td>
<td align="left">GR</td>
<td align="left">DPM if reliability &gt; 0.7</td>
</tr>
<tr class="even">
<td align="left">Recover full distribution</td>
<td align="left">GR</td>
<td align="left">DPM strongly recommended</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="decision-workflow">Decision workflow<a class="anchor" aria-label="anchor" href="#decision-workflow"></a>
</h3>
<p>A simple three-step workflow: 1. <strong>Determine your primary
goal.</strong> What will the scores be used for? If individual feedback,
use PM. If classification, ranking, or distributional summaries, use GR.
2. <strong>Assess reliability.</strong> Estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>w</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{w}</annotation></semantics></math>
from KR-20 or the model’s average posterior variance. If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>&lt;</mo><mn>0.65</mn></mrow><annotation encoding="application/x-tex">\bar{w} &lt; 0.65</annotation></semantics></math>,
estimator choice dominates; if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>&gt;</mo><mn>0.80</mn></mrow><annotation encoding="application/x-tex">\bar{w} &gt; 0.80</annotation></semantics></math>,
prior choice dominates. 3. <strong>Choose the prior.</strong> If
reliability is high and there is reason to doubt normality (e.g., known
floor/ceiling effects, gifted subpopulations, mixed curricula), use a
DPM prior. Otherwise a Normal prior is sufficient.</p>
</div>
</div>
<div class="section level2">
<h2 id="loss-functions-for-evaluation">10. Loss Functions for Evaluation<a class="anchor" aria-label="anchor" href="#loss-functions-for-evaluation"></a>
</h2>
<p>When true parameter values are available (e.g., in a simulation
study), <code><a href="../reference/dpmirt_loss.html">dpmirt_loss()</a></code> computes the three loss functions
that correspond to the three goals.</p>
<div class="section level3">
<h3 id="built-in-loss-functions">Built-in loss functions<a class="anchor" aria-label="anchor" href="#built-in-loss-functions"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assume 'fit' was run on simulated data with known true values</span></span>
<span><span class="va">est</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_estimates.html">dpmirt_estimates</a></span><span class="op">(</span><span class="va">fit</span>, methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pm"</span>, <span class="st">"cb"</span>, <span class="st">"gr"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">loss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_loss.html">dpmirt_loss</a></span><span class="op">(</span><span class="va">est</span>, true_theta <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">theta</span>, true_beta <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">loss</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Loss function results (DPM prior, bimodal population, 25 items,
rho=0.8). PM wins on MSEL; GR wins on MSELR and KS.</caption>
<thead><tr class="header">
<th align="left">Method</th>
<th align="right">MSEL</th>
<th align="right">MSELR</th>
<th align="right">KS</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">PM</td>
<td align="right">0.2544</td>
<td align="right">0.024992</td>
<td align="right">0.095</td>
</tr>
<tr class="even">
<td align="left">CB</td>
<td align="right">0.3029</td>
<td align="right">0.024992</td>
<td align="right">0.080</td>
</tr>
<tr class="odd">
<td align="left">GR</td>
<td align="right">0.3136</td>
<td align="right">0.024868</td>
<td align="right">0.055</td>
</tr>
</tbody>
</table>
<p>The pattern is typical:</p>
<ul>
<li>
<strong>MSEL:</strong> PM
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>&lt;</mo><annotation encoding="application/x-tex">&lt;</annotation></semantics></math>
GR
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>&lt;</mo><annotation encoding="application/x-tex">&lt;</annotation></semantics></math>
CB — posterior mean minimises individual MSE by construction.</li>
<li>
<strong>MSELR:</strong> GR
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>&lt;</mo><annotation encoding="application/x-tex">&lt;</annotation></semantics></math>
PM
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≈</mo><annotation encoding="application/x-tex">\approx</annotation></semantics></math>
CB — the triple-goal algorithm directly optimises ranking loss.</li>
<li>
<strong>KS:</strong> GR
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>&lt;</mo><annotation encoding="application/x-tex">&lt;</annotation></semantics></math>
CB
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>&lt;</mo><annotation encoding="application/x-tex">&lt;</annotation></semantics></math>
PM — GR and CB both reduce distributional bias, with GR achieving the
tightest fit.</li>
</ul>
<p>When reliability drops, the loss differences across estimators become
more pronounced:</p>
<table class="table">
<caption>Loss comparison across reliability levels. At low reliability,
estimator differences are amplified — especially for KS, where GR
achieves a much tighter fit than PM.</caption>
<thead><tr class="header">
<th align="left">Reliability</th>
<th align="left">Method</th>
<th align="right">MSEL</th>
<th align="right">MSELR</th>
<th align="right">KS</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ρ ≈ 0.5</td>
<td align="left">PM</td>
<td align="right">0.5561</td>
<td align="right">0.054310</td>
<td align="right">0.285</td>
</tr>
<tr class="even">
<td align="left">ρ ≈ 0.5</td>
<td align="left">CB</td>
<td align="right">0.5234</td>
<td align="right">0.054310</td>
<td align="right">0.220</td>
</tr>
<tr class="odd">
<td align="left">ρ ≈ 0.5</td>
<td align="left">GR</td>
<td align="right">0.5338</td>
<td align="right">0.054209</td>
<td align="right">0.165</td>
</tr>
<tr class="even">
<td align="left">ρ ≈ 0.8</td>
<td align="left">PM</td>
<td align="right">0.2544</td>
<td align="right">0.024992</td>
<td align="right">0.095</td>
</tr>
<tr class="odd">
<td align="left">ρ ≈ 0.8</td>
<td align="left">CB</td>
<td align="right">0.3029</td>
<td align="right">0.024992</td>
<td align="right">0.080</td>
</tr>
<tr class="even">
<td align="left">ρ ≈ 0.8</td>
<td align="left">GR</td>
<td align="right">0.3136</td>
<td align="right">0.024868</td>
<td align="right">0.055</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="custom-loss-functions">Custom loss functions<a class="anchor" aria-label="anchor" href="#custom-loss-functions"></a>
</h3>
<p>Supply an arbitrary loss function via <code>custom_loss</code>. The
function must accept two numeric vectors and return a scalar.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mean absolute error</span></span>
<span><span class="va">mae_loss</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">est</span>, <span class="va">true</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">est</span> <span class="op">-</span> <span class="va">true</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">loss_mae</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_loss.html">dpmirt_loss</a></span><span class="op">(</span></span>
<span>  <span class="va">est</span>,</span>
<span>  true_theta  <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">theta</span>,</span>
<span>  true_beta   <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">beta</span>,</span>
<span>  custom_loss <span class="op">=</span> <span class="va">mae_loss</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">loss_mae</span><span class="op">)</span></span></code></pre></div>
<p>See <code><a href="../articles/simulation-study.html">vignette("simulation-study")</a></code> for a full factorial
comparison of loss across reliability levels, sample sizes, latent
shapes, and priors.</p>
</div>
</div>
<div class="section level2">
<h2 id="summary-and-next-steps">11. Summary and Next Steps<a class="anchor" aria-label="anchor" href="#summary-and-next-steps"></a>
</h2>
<p>This vignette has shown that:</p>
<ul>
<li>The posterior mean (PM) is optimal when the inferential goal is
individual-level accuracy (Goal 1: minimise MSEL).</li>
<li>The constrained Bayes (CB) estimator corrects the under-dispersion
of PM by matching the first two moments of the marginal distribution. It
is most helpful when reliability is low and a simple correction
suffices.</li>
<li>The triple-goal (GR) estimator simultaneously optimises ranking and
distribution recovery (Goals 2 and 3). It is the recommended estimator
whenever classification, selection, or distributional summaries are the
primary output.</li>
<li>Test reliability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>w</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{w}</annotation></semantics></math>,
not sample size, is the dominant moderator of estimator performance.
Short tests benefit most from estimator choice; long tests benefit most
from prior choice (DPM vs. Normal).</li>
</ul>
<div class="section level3">
<h3 id="what-next">What next?<a class="anchor" aria-label="anchor" href="#what-next"></a>
</h3>
<ul>
<li>
<strong>Simulation study.</strong> See
<code><a href="../articles/simulation-study.html">vignette("simulation-study")</a></code> for a full factorial
evaluation of prior
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>×</mi><annotation encoding="application/x-tex">\times</annotation></semantics></math>
estimator
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>×</mi><annotation encoding="application/x-tex">\times</annotation></semantics></math>
reliability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>×</mi><annotation encoding="application/x-tex">\times</annotation></semantics></math>
latent shape.</li>
<li>
<strong>Prior elicitation.</strong> See
<code><a href="../articles/prior-elicitation.html">vignette("prior-elicitation")</a></code> for principled selection of
the DPM concentration parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
using the DPprior package.</li>
<li>
<strong>Getting started.</strong> If you have not yet fit your first
model, see <code>vignette("getting-started")</code> for the basic DPMirt
workflow.</li>
</ul>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<ul>
<li>Ghosh, M. (1992). Constrained Bayes estimation with applications.
<em>Journal of the American Statistical Association, 87</em>(418),
533–540.</li>
<li>Lee, J. &amp; Wind, S. Targeting toward inferential goals in
Bayesian Rasch models for estimating person-specific latent traits.
<em>OSF Preprint</em>. <a href="https://doi.org/10.31219/osf.io/qrw4n" class="external-link uri">https://doi.org/10.31219/osf.io/qrw4n</a>
</li>
<li>Louis, T. A. (1984). Estimating a population of parameter values
using Bayes and empirical Bayes methods. <em>Journal of the American
Statistical Association, 79</em>(386), 393–398.</li>
<li>Paganin, S., Paciorek, C. J., Wehrhahn, C., Rodríguez, A.,
Rabe-Hesketh, S., &amp; de Valpine, P. (2023). Computational strategies
and estimation performance with Bayesian semiparametric item response
theory models. <em>Journal of Educational and Behavioral Statistics,
48</em>(2), 147–188. <a href="https://doi.org/10.3102/10769986221136105" class="external-link uri">https://doi.org/10.3102/10769986221136105</a>
</li>
<li>Shen, W., &amp; Louis, T. A. (1998). Triple-goal estimates in
two-stage hierarchical models. <em>Journal of the Royal Statistical
Society: Series B, 60</em>(2), 455–471.</li>
</ul>
<pre><code><span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Tahoe 26.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] C.UTF-8/C.UTF-8/C.UTF-8/C/C.UTF-8/C.UTF-8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: America/Chicago</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] ggplot2_4.0.2 DPMirt_0.1.0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gtable_0.3.6        jsonlite_2.0.0      dplyr_1.2.0        </span></span>
<span><span class="co">#&gt;  [4] compiler_4.5.1      tidyselect_1.2.1    parallel_4.5.1     </span></span>
<span><span class="co">#&gt;  [7] dichromat_2.0-0.1   jquerylib_0.1.4     systemfonts_1.3.1  </span></span>
<span><span class="co">#&gt; [10] scales_1.4.0        textshaping_1.0.1   yaml_2.3.12        </span></span>
<span><span class="co">#&gt; [13] fastmap_1.2.0       lattice_0.22-7      coda_0.19-4.1      </span></span>
<span><span class="co">#&gt; [16] R6_2.6.1            labeling_0.4.3      generics_0.1.4     </span></span>
<span><span class="co">#&gt; [19] igraph_2.2.1        nimble_1.4.0        knitr_1.50         </span></span>
<span><span class="co">#&gt; [22] htmlwidgets_1.6.4   tibble_3.3.1        desc_1.4.3         </span></span>
<span><span class="co">#&gt; [25] pillar_1.11.1       bslib_0.9.0         RColorBrewer_1.1-3 </span></span>
<span><span class="co">#&gt; [28] rlang_1.1.7         cachem_1.1.0        xfun_0.53          </span></span>
<span><span class="co">#&gt; [31] fs_1.6.6            sass_0.4.10         S7_0.2.1           </span></span>
<span><span class="co">#&gt; [34] cli_3.6.5           withr_3.0.2         pkgdown_2.2.0      </span></span>
<span><span class="co">#&gt; [37] magrittr_2.0.4      digest_0.6.37       grid_4.5.1         </span></span>
<span><span class="co">#&gt; [40] lifecycle_1.0.5     vctrs_0.7.1         evaluate_1.0.5     </span></span>
<span><span class="co">#&gt; [43] pracma_2.4.6        glue_1.8.0          farver_2.1.2       </span></span>
<span><span class="co">#&gt; [46] numDeriv_2016.8-1.1 ragg_1.4.0          rmarkdown_2.30     </span></span>
<span><span class="co">#&gt; [49] tools_4.5.1         pkgconfig_2.0.3     htmltools_0.5.8.1</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/joonho112" class="external-link">JoonHo Lee</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
