<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Simulation Study: Evaluating Prior Models and Posterior Summaries • DPMirt</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulation Study: Evaluating Prior Models and Posterior Summaries">
<meta name="description" content="A comprehensive guide to designing, executing, and analyzing simulation studies with DPMirt --- covering factorial design, IRTsimrel integration, the full analysis pipeline, loss function evaluation, and key findings from the APM manuscript.
">
<meta property="og:description" content="A comprehensive guide to designing, executing, and analyzing simulation studies with DPMirt --- covering factorial design, IRTsimrel integration, the full analysis pipeline, loss function evaluation, and key findings from the APM manuscript.
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DPMirt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><h6 class="dropdown-header" data-toc-skip>--- Getting Started ---</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/quick-start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/models-and-workflow.html">Models &amp; Workflow</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>--- Theory &amp; Methods ---</h6></li>
    <li><a class="dropdown-item" href="../articles/theory-irt-dpm.html">IRT &amp; DPM Theory</a></li>
    <li><a class="dropdown-item" href="../articles/posterior-summaries.html">Posterior Summaries</a></li>
    <li><a class="dropdown-item" href="../articles/prior-elicitation.html">Prior Elicitation</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>--- Advanced ---</h6></li>
    <li><a class="dropdown-item" href="../articles/nimble-internals.html">NIMBLE Internals</a></li>
    <li><a class="dropdown-item" href="../articles/simulation-study.html">Simulation Study</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joonho112/DPMirt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulation Study: Evaluating Prior Models and Posterior Summaries</h1>
                        <h4 data-toc-skip class="author">JoonHo Lee</h4>
            
            <h4 data-toc-skip class="date">2026-02-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/joonho112/DPMirt/blob/HEAD/vignettes/simulation-study.Rmd" class="external-link"><code>vignettes/simulation-study.Rmd</code></a></small>
      <div class="d-none name"><code>simulation-study.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Simulation studies are the primary tool for evaluating IRT methods
because they provide access to the ground truth — the true person
abilities and item parameters that generated the data. DPMirt provides
an integrated simulation framework that lets you:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Simulate</strong> data under known conditions using
IRTsimrel’s EQC calibration (or a built-in fallback).</li>
<li>
<strong>Fit</strong> models under competing prior specifications
(Normal vs. DPM).</li>
<li>
<strong>Estimate</strong> person abilities using three posterior
summary methods (PM, CB, GR).</li>
<li>
<strong>Evaluate</strong> performance using multiple loss functions
(MSEL, MSELR, KS).</li>
</ol>
<p>This vignette walks through a complete simulation study design,
executes a single-condition deep dive, interprets the results, and
provides templates for scaling to a full factorial study.</p>
</div>
<div class="section level2">
<h2 id="simulation-design">Simulation Design<a class="anchor" aria-label="anchor" href="#simulation-design"></a>
</h2>
<p>The APM manuscript (Lee &amp; Wind) uses a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>×</mo><mn>2</mn><mo>×</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">3 \times 2 \times 3</annotation></semantics></math>
factorial design crossing three factors:</p>
<div class="section level3">
<h3 id="factor-1-latent-distribution-shape-g">Factor 1: Latent Distribution Shape
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#factor-1-latent-distribution-shape-g"></a>
</h3>
<table class="table">
<colgroup>
<col width="16%">
<col width="30%">
<col width="52%">
</colgroup>
<thead><tr class="header">
<th align="left">Shape</th>
<th align="left">Description</th>
<th align="left">Generating mechanism</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Normal</td>
<td align="left">Standard Gaussian</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>∼</mo><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\theta \sim N(0, 1)</annotation></semantics></math></td>
</tr>
<tr class="even">
<td align="left">Bimodal</td>
<td align="left">Two-group mixture</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.5</mn><mo>⋅</mo><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mi>−</mi><mn>1.5</mn><mo>,</mo><mn>0.5</mn><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mn>0.5</mn><mo>⋅</mo><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mn>1.5</mn><mo>,</mo><mn>0.5</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">0.5 \cdot N(-1.5, 0.5) + 0.5 \cdot N(1.5, 0.5)</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td align="left">Skew</td>
<td align="left">Right-skewed</td>
<td align="left">Shifted exponential:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Exp</mtext><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{Exp}(1) - 1</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
<p>The <strong>Normal</strong> condition is the parametric model’s “home
turf” where DPM offers little advantage. The <strong>Bimodal</strong>
and <strong>Skew</strong> conditions represent departures where flexible
priors should excel.</p>
</div>
<div class="section level3">
<h3 id="factor-2-sample-size-n">Factor 2: Sample Size
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#factor-2-sample-size-n"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math></th>
<th align="left">Interpretation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">50</td>
<td align="left">Small sample: high uncertainty, strong shrinkage</td>
</tr>
<tr class="even">
<td align="left">200</td>
<td align="left">Moderate sample: reliable estimation for most
methods</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="factor-3-marginal-reliability-barw">Factor 3: Marginal Reliability
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>w</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{w}</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#factor-3-marginal-reliability-barw"></a>
</h3>
<p>Reliability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>w</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{w}</annotation></semantics></math>
is the most influential factor in the simulation. It controls the
information per person and therefore the degree of posterior
shrinkage.</p>
<table class="table">
<caption>Reliability levels and their implications for IRT
estimation.</caption>
<thead><tr class="header">
<th align="center">w-bar</th>
<th align="center">~Items (Rasch)</th>
<th align="center">Shrinkage</th>
<th align="center">Separation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">0.50</td>
<td align="center">~10</td>
<td align="center">Severe</td>
<td align="center">1.0</td>
</tr>
<tr class="even">
<td align="center">0.70</td>
<td align="center">~23</td>
<td align="center">Moderate</td>
<td align="center">1.5</td>
</tr>
<tr class="odd">
<td align="center">0.90</td>
<td align="center">~61</td>
<td align="center">Mild</td>
<td align="center">3.0</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Why reliability dominates:</strong> At
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>=</mo><mn>0.50</mn></mrow><annotation encoding="application/x-tex">\bar{w} = 0.50</annotation></semantics></math>,
each person’s posterior is heavily shrunk toward the prior — there is
little room for any method to differ from another. At
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>=</mo><mn>0.90</mn></mrow><annotation encoding="application/x-tex">\bar{w} = 0.90</annotation></semantics></math>,
posteriors are tightly concentrated around data-driven estimates,
amplifying the impact of prior misspecification.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="full-design-matrix">Full Design Matrix<a class="anchor" aria-label="anchor" href="#full-design-matrix"></a>
</h3>
<p>The full factorial design has
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>×</mo><mn>2</mn><mo>×</mo><mn>3</mn><mo>=</mo><mn>18</mn></mrow><annotation encoding="application/x-tex">3 \times 2 \times 3 = 18</annotation></semantics></math>
conditions. Each condition is replicated (e.g., 100 times) for Monte
Carlo stability.</p>
<table class="table">
<caption>Full 3 x 2 x 3 factorial design (18 conditions).</caption>
<thead><tr class="header">
<th align="center">Condition</th>
<th align="left">G</th>
<th align="center">N</th>
<th align="center">w_bar</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="left">Normal</td>
<td align="center">50</td>
<td align="center">0.5</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="left">Bimodal</td>
<td align="center">50</td>
<td align="center">0.5</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="left">Skew</td>
<td align="center">50</td>
<td align="center">0.5</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="left">Normal</td>
<td align="center">200</td>
<td align="center">0.5</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="left">Bimodal</td>
<td align="center">200</td>
<td align="center">0.5</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="left">Skew</td>
<td align="center">200</td>
<td align="center">0.5</td>
</tr>
<tr class="odd">
<td align="center">7</td>
<td align="left">Normal</td>
<td align="center">50</td>
<td align="center">0.7</td>
</tr>
<tr class="even">
<td align="center">8</td>
<td align="left">Bimodal</td>
<td align="center">50</td>
<td align="center">0.7</td>
</tr>
<tr class="odd">
<td align="center">9</td>
<td align="left">Skew</td>
<td align="center">50</td>
<td align="center">0.7</td>
</tr>
<tr class="even">
<td align="center">10</td>
<td align="left">Normal</td>
<td align="center">200</td>
<td align="center">0.7</td>
</tr>
<tr class="odd">
<td align="center">11</td>
<td align="left">Bimodal</td>
<td align="center">200</td>
<td align="center">0.7</td>
</tr>
<tr class="even">
<td align="center">12</td>
<td align="left">Skew</td>
<td align="center">200</td>
<td align="center">0.7</td>
</tr>
<tr class="odd">
<td align="center">13</td>
<td align="left">Normal</td>
<td align="center">50</td>
<td align="center">0.9</td>
</tr>
<tr class="even">
<td align="center">14</td>
<td align="left">Bimodal</td>
<td align="center">50</td>
<td align="center">0.9</td>
</tr>
<tr class="odd">
<td align="center">15</td>
<td align="left">Skew</td>
<td align="center">50</td>
<td align="center">0.9</td>
</tr>
<tr class="even">
<td align="center">16</td>
<td align="left">Normal</td>
<td align="center">200</td>
<td align="center">0.9</td>
</tr>
<tr class="odd">
<td align="center">17</td>
<td align="left">Bimodal</td>
<td align="center">200</td>
<td align="center">0.9</td>
</tr>
<tr class="even">
<td align="center">18</td>
<td align="left">Skew</td>
<td align="center">200</td>
<td align="center">0.9</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="irtsimrel-integration">IRTsimrel Integration<a class="anchor" aria-label="anchor" href="#irtsimrel-integration"></a>
</h3>
<p>DPMirt uses the <strong>IRTsimrel</strong> package (when available)
to achieve precise reliability targeting via Empirical Quadrature
Calibration (EQC). The key function is
<code><a href="../reference/dpmirt_simulate.html">dpmirt_simulate()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate bimodal data with target reliability 0.8</span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_simulate.html">dpmirt_simulate</a></span><span class="op">(</span></span>
<span>  n_persons    <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  n_items      <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  model        <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  target_rho   <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  latent_shape <span class="op">=</span> <span class="st">"bimodal"</span>,</span>
<span>  seed         <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim</span></span>
<span><span class="co">#&gt; DPMirt Simulated Data</span></span>
<span><span class="co">#&gt; =====================</span></span>
<span><span class="co">#&gt; Model:         RASCH </span></span>
<span><span class="co">#&gt; Persons:       200 </span></span>
<span><span class="co">#&gt; Items:         25 </span></span>
<span><span class="co">#&gt; Distribution:  bimodal </span></span>
<span><span class="co">#&gt; Method:        irtsimrel </span></span>
<span><span class="co">#&gt; Target rho:    0.8 </span></span>
<span><span class="co">#&gt; KR-20:         0.81 </span></span>
<span><span class="co">#&gt; EQC c*:        0.935 </span></span>
<span><span class="co">#&gt; EQC rho:       0.8</span></span></code></pre></div>
<p>The returned <code>dpmirt_sim</code> object reports:</p>
<ul>
<li>
<strong>Method</strong>: “irtsimrel” (EQC-calibrated) or “fallback”
(Paganin-style)</li>
<li>
<strong>KR-20</strong>: Empirical reliability of the generated
data</li>
<li>
<strong>EQC c</strong>*: The calibration constant that maps target
reliability to the number of items</li>
</ul>
<p>When IRTsimrel is not installed, <code><a href="../reference/dpmirt_simulate.html">dpmirt_simulate()</a></code> falls
back to a simpler simulation with evenly spaced item difficulties and no
reliability targeting.</p>
</div>
<div class="section level3">
<h3 id="visualizing-the-simulated-data">Visualizing the Simulated Data<a class="anchor" aria-label="anchor" href="#visualizing-the-simulated-data"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta_dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">theta</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">theta_dens</span>, main <span class="op">=</span> <span class="st">"True theta distribution (bimodal)"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">theta</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"black"</span>, alpha.f <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="simulation-study_files/figure-html/sim-theta-density-1.png" class="r-plt" alt="Density of true theta values from the bimodal simulation." width="85%"><p class="caption">
Density of true theta values from the bimodal simulation.
</p>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sum_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">response</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">sum_scores</span>, breaks <span class="op">=</span> <span class="fl">20</span>, main <span class="op">=</span> <span class="st">"Sum score distribution"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Sum score"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="va">pal</span><span class="op">$</span><span class="va">parametric</span>, alpha.f <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>     border <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="simulation-study_files/figure-html/sim-sumscores-1.png" class="r-plt" alt="Distribution of sum scores from the simulated response matrix." width="85%"><p class="caption">
Distribution of sum scores from the simulated response matrix.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="analysis-pipeline">Analysis Pipeline<a class="anchor" aria-label="anchor" href="#analysis-pipeline"></a>
</h2>
<p>The full analysis pipeline for a single simulation condition consists
of six steps. Below we show the complete code you would run in a live
session, then load pre-computed results for the remaining analysis.</p>
<div class="section level3">
<h3 id="step-1-simulate-data">Step 1: Simulate Data<a class="anchor" aria-label="anchor" href="#step-1-simulate-data"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_simulate.html">dpmirt_simulate</a></span><span class="op">(</span></span>
<span>  n_persons    <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  n_items      <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  model        <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  target_rho   <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  latent_shape <span class="op">=</span> <span class="st">"bimodal"</span>,</span>
<span>  seed         <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-2-fit-models">Step 2: Fit Models<a class="anchor" aria-label="anchor" href="#step-2-fit-models"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># --- Fit Normal prior model (~2 min compilation + sampling) ---</span></span>
<span><span class="va">fit_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span></span>
<span>  <span class="va">sim</span><span class="op">$</span><span class="va">response</span>,</span>
<span>  model   <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  prior   <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  niter   <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  nburnin <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  seed    <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># --- Fit DPM prior model (~2 min compilation + sampling) ---</span></span>
<span><span class="va">fit_dpm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span></span>
<span>  <span class="va">sim</span><span class="op">$</span><span class="va">response</span>,</span>
<span>  model      <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  prior      <span class="op">=</span> <span class="st">"dpm"</span>,</span>
<span>  mu_K       <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  confidence <span class="op">=</span> <span class="st">"medium"</span>,</span>
<span>  niter      <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  nburnin    <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  seed       <span class="op">=</span> <span class="fl">200</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-3-extract-estimates">Step 3: Extract Estimates<a class="anchor" aria-label="anchor" href="#step-3-extract-estimates"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute PM, CB, GR for both models</span></span>
<span><span class="va">est_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_estimates.html">dpmirt_estimates</a></span><span class="op">(</span><span class="va">fit_normal</span>, methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pm"</span>, <span class="st">"cb"</span>, <span class="st">"gr"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">est_dpm</span>    <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_estimates.html">dpmirt_estimates</a></span><span class="op">(</span><span class="va">fit_dpm</span>,    methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pm"</span>, <span class="st">"cb"</span>, <span class="st">"gr"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-4-evaluate-losses">Step 4: Evaluate Losses<a class="anchor" aria-label="anchor" href="#step-4-evaluate-losses"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare to true theta</span></span>
<span><span class="va">loss_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_loss.html">dpmirt_loss</a></span><span class="op">(</span><span class="va">est_normal</span>, true_theta <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">theta</span>,</span>
<span>                            true_beta <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span></span>
<span><span class="va">loss_dpm</span>    <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_loss.html">dpmirt_loss</a></span><span class="op">(</span><span class="va">est_dpm</span>,    true_theta <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">theta</span>,</span>
<span>                            true_beta <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-5-combine-results">Step 5: Combine Results<a class="anchor" aria-label="anchor" href="#step-5-combine-results"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loss_normal</span><span class="op">$</span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="st">"Normal"</span></span>
<span><span class="va">loss_dpm</span><span class="op">$</span><span class="va">prior</span>    <span class="op">&lt;-</span> <span class="st">"DPM"</span></span>
<span><span class="va">combined_loss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">loss_normal</span>, <span class="va">loss_dpm</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="loading-pre-computed-results">Loading Pre-Computed Results<a class="anchor" aria-label="anchor" href="#loading-pre-computed-results"></a>
</h3>
<p>For this vignette, all fitting results are pre-computed:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load pre-computed simulation data</span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">find_extdata</span><span class="op">(</span><span class="st">"vignette_sim_bimodal.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load estimates comparison (all 6 method-prior combos)</span></span>
<span><span class="va">est_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">find_extdata</span><span class="op">(</span><span class="st">"vignette_estimates_comparison.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load loss results</span></span>
<span><span class="va">loss_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">find_extdata</span><span class="op">(</span><span class="st">"vignette_loss_results.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="single-condition-deep-dive">Single Condition Deep Dive<a class="anchor" aria-label="anchor" href="#single-condition-deep-dive"></a>
</h2>
<p>We focus on the most informative condition: <strong>Bimodal</strong>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">N = 200</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>≈</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\bar{w} \approx 0.8</annotation></semantics></math>.
This is where the DPM prior should show the clearest advantage over the
Normal prior, because the true latent distribution violates the Gaussian
assumption and the data are informative enough for the posterior to
reflect that violation.</p>
<div class="section level3">
<h3 id="posterior-density-overlay">Posterior Density Overlay<a class="anchor" aria-label="anchor" href="#posterior-density-overlay"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta_true</span> <span class="op">&lt;-</span> <span class="va">est_comparison</span><span class="op">$</span><span class="va">true_theta</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">theta_true</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">theta_true</span>,</span>
<span>            <span class="va">est_comparison</span><span class="op">$</span><span class="va">normal</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_pm</span>,</span>
<span>            <span class="va">est_comparison</span><span class="op">$</span><span class="va">normal</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_cb</span>,</span>
<span>            <span class="va">est_comparison</span><span class="op">$</span><span class="va">normal</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_gr</span>,</span>
<span>            <span class="va">est_comparison</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_pm</span>,</span>
<span>            <span class="va">est_comparison</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_cb</span>,</span>
<span>            <span class="va">est_comparison</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_gr</span><span class="op">)</span>,</span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True"</span>, <span class="st">"Normal-PM"</span>, <span class="st">"Normal-CB"</span>, <span class="st">"Normal-GR"</span>,</span>
<span>                         <span class="st">"DPM-PM"</span>, <span class="st">"DPM-CB"</span>, <span class="st">"DPM-GR"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">N</span><span class="op">)</span>,</span>
<span>                  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True"</span>, <span class="st">"Normal-PM"</span>, <span class="st">"Normal-CB"</span>, <span class="st">"Normal-GR"</span>,</span>
<span>                             <span class="st">"DPM-PM"</span>, <span class="st">"DPM-CB"</span>, <span class="st">"DPM-GR"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">method_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"True"</span>      <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  <span class="st">"Normal-PM"</span> <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">normal_pm</span>, <span class="st">"Normal-CB"</span> <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">normal_cb</span>,</span>
<span>  <span class="st">"Normal-GR"</span> <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">normal_gr</span>,</span>
<span>  <span class="st">"DPM-PM"</span>    <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">dpm_pm</span>, <span class="st">"DPM-CB"</span> <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">dpm_cb</span>,</span>
<span>  <span class="st">"DPM-GR"</span>    <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">dpm_gr</span></span>
<span><span class="op">)</span></span>
<span><span class="va">method_lty</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True"</span> <span class="op">=</span> <span class="st">"solid"</span>,</span>
<span>                <span class="st">"Normal-PM"</span> <span class="op">=</span> <span class="st">"solid"</span>, <span class="st">"Normal-CB"</span> <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>                <span class="st">"Normal-GR"</span> <span class="op">=</span> <span class="st">"dotted"</span>,</span>
<span>                <span class="st">"DPM-PM"</span>    <span class="op">=</span> <span class="st">"solid"</span>, <span class="st">"DPM-CB"</span>    <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>                <span class="st">"DPM-GR"</span>    <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_dens</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, colour <span class="op">=</span> <span class="va">Method</span>, linetype <span class="op">=</span> <span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.9</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">method_colors</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">method_lty</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Posterior density comparison: 6 methods vs. truth"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Bimodal population, 25 items, 200 persons"</span>,</span>
<span>       x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="simulation-study_files/figure-html/density-overlay-1.png" class="r-plt" alt="Density estimates from six method-prior combinations overlaid with the true latent density.  DPM-based methods (warm colors) better capture the bimodal shape." width="85%"><p class="caption">
Density estimates from six method-prior combinations overlaid with the
true latent density. DPM-based methods (warm colors) better capture the
bimodal shape.
</p>
</div>
<blockquote>
<p><strong>What to look for:</strong> Under the Normal prior, all three
estimators (PM, CB, GR) tend to “fill in” the valley between the two
modes because the Gaussian assumption forces a unimodal shape. The
DPM-based estimators, especially CB and GR, better preserve the bimodal
structure.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="shrinkage-comparison">Shrinkage Comparison<a class="anchor" aria-label="anchor" href="#shrinkage-comparison"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Normal-PM</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">theta_true</span>, <span class="va">est_comparison</span><span class="op">$</span><span class="va">normal</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_pm</span>,</span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">0.6</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="va">pal</span><span class="op">$</span><span class="va">normal_pm</span>, <span class="fl">0.6</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="va">true</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">hat</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">[</span><span class="va">PM</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Normal-PM"</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, col <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">reference</span>, lwd <span class="op">=</span> <span class="fl">1.5</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># DPM-PM</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">theta_true</span>, <span class="va">est_comparison</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_pm</span>,</span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">0.6</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="va">pal</span><span class="op">$</span><span class="va">dpm_pm</span>, <span class="fl">0.6</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="va">true</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">hat</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">[</span><span class="va">PM</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"DPM-PM"</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, col <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">reference</span>, lwd <span class="op">=</span> <span class="fl">1.5</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="simulation-study_files/figure-html/shrinkage-plot-1.png" class="r-plt" alt="Posterior mean (PM) estimates vs. true theta.  Normal-PM shows stronger shrinkage toward zero; DPM-PM preserves extreme values better." width="85%"><p class="caption">
Posterior mean (PM) estimates vs. true theta. Normal-PM shows stronger
shrinkage toward zero; DPM-PM preserves extreme values better.
</p>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="loss-function-results">Loss Function Results<a class="anchor" aria-label="anchor" href="#loss-function-results"></a>
</h3>
<p>Three complementary loss functions capture different aspects of
estimator quality:</p>
<table class="table">
<colgroup>
<col width="24%">
<col width="36%">
<col width="40%">
</colgroup>
<thead><tr class="header">
<th align="left">Loss</th>
<th align="left">Formula</th>
<th align="left">Measures</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><strong>MSEL</strong></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><msub><mo>∑</mo><mi>p</mi></msub><mo stretchy="false" form="prefix">(</mo><msub><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>p</mi></msub><mo>−</mo><msub><mi>θ</mi><mi>p</mi></msub><msup><mo stretchy="false" form="postfix">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\frac{1}{N}\sum_p(\hat{\theta}_p - \theta_p)^2</annotation></semantics></math></td>
<td align="left">Individual accuracy (Goal 1)</td>
</tr>
<tr class="even">
<td align="left"><strong>MSELR</strong></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><msub><mo>∑</mo><mi>p</mi></msub><mo stretchy="false" form="prefix">(</mo><mi>R</mi><mo stretchy="false" form="prefix">(</mo><msub><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>p</mi></msub><mo stretchy="false" form="postfix">)</mo><mi>/</mi><mi>N</mi><mo>−</mo><mi>R</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>θ</mi><mi>p</mi></msub><mo stretchy="false" form="postfix">)</mo><mi>/</mi><mi>N</mi><msup><mo stretchy="false" form="postfix">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\frac{1}{N}\sum_p(R(\hat{\theta}_p)/N - R(\theta_p)/N)^2</annotation></semantics></math></td>
<td align="left">Ranking accuracy (Goal 2)</td>
</tr>
<tr class="odd">
<td align="left"><strong>KS</strong></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi mathvariant="normal">max</mi><mo>⁡</mo></mrow><mi>t</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>F</mi><mover><mi>θ</mi><mo accent="true">̂</mo></mover></msub><mo stretchy="false" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="postfix">)</mo><mo>−</mo><msub><mi>F</mi><mi>θ</mi></msub><mo stretchy="false" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">|</mo></mrow><annotation encoding="application/x-tex">\max_t\lvert F_{\hat{\theta}}(t) - F_\theta(t)\rvert</annotation></semantics></math></td>
<td align="left">Distributional fidelity (Goal 3)</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># loss_results is a list with $normal and $dpm data.frames,</span></span>
<span><span class="co"># each with columns: parameter, method, msel, mselr, ks</span></span>
<span></span>
<span><span class="co"># Combine into one table with a prior column</span></span>
<span><span class="va">loss_normal</span> <span class="op">&lt;-</span> <span class="va">loss_results</span><span class="op">$</span><span class="va">normal</span></span>
<span><span class="va">loss_normal</span><span class="op">$</span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="st">"Normal"</span></span>
<span><span class="va">loss_dpm</span> <span class="op">&lt;-</span> <span class="va">loss_results</span><span class="op">$</span><span class="va">dpm</span></span>
<span><span class="va">loss_dpm</span><span class="op">$</span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="st">"DPM"</span></span>
<span><span class="va">loss_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">loss_normal</span>, <span class="va">loss_dpm</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter to theta and format</span></span>
<span><span class="va">loss_display</span> <span class="op">&lt;-</span> <span class="va">loss_combined</span><span class="op">[</span><span class="va">loss_combined</span><span class="op">$</span><span class="va">parameter</span> <span class="op">==</span> <span class="st">"theta"</span>, <span class="op">]</span></span>
<span><span class="va">loss_display</span> <span class="op">&lt;-</span> <span class="va">loss_display</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">loss_display</span><span class="op">$</span><span class="va">prior</span>, <span class="va">loss_display</span><span class="op">$</span><span class="va">method</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">loss_display</span><span class="op">$</span><span class="va">Label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">loss_display</span><span class="op">$</span><span class="va">prior</span>, <span class="st">"-"</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">loss_display</span><span class="op">$</span><span class="va">method</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">loss_display</span> <span class="op">&lt;-</span> <span class="va">loss_display</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Label"</span>, <span class="st">"msel"</span>, <span class="st">"mselr"</span>, <span class="st">"ks"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">loss_display</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Method"</span>, <span class="st">"MSEL"</span>, <span class="st">"MSELR"</span>, <span class="st">"KS"</span><span class="op">)</span></span>
<span><span class="va">loss_display</span><span class="op">$</span><span class="va">MSEL</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">loss_display</span><span class="op">$</span><span class="va">MSEL</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">loss_display</span><span class="op">$</span><span class="va">MSELR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">loss_display</span><span class="op">$</span><span class="va">MSELR</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">loss_display</span><span class="op">$</span><span class="va">KS</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">loss_display</span><span class="op">$</span><span class="va">KS</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">loss_display</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Loss function results: Bimodal, N=200, w-bar=0.8."</span>,</span>
<span>             align <span class="op">=</span> <span class="st">"lccc"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Loss function results: Bimodal, N=200, w-bar=0.8.</caption>
<thead><tr class="header">
<th align="left">Method</th>
<th align="center">MSEL</th>
<th align="center">MSELR</th>
<th align="center">KS</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">DPM-CB</td>
<td align="center">0.3029</td>
<td align="center">0.02499</td>
<td align="center">0.080</td>
</tr>
<tr class="even">
<td align="left">DPM-GR</td>
<td align="center">0.3136</td>
<td align="center">0.02487</td>
<td align="center">0.055</td>
</tr>
<tr class="odd">
<td align="left">DPM-PM</td>
<td align="center">0.2544</td>
<td align="center">0.02499</td>
<td align="center">0.095</td>
</tr>
<tr class="even">
<td align="left">Normal-CB</td>
<td align="center">0.3010</td>
<td align="center">0.02460</td>
<td align="center">0.090</td>
</tr>
<tr class="odd">
<td align="left">Normal-GR</td>
<td align="center">0.3057</td>
<td align="center">0.02439</td>
<td align="center">0.060</td>
</tr>
<tr class="even">
<td align="left">Normal-PM</td>
<td align="center">0.2544</td>
<td align="center">0.02460</td>
<td align="center">0.095</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="interpreting-the-loss-table">Interpreting the Loss Table<a class="anchor" aria-label="anchor" href="#interpreting-the-loss-table"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Identify best method for each loss</span></span>
<span><span class="va">best_msel</span>  <span class="op">&lt;-</span> <span class="va">loss_display</span><span class="op">$</span><span class="va">Method</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">loss_display</span><span class="op">$</span><span class="va">MSEL</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">best_mselr</span> <span class="op">&lt;-</span> <span class="va">loss_display</span><span class="op">$</span><span class="va">Method</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">loss_display</span><span class="op">$</span><span class="va">MSELR</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">best_ks</span>    <span class="op">&lt;-</span> <span class="va">loss_display</span><span class="op">$</span><span class="va">Method</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">loss_display</span><span class="op">$</span><span class="va">KS</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Best for MSEL  (individual accuracy):"</span>, <span class="va">best_msel</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Best for MSEL  (individual accuracy): DPM-PM</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Best for MSELR (ranking accuracy):   "</span>, <span class="va">best_mselr</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Best for MSELR (ranking accuracy):    Normal-GR</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Best for KS    (distributional):     "</span>, <span class="va">best_ks</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Best for KS    (distributional):      DPM-GR</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visual-loss-comparison">Visual Loss Comparison<a class="anchor" aria-label="anchor" href="#visual-loss-comparison"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">method_colors_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Normal-CB"</span> <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">normal_cb</span>, <span class="st">"Normal-GR"</span> <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">normal_gr</span>,</span>
<span>  <span class="st">"Normal-PM"</span> <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">normal_pm</span>,</span>
<span>  <span class="st">"DPM-CB"</span>    <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">dpm_cb</span>, <span class="st">"DPM-GR"</span> <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">dpm_gr</span>,</span>
<span>  <span class="st">"DPM-PM"</span>    <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">dpm_pm</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">loss_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">loss_display</span><span class="op">$</span><span class="va">Method</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  Metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MSEL"</span>, <span class="st">"MSELR"</span>, <span class="st">"KS"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">loss_display</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Loss   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">loss_display</span><span class="op">$</span><span class="va">MSEL</span>, <span class="va">loss_display</span><span class="op">$</span><span class="va">MSELR</span>, <span class="va">loss_display</span><span class="op">$</span><span class="va">KS</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">loss_long</span><span class="op">$</span><span class="va">Method</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">loss_long</span><span class="op">$</span><span class="va">Method</span>, levels <span class="op">=</span> <span class="va">loss_display</span><span class="op">$</span><span class="va">Method</span><span class="op">)</span></span>
<span><span class="va">loss_long</span><span class="op">$</span><span class="va">Metric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">loss_long</span><span class="op">$</span><span class="va">Metric</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MSEL"</span>, <span class="st">"MSELR"</span>, <span class="st">"KS"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">loss_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Method</span>, y <span class="op">=</span> <span class="va">Loss</span>, fill <span class="op">=</span> <span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Metric</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">method_colors_vec</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Loss comparison: 6 method-prior combinations"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Loss (lower is better)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="simulation-study_files/figure-html/loss-barplot-1.png" class="r-plt" alt="Bar chart of loss values across six methods.  Lower is better for all three metrics.  PM wins on MSEL (individual accuracy); GR wins on MSELR (ranking) and KS (distributional fidelity)." width="85%"><p class="caption">
Bar chart of loss values across six methods. Lower is better for all
three metrics. PM wins on MSEL (individual accuracy); GR wins on MSELR
(ranking) and KS (distributional fidelity).
</p>
</div>
</div>
<div class="section level3">
<h3 id="low-reliability-contrast">Low-Reliability Contrast<a class="anchor" aria-label="anchor" href="#low-reliability-contrast"></a>
</h3>
<p>The deep dive above used a 25-item test
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>≈</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\bar{w} \approx 0.8</annotation></semantics></math>)
where the data are informative enough for the DPM prior to shine. How do
the patterns change when reliability is much lower?</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comp_hi</span> <span class="op">&lt;-</span> <span class="va">est_comparison</span></span>
<span><span class="va">comp_lo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">find_extdata</span><span class="op">(</span><span class="st">"vignette_estimates_comparison_lowrel.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">build_panel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">comp_obj</span>, <span class="va">label</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">comp_obj</span><span class="op">$</span><span class="va">true_theta</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">comp_obj</span><span class="op">$</span><span class="va">true_theta</span>,</span>
<span>              <span class="va">comp_obj</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_pm</span>,</span>
<span>              <span class="va">comp_obj</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_cb</span>,</span>
<span>              <span class="va">comp_obj</span><span class="op">$</span><span class="va">dpm</span><span class="op">$</span><span class="va">theta</span><span class="op">$</span><span class="va">theta_gr</span><span class="op">)</span>,</span>
<span>    Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True"</span>, <span class="st">"DPM-PM"</span>, <span class="st">"DPM-CB"</span>, <span class="st">"DPM-GR"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">N</span><span class="op">)</span>,</span>
<span>                    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True"</span>, <span class="st">"DPM-PM"</span>, <span class="st">"DPM-CB"</span>, <span class="st">"DPM-GR"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    Reliability <span class="op">=</span> <span class="va">label</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">df_rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">build_panel</span><span class="op">(</span><span class="va">comp_lo</span>, <span class="st">"\u03C1 \u2248 0.5  (10 items)"</span><span class="op">)</span>,</span>
<span>  <span class="fu">build_panel</span><span class="op">(</span><span class="va">comp_hi</span>, <span class="st">"\u03C1 \u2248 0.8  (25 items)"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df_rel</span><span class="op">$</span><span class="va">Reliability</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">df_rel</span><span class="op">$</span><span class="va">Reliability</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"\u03C1 \u2248 0.5  (10 items)"</span>,</span>
<span>             <span class="st">"\u03C1 \u2248 0.8  (25 items)"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rel_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True"</span> <span class="op">=</span> <span class="st">"gray40"</span>, <span class="st">"DPM-PM"</span> <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">dpm_pm</span>,</span>
<span>                <span class="st">"DPM-CB"</span> <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">dpm_cb</span>, <span class="st">"DPM-GR"</span> <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">dpm_gr</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_rel</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, colour <span class="op">=</span> <span class="va">Method</span>, fill <span class="op">=</span> <span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.12</span>, linewidth <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Reliability</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">rel_colors</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">rel_colors</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Reliability determines when estimator choice matters"</span>,</span>
<span>       x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="simulation-study_files/figure-html/lowrel-comparison-1.png" class="r-plt" alt="Posterior density comparison at two reliability levels (DPM prior only). Left ($\rho \approx 0.5$, 10 items): severe shrinkage causes PM to collapse the bimodal distribution into a single narrow peak.  CB and GR resist compression, preserving the two-group structure. Right ($\rho \approx 0.8$, 25 items): shrinkage is mild; all three estimators recover the bimodal shape, with GR tracking the truth most closely." width="85%"><p class="caption">
Posterior density comparison at two reliability levels (DPM prior only).
Left
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>≈</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\rho \approx 0.5</annotation></semantics></math>,
10 items): severe shrinkage causes PM to collapse the bimodal
distribution into a single narrow peak. CB and GR resist compression,
preserving the two-group structure. Right
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>≈</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\rho \approx 0.8</annotation></semantics></math>,
25 items): shrinkage is mild; all three estimators recover the bimodal
shape, with GR tracking the truth most closely.
</p>
</div>
<table class="table">
<caption>Loss values at two reliability levels. At low reliability the
gap between PM and GR on KS widens substantially.</caption>
<thead><tr class="header">
<th align="left">Reliability</th>
<th align="left">Method</th>
<th align="right">MSEL</th>
<th align="right">MSELR</th>
<th align="right">KS</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ρ ≈ 0.5</td>
<td align="left">PM</td>
<td align="right">0.5561</td>
<td align="right">0.054310</td>
<td align="right">0.285</td>
</tr>
<tr class="even">
<td align="left">ρ ≈ 0.5</td>
<td align="left">CB</td>
<td align="right">0.5234</td>
<td align="right">0.054310</td>
<td align="right">0.220</td>
</tr>
<tr class="odd">
<td align="left">ρ ≈ 0.5</td>
<td align="left">GR</td>
<td align="right">0.5338</td>
<td align="right">0.054209</td>
<td align="right">0.165</td>
</tr>
<tr class="even">
<td align="left">ρ ≈ 0.8</td>
<td align="left">PM</td>
<td align="right">0.2544</td>
<td align="right">0.024992</td>
<td align="right">0.095</td>
</tr>
<tr class="odd">
<td align="left">ρ ≈ 0.8</td>
<td align="left">CB</td>
<td align="right">0.3029</td>
<td align="right">0.024992</td>
<td align="right">0.080</td>
</tr>
<tr class="even">
<td align="left">ρ ≈ 0.8</td>
<td align="left">GR</td>
<td align="right">0.3136</td>
<td align="right">0.024868</td>
<td align="right">0.055</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Key observation.</strong> At
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>≈</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\bar{w} \approx 0.5</annotation></semantics></math>,
the choice of estimator (PM vs. CB vs. GR) matters more than the choice
of prior, because every person’s posterior is heavily shrunk toward the
prior center. CB and GR resist this compression, producing estimates
whose distribution more closely tracks the truth — even though their
individual-level MSE (MSEL) is slightly higher than PM’s.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="dispersion-recovery-at-two-reliability-levels">Dispersion Recovery at Two Reliability Levels<a class="anchor" aria-label="anchor" href="#dispersion-recovery-at-two-reliability-levels"></a>
</h3>
<table class="table">
<caption>Standard deviation of estimates vs. truth. The PM/True ratio
quantifies shrinkage severity; GR/True shows how well the triple-goal
estimator recovers the true dispersion.</caption>
<thead><tr class="header">
<th align="left">Reliability</th>
<th align="right">SD(True)</th>
<th align="right">SD(PM)</th>
<th align="right">SD(CB)</th>
<th align="right">SD(GR)</th>
<th align="right">PM/True</th>
<th align="right">GR/True</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ρ ≈ 0.5</td>
<td align="right">0.991</td>
<td align="right">0.493</td>
<td align="right">0.700</td>
<td align="right">0.696</td>
<td align="right">0.50</td>
<td align="right">0.70</td>
</tr>
<tr class="even">
<td align="left">ρ ≈ 0.8</td>
<td align="right">0.955</td>
<td align="right">0.948</td>
<td align="right">1.075</td>
<td align="right">1.073</td>
<td align="right">0.99</td>
<td align="right">1.12</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Pattern.</strong> At low reliability, PM compresses the
ability distribution to roughly half its true spread (PM/True
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≈</mo><mn>0.50</mn></mrow><annotation encoding="application/x-tex">\approx 0.50</annotation></semantics></math>),
effectively destroying the bimodal structure. The GR estimator retains
about 70% of the true dispersion (GR/True
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≈</mo><mn>0.70</mn></mrow><annotation encoding="application/x-tex">\approx 0.70</annotation></semantics></math>),
substantially reducing the information loss. At high reliability, all
estimators converge toward the true spread — the shrinkage effect
becomes negligible.</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="key-patterns">Key Patterns<a class="anchor" aria-label="anchor" href="#key-patterns"></a>
</h2>
<p>The simulation study from Lee &amp; Wind reveals four main
findings:</p>
<div class="section level3">
<h3 id="finding-1-reliability-dominates-over-sample-size">Finding 1: Reliability Dominates Over Sample Size<a class="anchor" aria-label="anchor" href="#finding-1-reliability-dominates-over-sample-size"></a>
</h3>
<p>Across all conditions, the marginal reliability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>w</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{w}</annotation></semantics></math>
is a stronger predictor of estimator performance than sample size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>.
At
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>=</mo><mn>0.50</mn></mrow><annotation encoding="application/x-tex">\bar{w} = 0.50</annotation></semantics></math>,
all six methods produce similar results because the data are too weak to
distinguish methods. At
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>=</mo><mn>0.90</mn></mrow><annotation encoding="application/x-tex">\bar{w} = 0.90</annotation></semantics></math>,
method differences are amplified.</p>
<blockquote>
<p><strong>Implication:</strong> Invest in longer tests (more items)
rather than larger samples if your goal is to discriminate between
Normal and DPM priors.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="finding-2-dpm-advantage-under-non-normality-high-reliability">Finding 2: DPM Advantage Under Non-Normality + High Reliability<a class="anchor" aria-label="anchor" href="#finding-2-dpm-advantage-under-non-normality-high-reliability"></a>
</h3>
<p>The DPM prior shows its largest advantage when:</p>
<ul>
<li>The true latent distribution is non-normal (bimodal or skewed),
<strong>and</strong>
</li>
<li>Reliability is at least moderate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>≥</mo><mn>0.70</mn></mrow><annotation encoding="application/x-tex">\bar{w} \ge 0.70</annotation></semantics></math>).</li>
</ul>
<p>Under normality, the DPM prior performs comparably to the Normal
prior — the DP adapts to the true distribution and does not distort
it.</p>
</div>
<div class="section level3">
<h3 id="finding-3-pm-best-for-individual-mse-gr-best-for-ks">Finding 3: PM Best for Individual MSE; GR Best for KS<a class="anchor" aria-label="anchor" href="#finding-3-pm-best-for-individual-mse-gr-best-for-ks"></a>
</h3>
<p>The three posterior summary methods optimize different goals:</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="32%">
<col width="41%">
</colgroup>
<thead><tr class="header">
<th align="left">Method</th>
<th align="left">Strength</th>
<th align="left">When to use</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><strong>PM</strong></td>
<td align="left">Lowest individual MSE (MSEL)</td>
<td align="left">Point predictions for each person</td>
</tr>
<tr class="even">
<td align="left"><strong>CB</strong></td>
<td align="left">Better distributional match than PM</td>
<td align="left">Group-level summary statistics</td>
</tr>
<tr class="odd">
<td align="left"><strong>GR</strong></td>
<td align="left">Lowest KS distance</td>
<td align="left">Percentile reports, distributional inference</td>
</tr>
</tbody>
</table>
<p>PM is the traditional choice and remains best for Goal 1 (minimizing
per-person squared error). However, PM always over-shrinks toward the
prior center, producing estimates whose empirical distribution is too
narrow.</p>
<p>CB and GR “de-shrink” the estimates to better match the true
distribution, at a small cost to individual MSE.</p>
</div>
<div class="section level3">
<h3 id="finding-4-no-one-size-fits-all">Finding 4: No One-Size-Fits-All<a class="anchor" aria-label="anchor" href="#finding-4-no-one-size-fits-all"></a>
</h3>
<p>No single method–prior combination dominates across all conditions
and loss functions simultaneously. The optimal choice depends on:</p>
<ul>
<li>The shape of the true latent distribution (or your best guess).</li>
<li>The reliability of the instrument.</li>
<li>The inferential goal (individual prediction vs. distributional
reporting).</li>
</ul>
<blockquote>
<p><strong>Recommendation:</strong> For routine use, fit both Normal and
DPM models, compare via WAIC, and select the estimator (PM, CB, or GR)
that matches your reporting goals.</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="scaling-to-a-full-study">Scaling to a Full Study<a class="anchor" aria-label="anchor" href="#scaling-to-a-full-study"></a>
</h2>
<p>The single-condition pipeline above can be wrapped in a loop for a
full Monte Carlo study. Below is a template that you would run in a
non-interactive session (e.g., on a computing cluster). This code is
shown but <strong>not executed</strong> in the vignette:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ============================================================</span></span>
<span><span class="co"># Full simulation study template</span></span>
<span><span class="co"># ============================================================</span></span>
<span><span class="co"># WARNING: This runs 18 conditions x 100 replications x 2 models</span></span>
<span><span class="co"># Estimated time: ~72 hours on a single core</span></span>
<span><span class="co"># ============================================================</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://joonho112.github.io/DPMirt/">DPMirt</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># --- Design ---</span></span>
<span><span class="va">conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  latent_shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"bimodal"</span>, <span class="st">"skew_pos"</span><span class="op">)</span>,</span>
<span>  n_persons    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">200</span><span class="op">)</span>,</span>
<span>  target_rho   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">n_reps</span>  <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">n_items</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span></span>
<span><span class="co"># --- Storage ---</span></span>
<span><span class="va">all_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">conditions</span><span class="op">)</span> <span class="op">*</span> <span class="va">n_reps</span><span class="op">)</span></span>
<span><span class="va">result_idx</span>  <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">cond</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">conditions</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cfg</span> <span class="op">&lt;-</span> <span class="va">conditions</span><span class="op">[</span><span class="va">cond</span>, <span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Condition"</span>, <span class="va">cond</span>, <span class="st">"/"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">conditions</span><span class="op">)</span>, <span class="st">":"</span>,</span>
<span>      <span class="va">cfg</span><span class="op">$</span><span class="va">latent_shape</span>, <span class="st">"N ="</span>, <span class="va">cfg</span><span class="op">$</span><span class="va">n_persons</span>,</span>
<span>      <span class="st">"rho ="</span>, <span class="va">cfg</span><span class="op">$</span><span class="va">target_rho</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">rep</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_reps</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">result_idx</span> <span class="op">&lt;-</span> <span class="va">result_idx</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="va">rep_seed</span>   <span class="op">&lt;-</span> <span class="va">cond</span> <span class="op">*</span> <span class="fl">1000</span> <span class="op">+</span> <span class="va">rep</span></span>
<span></span>
<span>    <span class="co"># --- Step 1: Simulate ---</span></span>
<span>    <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_simulate.html">dpmirt_simulate</a></span><span class="op">(</span></span>
<span>      n_persons    <span class="op">=</span> <span class="va">cfg</span><span class="op">$</span><span class="va">n_persons</span>,</span>
<span>      n_items      <span class="op">=</span> <span class="va">n_items</span>,</span>
<span>      model        <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>      target_rho   <span class="op">=</span> <span class="va">cfg</span><span class="op">$</span><span class="va">target_rho</span>,</span>
<span>      latent_shape <span class="op">=</span> <span class="va">cfg</span><span class="op">$</span><span class="va">latent_shape</span>,</span>
<span>      seed         <span class="op">=</span> <span class="va">rep_seed</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="co"># --- Step 2: Fit Normal ---</span></span>
<span>    <span class="va">fit_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span></span>
<span>      <span class="va">sim</span><span class="op">$</span><span class="va">response</span>,</span>
<span>      model   <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>      prior   <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>      niter   <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>      nburnin <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>      seed    <span class="op">=</span> <span class="va">rep_seed</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>      verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="co"># --- Step 3: Fit DPM ---</span></span>
<span>    <span class="va">fit_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span></span>
<span>      <span class="va">sim</span><span class="op">$</span><span class="va">response</span>,</span>
<span>      model      <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>      prior      <span class="op">=</span> <span class="st">"dpm"</span>,</span>
<span>      mu_K       <span class="op">=</span> <span class="fl">5</span>,</span>
<span>      confidence <span class="op">=</span> <span class="st">"medium"</span>,</span>
<span>      niter      <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>      nburnin    <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>      seed       <span class="op">=</span> <span class="va">rep_seed</span> <span class="op">+</span> <span class="fl">2</span>,</span>
<span>      verbose    <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="co"># --- Step 4: Estimate ---</span></span>
<span>    <span class="va">est_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_estimates.html">dpmirt_estimates</a></span><span class="op">(</span><span class="va">fit_n</span>, methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pm"</span>, <span class="st">"cb"</span>, <span class="st">"gr"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">est_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_estimates.html">dpmirt_estimates</a></span><span class="op">(</span><span class="va">fit_d</span>, methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pm"</span>, <span class="st">"cb"</span>, <span class="st">"gr"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># --- Step 5: Evaluate ---</span></span>
<span>    <span class="va">loss_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_loss.html">dpmirt_loss</a></span><span class="op">(</span><span class="va">est_n</span>, true_theta <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">theta</span>,</span>
<span>                           true_beta <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span></span>
<span>    <span class="va">loss_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_loss.html">dpmirt_loss</a></span><span class="op">(</span><span class="va">est_d</span>, true_theta <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">theta</span>,</span>
<span>                           true_beta <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">loss_n</span><span class="op">$</span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="st">"Normal"</span></span>
<span>    <span class="va">loss_d</span><span class="op">$</span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="st">"DPM"</span></span>
<span></span>
<span>    <span class="co"># --- Step 6: Store ---</span></span>
<span>    <span class="va">all_results</span><span class="op">[[</span><span class="va">result_idx</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">loss_n</span>, <span class="va">loss_d</span><span class="op">)</span>,</span>
<span>      condition    <span class="op">=</span> <span class="va">cond</span>,</span>
<span>      replication  <span class="op">=</span> <span class="va">rep</span>,</span>
<span>      latent_shape <span class="op">=</span> <span class="va">cfg</span><span class="op">$</span><span class="va">latent_shape</span>,</span>
<span>      n_persons    <span class="op">=</span> <span class="va">cfg</span><span class="op">$</span><span class="va">n_persons</span>,</span>
<span>      target_rho   <span class="op">=</span> <span class="va">cfg</span><span class="op">$</span><span class="va">target_rho</span>,</span>
<span>      waic_normal  <span class="op">=</span> <span class="va">fit_n</span><span class="op">$</span><span class="va">waic</span>,</span>
<span>      waic_dpm     <span class="op">=</span> <span class="va">fit_d</span><span class="op">$</span><span class="va">waic</span>,</span>
<span>      reliability  <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">reliability</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># --- Combine ---</span></span>
<span><span class="va">results_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">all_results</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># --- Save ---</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">results_df</span>, <span class="st">"simulation_results.rds"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="parallelization">Parallelization<a class="anchor" aria-label="anchor" href="#parallelization"></a>
</h3>
<p>For faster execution, parallelize across conditions using
<code><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">parallel::mclapply()</a></code> or a cluster scheduler:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span>
<span></span>
<span><span class="va">run_one_condition</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">cond</span>, <span class="va">n_reps</span> <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cfg</span> <span class="op">&lt;-</span> <span class="va">conditions</span><span class="op">[</span><span class="va">cond</span>, <span class="op">]</span></span>
<span>  <span class="co"># ... same inner loop as above ...</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Run on 4 cores (adjust to your machine)</span></span>
<span><span class="va">results_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">mclapply</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">conditions</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">run_one_condition</span>,</span>
<span>  mc.cores <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="aggregation-and-reporting">Aggregation and Reporting<a class="anchor" aria-label="anchor" href="#aggregation-and-reporting"></a>
</h3>
<p>Once all replications are complete, aggregate results by
condition:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">summary_table</span> <span class="op">&lt;-</span> <span class="va">results_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">parameter</span> <span class="op">==</span> <span class="st">"theta"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">latent_shape</span>, <span class="va">n_persons</span>, <span class="va">target_rho</span>, <span class="va">prior</span>, <span class="va">method</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean_msel  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">msel</span><span class="op">)</span>,</span>
<span>    se_msel    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">msel</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    mean_mselr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mselr</span><span class="op">)</span>,</span>
<span>    mean_ks    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ks</span><span class="op">)</span>,</span>
<span>    .groups    <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="extending-the-study">Extending the Study<a class="anchor" aria-label="anchor" href="#extending-the-study"></a>
</h2>
<p>The DPMirt simulation framework supports several extensions beyond
the basic Rasch study:</p>
<div class="section level3">
<h3 id="pl-models">2PL Models<a class="anchor" aria-label="anchor" href="#pl-models"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_2pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_simulate.html">dpmirt_simulate</a></span><span class="op">(</span></span>
<span>  n_persons    <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  n_items      <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  model        <span class="op">=</span> <span class="st">"2pl"</span>,</span>
<span>  target_rho   <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  latent_shape <span class="op">=</span> <span class="st">"bimodal"</span>,</span>
<span>  seed         <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_2pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span></span>
<span>  <span class="va">sim_2pl</span><span class="op">$</span><span class="va">response</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"2pl"</span>,</span>
<span>  prior <span class="op">=</span> <span class="st">"dpm"</span>,</span>
<span>  niter <span class="op">=</span> <span class="fl">15000</span>,</span>
<span>  nburnin <span class="op">=</span> <span class="fl">3000</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="custom-latent-distributions">Custom Latent Distributions<a class="anchor" aria-label="anchor" href="#custom-latent-distributions"></a>
</h3>
<p>With IRTsimrel installed, you have access to 12 distribution
shapes:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># All supported shapes (when IRTsimrel is available)</span></span>
<span><span class="va">shapes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"bimodal"</span>, <span class="st">"trimodal"</span>, <span class="st">"multimodal"</span>,</span>
<span>            <span class="st">"skew_pos"</span>, <span class="st">"skew_neg"</span>, <span class="st">"heavy_tail"</span>, <span class="st">"light_tail"</span>,</span>
<span>            <span class="st">"uniform"</span>, <span class="st">"floor"</span>, <span class="st">"ceiling"</span>, <span class="st">"custom"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">shape</span> <span class="kw">in</span> <span class="va">shapes</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_simulate.html">dpmirt_simulate</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">25</span>, latent_shape <span class="op">=</span> <span class="va">shape</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">shape</span>, <span class="st">": KR-20 ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">reliability</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="custom-loss-functions">Custom Loss Functions<a class="anchor" aria-label="anchor" href="#custom-loss-functions"></a>
</h3>
<p>Extend evaluation with your own loss function:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Bias (signed error)</span></span>
<span><span class="va">bias_loss</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">estimate</span>, <span class="va">true</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">estimate</span> <span class="op">-</span> <span class="va">true</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Coverage of 95% CI</span></span>
<span><span class="va">coverage_loss</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">estimate</span>, <span class="va">true</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Requires access to full posterior...</span></span>
<span>  <span class="co"># Use dpmirt_draws() for this</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">loss_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_loss.html">dpmirt_loss</a></span><span class="op">(</span></span>
<span>  <span class="va">est_dpm</span>,</span>
<span>  true_theta  <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">theta</span>,</span>
<span>  custom_loss <span class="op">=</span> <span class="va">bias_loss</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="diagnostic-checks-for-simulation-validity">Diagnostic Checks for Simulation Validity<a class="anchor" aria-label="anchor" href="#diagnostic-checks-for-simulation-validity"></a>
</h2>
<p>Before interpreting results, verify that the simulation and MCMC
converged properly.</p>
<div class="section level3">
<h3 id="check-1-achieved-reliability">Check 1: Achieved Reliability<a class="anchor" aria-label="anchor" href="#check-1-achieved-reliability"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Target reliability:"</span>, <span class="fl">0.8</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Target reliability: 0.8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Achieved KR-20:   "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">reliability</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Achieved KR-20:    0.8099</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Simulation method: "</span>, <span class="va">sim</span><span class="op">$</span><span class="va">method</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simulation method:  irtsimrel</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="check-2-mcmc-convergence">Check 2: MCMC Convergence<a class="anchor" aria-label="anchor" href="#check-2-mcmc-convergence"></a>
</h3>
<p>For pre-computed fits, you would check:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Minimum ESS across all parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">ess</span><span class="op">$</span><span class="va">items</span><span class="op">)</span>   <span class="co"># Should be &gt; 400 for 8000 post-burnin samples</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">ess</span><span class="op">$</span><span class="va">theta</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Trace plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"trace"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># WAIC comparison</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"WAIC Normal:"</span>, <span class="va">fit_normal</span><span class="op">$</span><span class="va">waic</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"WAIC DPM:   "</span>, <span class="va">fit_dpm</span><span class="op">$</span><span class="va">waic</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="check-3-posterior-predictive-check">Check 3: Posterior Predictive Check<a class="anchor" aria-label="anchor" href="#check-3-posterior-predictive-check"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare observed vs. predicted sum score distribution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"ppc"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="summary-table-of-functions">Summary Table of Functions<a class="anchor" aria-label="anchor" href="#summary-table-of-functions"></a>
</h2>
<table class="table">
<colgroup>
<col width="38%">
<col width="34%">
<col width="26%">
</colgroup>
<thead><tr class="header">
<th align="left">Function</th>
<th align="left">Purpose</th>
<th align="left">Phase</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code><a href="../reference/dpmirt_simulate.html">dpmirt_simulate()</a></code></td>
<td align="left">Generate IRT data with target reliability</td>
<td align="left">Simulation</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/dpmirt.html">dpmirt()</a></code></td>
<td align="left">Fit model (one-step)</td>
<td align="left">Fitting</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="../reference/dpmirt_estimates.html">dpmirt_estimates()</a></code></td>
<td align="left">Compute PM, CB, GR estimates</td>
<td align="left">Estimation</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/dpmirt_loss.html">dpmirt_loss()</a></code></td>
<td align="left">Evaluate MSEL, MSELR, KS</td>
<td align="left">Evaluation</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="../reference/dpmirt_draws.html">dpmirt_draws()</a></code></td>
<td align="left">Extract raw posterior samples</td>
<td align="left">Post-hoc analysis</td>
</tr>
<tr class="even">
<td align="left"><code><a href="../reference/dpmirt_dp_density.html">dpmirt_dp_density()</a></code></td>
<td align="left">Compute DP mixture density</td>
<td align="left">DPM diagnostics</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="whats-next">What’s Next?<a class="anchor" aria-label="anchor" href="#whats-next"></a>
</h2>
<table class="table">
<colgroup>
<col width="43%">
<col width="56%">
</colgroup>
<thead><tr class="header">
<th align="left">Vignette</th>
<th align="left">Why read it</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><em>Quick Start</em></td>
<td align="left">Simpler walkthrough of the basic pipeline</td>
</tr>
<tr class="even">
<td align="left"><em>Prior Elicitation</em></td>
<td align="left">Principled
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
choice via DPprior</td>
</tr>
<tr class="odd">
<td align="left"><em>Under the Hood</em></td>
<td align="left">NIMBLE internals, compile-once pattern, custom
samplers</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Lee, J. &amp; Wind, S. Targeting toward inferential goals in Bayesian
Rasch models for estimating person-specific latent traits. <em>OSF
Preprint</em>. <a href="https://doi.org/10.31219/osf.io/qrw4n" class="external-link uri">https://doi.org/10.31219/osf.io/qrw4n</a></p>
<p>Lee, J. (2025). Reliability-targeted simulation of item response
data: Solving the inverse design problem. arXiv preprint
arXiv:2512.16012. <a href="https://arxiv.org/abs/2512.16012" class="external-link uri">https://arxiv.org/abs/2512.16012</a></p>
<p>Paganin, S., Paciorek, C. J., Wehrhahn, C., Rodríguez, A.,
Rabe-Hesketh, S., &amp; de Valpine, P. (2023). Computational strategies
and estimation performance with Bayesian semiparametric item response
theory models. <em>Journal of Educational and Behavioral
Statistics</em>, 48(2), 147–188. <a href="https://doi.org/10.3102/10769986221136105" class="external-link uri">https://doi.org/10.3102/10769986221136105</a></p>
<p>Ghosh, M. (1992). Constrained Bayes estimation with applications.
<em>JASA</em>, 87(418), 533–540.</p>
<p>Shen, W., &amp; Louis, T. A. (1998). Triple-goal estimates in
two-stage hierarchical models. <em>JRSS-B</em>, 60(2), 455–471.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/joonho112" class="external-link">JoonHo Lee</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
