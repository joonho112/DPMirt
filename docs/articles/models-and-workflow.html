<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The Complete Guide to Models and Workflows • DPMirt</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The Complete Guide to Models and Workflows">
<meta name="description" content="A comprehensive guide to every model, prior, parameterization, and identification strategy available in DPMirt.  Covers both the one-step dpmirt() wrapper and the step-by-step pipeline, with practical advice on when to use each workflow.
">
<meta property="og:description" content="A comprehensive guide to every model, prior, parameterization, and identification strategy available in DPMirt.  Covers both the one-step dpmirt() wrapper and the step-by-step pipeline, with practical advice on when to use each workflow.
">
<meta property="og:image" content="https://joonho112.github.io/DPMirt/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DPMirt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><h6 class="dropdown-header" data-toc-skip>--- Getting Started ---</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/quick-start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/models-and-workflow.html">Models &amp; Workflow</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>--- Theory &amp; Methods ---</h6></li>
    <li><a class="dropdown-item" href="../articles/theory-irt-dpm.html">IRT &amp; DPM Theory</a></li>
    <li><a class="dropdown-item" href="../articles/posterior-summaries.html">Posterior Summaries</a></li>
    <li><a class="dropdown-item" href="../articles/prior-elicitation.html">Prior Elicitation</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>--- Advanced ---</h6></li>
    <li><a class="dropdown-item" href="../articles/nimble-internals.html">NIMBLE Internals</a></li>
    <li><a class="dropdown-item" href="../articles/simulation-study.html">Simulation Study</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joonho112/DPMirt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>The Complete Guide to Models and Workflows</h1>
                        <h4 data-toc-skip class="author">JoonHo Lee</h4>
            
            <h4 data-toc-skip class="date">2026-02-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/joonho112/DPMirt/blob/HEAD/vignettes/models-and-workflow.Rmd" class="external-link"><code>vignettes/models-and-workflow.Rmd</code></a></small>
      <div class="d-none name"><code>models-and-workflow.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">1. Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>DPMirt provides two ways to fit Bayesian IRT models.</p>
<p><strong>One-step workflow.</strong> Call <code><a href="../reference/dpmirt.html">dpmirt()</a></code> and
get a fully processed <code>dpmirt_fit</code> object in one function
call. Best for standard analyses where the defaults are appropriate.</p>
<p><strong>Step-by-step workflow.</strong> Walk through the pipeline
explicitly: <code><a href="../reference/dpmirt_spec.html">dpmirt_spec()</a></code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>→</mo><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math><code><a href="../reference/dpmirt_compile.html">dpmirt_compile()</a></code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>→</mo><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math><code><a href="../reference/dpmirt_sample.html">dpmirt_sample()</a></code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>→</mo><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math><code><a href="../reference/dpmirt_rescale.html">dpmirt_rescale()</a></code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>→</mo><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math><code><a href="../reference/dpmirt_estimates.html">dpmirt_estimates()</a></code>. Best when you need to inspect
intermediate objects, run multiple chains from a single compiled model
(compile-once, sample-many), or modify the MCMC configuration before
sampling.</p>
<p>Both workflows produce the same statistical results.</p>
</div>
<div class="section level2">
<h2 id="the-one-step-workflow">2. The One-Step Workflow<a class="anchor" aria-label="anchor" href="#the-one-step-workflow"></a>
</h2>
<div class="section level3">
<h3 id="key-arguments">2.1 Key Arguments<a class="anchor" aria-label="anchor" href="#key-arguments"></a>
</h3>
<table class="table">
<colgroup>
<col width="16%">
<col width="18%">
<col width="64%">
</colgroup>
<thead><tr class="header">
<th align="left">Argument</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">data</td>
<td align="left">—</td>
<td align="left">N x I binary response matrix (persons in rows, items in
columns)</td>
</tr>
<tr class="even">
<td align="left">model</td>
<td align="left">“rasch”</td>
<td align="left">IRT model: “rasch”, “2pl”, or “3pl”</td>
</tr>
<tr class="odd">
<td align="left">prior</td>
<td align="left">“normal”</td>
<td align="left">Latent trait prior: “normal” or “dpm”</td>
</tr>
<tr class="even">
<td align="left">parameterization</td>
<td align="left">“irt”</td>
<td align="left">“irt” or “si” (slope-intercept; 2PL/3PL only)</td>
</tr>
<tr class="odd">
<td align="left">identification</td>
<td align="left">NULL</td>
<td align="left">Identification strategy; NULL selects model
default</td>
</tr>
<tr class="even">
<td align="left">niter</td>
<td align="left">10000</td>
<td align="left">Total MCMC iterations</td>
</tr>
<tr class="odd">
<td align="left">nburnin</td>
<td align="left">2000</td>
<td align="left">Burn-in iterations to discard</td>
</tr>
<tr class="even">
<td align="left">thin</td>
<td align="left">1</td>
<td align="left">Thinning interval for item parameters</td>
</tr>
<tr class="odd">
<td align="left">thin2</td>
<td align="left">NULL</td>
<td align="left">Thinning for theta (NULL = same as thin)</td>
</tr>
<tr class="even">
<td align="left">nchains</td>
<td align="left">1</td>
<td align="left">Number of independent chains</td>
</tr>
<tr class="odd">
<td align="left">seed</td>
<td align="left">NULL</td>
<td align="left">Random seed for reproducibility</td>
</tr>
<tr class="even">
<td align="left">alpha_prior</td>
<td align="left">NULL</td>
<td align="left">DPM concentration hyperprior: NULL, c(a,b), or DPprior
object</td>
</tr>
<tr class="odd">
<td align="left">base_measure</td>
<td align="left">list(s2_mu=2, …)</td>
<td align="left">DPM base measure hyperparameters (Paganin
defaults)</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="left">50</td>
<td align="left">CRP truncation level (max clusters)</td>
</tr>
<tr class="odd">
<td align="left">rescale</td>
<td align="left">TRUE</td>
<td align="left">Apply post-hoc identification rescaling</td>
</tr>
<tr class="even">
<td align="left">compute_waic</td>
<td align="left">TRUE</td>
<td align="left">Compute WAIC for model comparison</td>
</tr>
<tr class="odd">
<td align="left">save_draws</td>
<td align="left">TRUE</td>
<td align="left">Store full theta posterior (needed for CB/GR
estimators)</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="examples">2.2 Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<p>Each call below takes roughly 1–3 minutes (dominated by NIMBLE
compilation on first use). We show the code and load pre-computed
results.</p>
<p><strong>Rasch – Normal prior</strong></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_rasch_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span></span>
<span>  <span class="va">sim</span><span class="op">$</span><span class="va">response</span>, model <span class="op">=</span> <span class="st">"rasch"</span>, prior <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  niter <span class="op">=</span> <span class="fl">10000</span>, nburnin <span class="op">=</span> <span class="fl">2000</span>, seed <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_rasch_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">find_extdata</span><span class="op">(</span><span class="st">"vignette_fit_rasch_normal.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Rasch – DPM prior</strong></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_rasch_dpm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span></span>
<span>  <span class="va">sim</span><span class="op">$</span><span class="va">response</span>, model <span class="op">=</span> <span class="st">"rasch"</span>, prior <span class="op">=</span> <span class="st">"dpm"</span>,</span>
<span>  niter <span class="op">=</span> <span class="fl">10000</span>, nburnin <span class="op">=</span> <span class="fl">2000</span>, seed <span class="op">=</span> <span class="fl">200</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_rasch_dpm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">find_extdata</span><span class="op">(</span><span class="st">"vignette_fit_rasch_dpm.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>2PL – DPM prior</strong></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_2pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span></span>
<span>  <span class="va">sim</span><span class="op">$</span><span class="va">response</span>, model <span class="op">=</span> <span class="st">"2pl"</span>, prior <span class="op">=</span> <span class="st">"dpm"</span>,</span>
<span>  niter <span class="op">=</span> <span class="fl">15000</span>, nburnin <span class="op">=</span> <span class="fl">5000</span>, seed <span class="op">=</span> <span class="fl">300</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_2pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">find_extdata</span><span class="op">(</span><span class="st">"vignette_fit_2pl_dpm.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The returned <code>dpmirt_fit</code> object gives a compact overview
when printed, and <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> adds item-level estimates and
DPM cluster diagnostics:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_rasch_n</span></span>
<span><span class="co">#&gt; DPMirt Model Fit</span></span>
<span><span class="co">#&gt; ================</span></span>
<span><span class="co">#&gt; Model:            RASCH </span></span>
<span><span class="co">#&gt; Prior:            normal </span></span>
<span><span class="co">#&gt; Identification:   constrained_item </span></span>
<span><span class="co">#&gt; Persons (N):      200 </span></span>
<span><span class="co">#&gt; Items (I):        25 </span></span>
<span><span class="co">#&gt; MCMC:            10000 iterations (2000 burnin, thin=1)</span></span>
<span><span class="co">#&gt; WAIC:             6079.03 </span></span>
<span><span class="co">#&gt; Total time:       55.4 sec </span></span>
<span><span class="co">#&gt; Min ESS (items):  1714 </span></span>
<span><span class="co">#&gt; Min ESS (theta):  1372</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_rasch_dpm</span><span class="op">)</span></span>
<span><span class="co">#&gt; DPMirt Model Summary</span></span>
<span><span class="co">#&gt; ====================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Configuration:</span></span>
<span><span class="co">#&gt;   Model:            RASCH </span></span>
<span><span class="co">#&gt;   Prior:            dpm </span></span>
<span><span class="co">#&gt;   Identification:   constrained_item </span></span>
<span><span class="co">#&gt;   Rescaled:         TRUE </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Data:</span></span>
<span><span class="co">#&gt;   Persons (N): 200 </span></span>
<span><span class="co">#&gt;   Items (I):   25 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MCMC Settings:</span></span>
<span><span class="co">#&gt;   Iterations:  10000 </span></span>
<span><span class="co">#&gt;   Burn-in:     2000 </span></span>
<span><span class="co">#&gt;   Thinning:    1 </span></span>
<span><span class="co">#&gt;   Chains:      1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Timing:</span></span>
<span><span class="co">#&gt;   Compilation:  21.3 sec </span></span>
<span><span class="co">#&gt;   Sampling:     37.0 sec </span></span>
<span><span class="co">#&gt;   Total:        1.5 min </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Item Difficulty (beta) Summary:</span></span>
<span><span class="co">#&gt;            Mean    SD</span></span>
<span><span class="co">#&gt; beta[1]   0.139 0.148</span></span>
<span><span class="co">#&gt; beta[2]  -1.028 0.159</span></span>
<span><span class="co">#&gt; beta[3]   0.527 0.156</span></span>
<span><span class="co">#&gt; beta[4]  -0.692 0.156</span></span>
<span><span class="co">#&gt; beta[5]   0.195 0.150</span></span>
<span><span class="co">#&gt; beta[6]   0.508 0.155</span></span>
<span><span class="co">#&gt; beta[7]  -0.350 0.151</span></span>
<span><span class="co">#&gt; beta[8]  -0.377 0.153</span></span>
<span><span class="co">#&gt; beta[9]   0.487 0.154</span></span>
<span><span class="co">#&gt; beta[10] -0.844 0.161</span></span>
<span><span class="co">#&gt; beta[11]  0.767 0.159</span></span>
<span><span class="co">#&gt; beta[12]  0.333 0.150</span></span>
<span><span class="co">#&gt; beta[13]  0.140 0.152</span></span>
<span><span class="co">#&gt; beta[14] -0.251 0.152</span></span>
<span><span class="co">#&gt; beta[15]  0.029 0.145</span></span>
<span><span class="co">#&gt; beta[16] -0.039 0.147</span></span>
<span><span class="co">#&gt; beta[17] -0.178 0.152</span></span>
<span><span class="co">#&gt; beta[18]  0.382 0.155</span></span>
<span><span class="co">#&gt; beta[19]  1.003 0.166</span></span>
<span><span class="co">#&gt; beta[20]  0.897 0.164</span></span>
<span><span class="co">#&gt; beta[21] -0.116 0.150</span></span>
<span><span class="co">#&gt; beta[22] -0.688 0.153</span></span>
<span><span class="co">#&gt; beta[23]  0.688 0.156</span></span>
<span><span class="co">#&gt; beta[24] -0.182 0.151</span></span>
<span><span class="co">#&gt; beta[25] -1.350 0.173</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Person Ability (theta) Summary:</span></span>
<span><span class="co">#&gt;   Range: [ -2.127 ,  1.72 ]</span></span>
<span><span class="co">#&gt;   Mean:   -0.075 </span></span>
<span><span class="co">#&gt;   SD:     0.814 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Comparison:</span></span>
<span><span class="co">#&gt;   WAIC:  6078.17 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; DPM Diagnostics:</span></span>
<span><span class="co">#&gt;   Alpha (concentration):</span></span>
<span><span class="co">#&gt;     Posterior mean:  0.271 </span></span>
<span><span class="co">#&gt;     95% CI: [ 0.007 ,  0.982 ]</span></span>
<span><span class="co">#&gt;   Number of clusters:</span></span>
<span><span class="co">#&gt;     Posterior mean:  2.3 </span></span>
<span><span class="co">#&gt;     Mode:           1 </span></span>
<span><span class="co">#&gt;     Range: [ 1 ,  13 ]</span></span>
<span><span class="co">#&gt;   DP density:    computed (500 grid points)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="the-step-by-step-workflow">3. The Step-by-Step Workflow<a class="anchor" aria-label="anchor" href="#the-step-by-step-workflow"></a>
</h2>
<div class="section level3">
<h3 id="specification">3.1 Specification<a class="anchor" aria-label="anchor" href="#specification"></a>
</h3>
<p><code><a href="../reference/dpmirt_spec.html">dpmirt_spec()</a></code> translates your model request into a
complete NIMBLE specification: programmatically generated model code,
constants, data, initial values, and monitor lists.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_spec.html">dpmirt_spec</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">response</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  prior <span class="op">=</span> <span class="st">"dpm"</span>, identification <span class="op">=</span> <span class="st">"constrained_item"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Inspect the returned <code>dpmirt_spec</code> object:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span><span class="op">$</span><span class="va">code</span>       <span class="co"># nimbleCode object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">spec</span><span class="op">$</span><span class="va">constants</span><span class="op">)</span></span>
<span><span class="va">spec</span><span class="op">$</span><span class="va">monitors</span>   <span class="co"># beta, alpha, zi, muTilde, s2Tilde, logprob nodes</span></span>
<span><span class="va">spec</span><span class="op">$</span><span class="va">monitors2</span>  <span class="co"># eta (thinned separately via thin2)</span></span></code></pre></div>
<p>Because the spec is pure R data (no C++ pointers), it can be safely
saved to disk with <code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS()</a></code> and loaded in a new
session.</p>
</div>
<div class="section level3">
<h3 id="compilation">3.2 Compilation<a class="anchor" aria-label="anchor" href="#compilation"></a>
</h3>
<p><code><a href="../reference/dpmirt_compile.html">dpmirt_compile()</a></code> feeds the spec into NIMBLE’s compiler,
producing C++ objects that run the sampler at native speed.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compiled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_compile.html">dpmirt_compile</a></span><span class="op">(</span><span class="va">spec</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p><strong>Timing warning.</strong> Compilation typically takes 30–120
seconds. It only needs to be done <strong>once</strong> per model
specification.</p>
</blockquote>
<blockquote>
<p><strong>Session-bound caveat.</strong> The compiled object contains
external C++ pointers and <strong>cannot</strong> be serialized with
<code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS()</a></code>. If you restart R, re-run
<code><a href="../reference/dpmirt_compile.html">dpmirt_compile()</a></code> on the saved spec.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="sampling">3.3 Sampling<a class="anchor" aria-label="anchor" href="#sampling"></a>
</h3>
<p><code><a href="../reference/dpmirt_sample.html">dpmirt_sample()</a></code> runs MCMC on the compiled model. Because
compilation is already done, this step is fast and repeatable.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_sample.html">dpmirt_sample</a></span><span class="op">(</span></span>
<span>  <span class="va">compiled</span>, niter <span class="op">=</span> <span class="fl">10000</span>, nburnin <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span>, thin2 <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Compile-once, sample-many.</strong> Draw multiple independent
chains from the same compiled model without paying the compilation cost
each time:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chains</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/dpmirt_sample.html">dpmirt_sample</a></span><span class="op">(</span><span class="va">compiled</span>, niter <span class="op">=</span> <span class="fl">10000</span>, nburnin <span class="op">=</span> <span class="fl">2000</span>, seed <span class="op">=</span> <span class="va">i</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>For convenience, <code><a href="../reference/dpmirt.html">dpmirt()</a></code> also supports multi-chain runs
directly via the <code>nchains</code> argument.</p>
</div>
<div class="section level3">
<h3 id="rescaling">3.4 Rescaling<a class="anchor" aria-label="anchor" href="#rescaling"></a>
</h3>
<p><code><a href="../reference/dpmirt_rescale.html">dpmirt_rescale()</a></code> applies post-hoc identification
rescaling to the raw posterior samples and returns a
<code>dpmirt_fit</code> object that can be passed directly to
<code><a href="../reference/dpmirt_estimates.html">dpmirt_estimates()</a></code>, <code><a href="../reference/dpmirt_resume.html">dpmirt_resume()</a></code>, and other
downstream functions.</p>
<table class="table">
<colgroup>
<col width="14%">
<col width="18%">
<col width="67%">
</colgroup>
<thead><tr class="header">
<th align="left">Model</th>
<th align="left">Indeterminacy</th>
<th align="left">Rescaling</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Rasch</td>
<td align="left">Location only</td>
<td align="left">Center beta at 0; shift theta accordingly</td>
</tr>
<tr class="even">
<td align="left">2PL/3PL (IRT)</td>
<td align="left">Location + scale</td>
<td align="left">Center beta, normalize lambda to geom-mean 1, rescale
theta</td>
</tr>
<tr class="odd">
<td align="left">2PL/3PL (SI)</td>
<td align="left">Location + scale</td>
<td align="left">Center gamma via weighted sum, normalize lambda,
rescale theta</td>
</tr>
</tbody>
</table>
<p>For the Rasch model:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>β</mi><mi>i</mi><mo>*</mo></msubsup><mo>=</mo><msub><mi>β</mi><mi>i</mi></msub><mo>−</mo><mover><mi>β</mi><mo accent="true">‾</mo></mover><mo>,</mo><mspace width="2.0em"></mspace><msubsup><mi>θ</mi><mi>j</mi><mo>*</mo></msubsup><mo>=</mo><msub><mi>θ</mi><mi>j</mi></msub><mo>−</mo><mover><mi>β</mi><mo accent="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">
\beta_i^* = \beta_i - \bar{\beta}, \qquad
\theta_j^* = \theta_j - \bar{\beta}
</annotation></semantics></math></p>
<p>For 2PL/3PL (IRT parameterization):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>I</mi></munderover><msub><mi>λ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>−</mi><mn>1</mn><mi>/</mi><mi>I</mi></mrow></msup><mo>,</mo><mspace width="1.0em"></mspace><msubsup><mi>β</mi><mi>i</mi><mo>*</mo></msubsup><mo>=</mo><mfrac><mrow><msub><mi>β</mi><mi>i</mi></msub><mo>−</mo><mover><mi>β</mi><mo accent="true">‾</mo></mover></mrow><mi>s</mi></mfrac><mo>,</mo><mspace width="1.0em"></mspace><msubsup><mi>λ</mi><mi>i</mi><mo>*</mo></msubsup><mo>=</mo><msub><mi>λ</mi><mi>i</mi></msub><mo>⋅</mo><mi>s</mi><mo>,</mo><mspace width="1.0em"></mspace><msubsup><mi>θ</mi><mi>j</mi><mo>*</mo></msubsup><mo>=</mo><mfrac><mrow><msub><mi>θ</mi><mi>j</mi></msub><mo>−</mo><mover><mi>β</mi><mo accent="true">‾</mo></mover></mrow><mi>s</mi></mfrac></mrow><annotation encoding="application/x-tex">
s = \left(\prod_{i=1}^{I} \lambda_i\right)^{-1/I}, \quad
\beta_i^* = \frac{\beta_i - \bar{\beta}}{s}, \quad
\lambda_i^* = \lambda_i \cdot s, \quad
\theta_j^* = \frac{\theta_j - \bar{\beta}}{s}
</annotation></semantics></math></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_rescale.html">dpmirt_rescale</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit is a dpmirt_fit: pass directly to estimates or resume</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_estimates.html">dpmirt_estimates</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>If the model uses <code>"constrained_item"</code> or
<code>"constrained_ability"</code> identification, rescaling is a no-op
— parameters are already identified through in-model constraints.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="estimates">3.5 Estimates<a class="anchor" aria-label="anchor" href="#estimates"></a>
</h3>
<p><code><a href="../reference/dpmirt_estimates.html">dpmirt_estimates()</a></code> computes person and item point
estimates using three posterior summary methods.</p>
<table class="table">
<thead><tr class="header">
<th align="left">Method</th>
<th align="left">Name</th>
<th align="left">Optimizes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">PM</td>
<td align="left">Posterior Mean</td>
<td align="left">Individual MSE (Goal 1)</td>
</tr>
<tr class="even">
<td align="left">CB</td>
<td align="left">Constrained Bayes (Ghosh, 1992)</td>
<td align="left">EDF estimation (Goal 3)</td>
</tr>
<tr class="odd">
<td align="left">GR</td>
<td align="left">Triple-Goal (Shen &amp; Louis, 1998)</td>
<td align="left">Ranking + EDF (Goals 2 &amp; 3)</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_estimates.html">dpmirt_estimates</a></span><span class="op">(</span><span class="va">fit_rasch_dpm</span>, methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pm"</span>, <span class="st">"cb"</span>, <span class="st">"gr"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">est</span><span class="op">$</span><span class="va">theta</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt;           theta_pm theta_psd    theta_cb     theta_gr      rbar rhat</span></span>
<span><span class="co">#&gt; eta[1] -1.64208358 0.4850620 -1.82658631 -1.898414370  14.10438    6</span></span>
<span><span class="co">#&gt; eta[2]  0.08246350 0.3785971  0.10105187  0.130777459 110.04200  114</span></span>
<span><span class="co">#&gt; eta[3]  0.05810186 0.3859230  0.07382128  0.001450727 108.21700  103</span></span>
<span><span class="co">#&gt; eta[4]  1.15463248 0.4241983  1.29948472  1.393735077 179.26688  192</span></span>
<span><span class="co">#&gt; eta[5] -0.68190514 0.3877922 -0.75333256 -0.665180404  53.89862   52</span></span>
<span><span class="co">#&gt; eta[6]  0.81760681 0.3950633  0.92276925  0.811079297 162.99625  167</span></span>
<span><span class="co">#&gt; eta[7]  1.72015915 0.4758415  1.93161057  2.206872410 194.11588  200</span></span>
<span><span class="co">#&gt; eta[8] -0.06517854 0.3837235 -0.06397722 -0.057278283  98.39575   98</span></span>
<span><span class="co">#&gt;        theta_lower theta_upper</span></span>
<span><span class="co">#&gt; eta[1] -2.71809760 -0.76137677</span></span>
<span><span class="co">#&gt; eta[2] -0.63931121  0.81955388</span></span>
<span><span class="co">#&gt; eta[3] -0.68900612  0.82161938</span></span>
<span><span class="co">#&gt; eta[4]  0.34563696  2.00481098</span></span>
<span><span class="co">#&gt; eta[5] -1.44006283  0.07806641</span></span>
<span><span class="co">#&gt; eta[6]  0.05942028  1.60027832</span></span>
<span><span class="co">#&gt; eta[7]  0.84623291  2.75717002</span></span>
<span><span class="co">#&gt; eta[8] -0.84149547  0.68498198</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">est</span><span class="op">$</span><span class="va">beta</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt;            beta_pm  beta_psd    beta_cb     beta_gr     rbar rhat beta_lower</span></span>
<span><span class="co">#&gt; beta[1]  0.1393281 0.1481244  0.1437448  0.09951606 14.54713   14 -0.1448619</span></span>
<span><span class="co">#&gt; beta[2] -1.0281008 0.1593125 -1.0606917 -1.05388296  2.26200    2 -1.3531175</span></span>
<span><span class="co">#&gt; beta[3]  0.5266330 0.1558563  0.5433273  0.59943417 19.94138   21  0.2277232</span></span>
<span><span class="co">#&gt; beta[4] -0.6922001 0.1558382 -0.7141429 -0.73611032  4.36675    4 -0.9959212</span></span>
<span><span class="co">#&gt; beta[5]  0.1946660 0.1501926  0.2008369  0.23378009 15.36788   16 -0.1017568</span></span>
<span><span class="co">#&gt; beta[6]  0.5082932 0.1550549  0.5244062  0.52121043 19.70375   20  0.2010165</span></span>
<span><span class="co">#&gt; beta[7] -0.3503717 0.1511989 -0.3614786 -0.36061570  7.43475    7 -0.6562346</span></span>
<span><span class="co">#&gt; beta[8] -0.3770295 0.1534740 -0.3889813 -0.46590990  7.14050    6 -0.6858021</span></span>
<span><span class="co">#&gt;          beta_upper</span></span>
<span><span class="co">#&gt; beta[1]  0.44597696</span></span>
<span><span class="co">#&gt; beta[2] -0.72312083</span></span>
<span><span class="co">#&gt; beta[3]  0.84615054</span></span>
<span><span class="co">#&gt; beta[4] -0.39020070</span></span>
<span><span class="co">#&gt; beta[5]  0.48423148</span></span>
<span><span class="co">#&gt; beta[6]  0.80991762</span></span>
<span><span class="co">#&gt; beta[7] -0.06704874</span></span>
<span><span class="co">#&gt; beta[8] -0.08586970</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="model-specifications">4. Model Specifications<a class="anchor" aria-label="anchor" href="#model-specifications"></a>
</h2>
<p>All models use a logistic link for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>P</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mo>∣</mo><msub><mi>θ</mi><mi>j</mi></msub><mo>,</mo><msub><mtext mathvariant="normal">item</mtext><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\pi_{ij} = P(Y_{ij} = 1 \mid \theta_j, \text{item}_i)</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="rasch-model">4.1 Rasch Model<a class="anchor" aria-label="anchor" href="#rasch-model"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">logit</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>π</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><msub><mi>θ</mi><mi>j</mi></msub><mo>−</mo><msub><mi>β</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">
\text{logit}(\pi_{ij}) = \theta_j - \beta_i
</annotation></semantics></math></p>
<p>The Rasch model has a single item parameter — difficulty
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\beta_i</annotation></semantics></math>.
The response probability depends only on the difference between person
ability and item difficulty.</p>
<p><strong>Identification.</strong> Location indeterminacy only (adding
a constant
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
to all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
leaves the likelihood unchanged). Default:
<code>"constrained_item"</code> (mean-centers
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
during MCMC).</p>
<p><strong>When to use.</strong> Most parsimonious IRT model. Assumes
equal discrimination and no guessing. Stable item estimates even with
modest sample sizes.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_rasch</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span><span class="va">data</span>, model <span class="op">=</span> <span class="st">"rasch"</span>, prior <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="two-parameter-logistic-2pl">4.2 Two-Parameter Logistic (2PL)<a class="anchor" aria-label="anchor" href="#two-parameter-logistic-2pl"></a>
</h3>
<p>Adds a discrimination parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\lambda_i</annotation></semantics></math>.
Two equivalent parameterizations are available.</p>
<p><strong>IRT parameterization:</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">logit</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>π</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><msub><mi>λ</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">(</mo><msub><mi>θ</mi><mi>j</mi></msub><mo>−</mo><msub><mi>β</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{logit}(\pi_{ij}) = \lambda_i(\theta_j - \beta_i)</annotation></semantics></math></p>
<p><strong>Slope–intercept (SI) parameterization:</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">logit</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>π</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><msub><mi>λ</mi><mi>i</mi></msub><msub><mi>θ</mi><mi>j</mi></msub><mo>+</mo><msub><mi>γ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\text{logit}(\pi_{ij}) = \lambda_i \theta_j + \gamma_i</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo>=</mo><mi>−</mi><msub><mi>λ</mi><mi>i</mi></msub><msub><mi>β</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\gamma_i = -\lambda_i \beta_i</annotation></semantics></math>
is an intercept.</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="35%">
<col width="38%">
</colgroup>
<thead><tr class="header">
<th align="left">Feature</th>
<th align="left">IRT</th>
<th align="left">SI</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Formula</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">(</mo><msub><mi>θ</mi><mi>j</mi></msub><mo>−</mo><msub><mi>β</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\lambda_i(\theta_j - \beta_i)</annotation></semantics></math></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>i</mi></msub><msub><mi>θ</mi><mi>j</mi></msub><mo>+</mo><msub><mi>γ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_i \theta_j + \gamma_i</annotation></semantics></math></td>
</tr>
<tr class="even">
<td align="left">Item location</td>
<td align="left">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\beta_i</annotation></semantics></math>
(difficulty)</td>
<td align="left">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\gamma_i</annotation></semantics></math>
(intercept)</td>
</tr>
<tr class="odd">
<td align="left">Interpretation</td>
<td align="left">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\beta_i</annotation></semantics></math>
on theta scale</td>
<td align="left">Baseline log-odds at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\theta = 0</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td align="left">Posterior correlation</td>
<td align="left">Higher
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>–<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>)</td>
<td align="left">Lower
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>–<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>)</td>
</tr>
<tr class="odd">
<td align="left">Centered sampler</td>
<td align="left">Not applicable</td>
<td align="left">Auto-enabled</td>
</tr>
<tr class="even">
<td align="left">Default identification</td>
<td align="left">unconstrained</td>
<td align="left">unconstrained</td>
</tr>
</tbody>
</table>
<p>The SI parameterization reduces posterior correlations between
discrimination and intercept, improving MCMC mixing. DPMirt
automatically enables a centered sampler for SI (Paganin et al.,
2023).</p>
<p><strong>Identification.</strong> Both location and scale
indeterminacy. Default: <code>"unconstrained"</code> + post-hoc
rescaling.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_2pl_irt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span><span class="va">data</span>, model <span class="op">=</span> <span class="st">"2pl"</span>, prior <span class="op">=</span> <span class="st">"dpm"</span><span class="op">)</span></span>
<span><span class="va">fit_2pl_si</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span><span class="va">data</span>, model <span class="op">=</span> <span class="st">"2pl"</span>, prior <span class="op">=</span> <span class="st">"dpm"</span>,</span>
<span>                       parameterization <span class="op">=</span> <span class="st">"si"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="three-parameter-logistic-3pl">4.3 Three-Parameter Logistic (3PL)<a class="anchor" aria-label="anchor" href="#three-parameter-logistic-3pl"></a>
</h3>
<p>Adds a lower-asymptote (guessing) parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mi>i</mi></msub><mo>∈</mo><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\delta_i \in (0, 1)</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>δ</mi><mi>i</mi></msub><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>δ</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo><mspace width="0.167em"></mspace><mtext mathvariant="normal">logistic</mtext><mspace width="-0.167em"></mspace><mo minsize="120%" maxsize="120%" stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">(</mo><msub><mi>θ</mi><mi>j</mi></msub><mo>−</mo><msub><mi>β</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo><mo minsize="120%" maxsize="120%" stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">
\pi_{ij} = \delta_i + (1 - \delta_i)\,\text{logistic}\!\big(\lambda_i(\theta_j - \beta_i)\big)
</annotation></semantics></math></p>
<p>DPMirt places a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Beta</mtext><mo stretchy="false" form="prefix">(</mo><mn>4</mn><mo>,</mo><mn>12</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\text{Beta}(4, 12)</annotation></semantics></math>
prior on each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>δ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\delta_i</annotation></semantics></math>
(prior mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≈</mo><mn>0.25</mn></mrow><annotation encoding="application/x-tex">\approx 0.25</annotation></semantics></math>,
concentrating mass in 0.1–0.4).</p>
<p><strong>Practical recommendations:</strong></p>
<ul>
<li>Use longer chains (20,000+ iterations, 5,000+ burn-in).</li>
<li>Most appropriate for multiple-choice items with genuine
guessing.</li>
<li>Both IRT and SI parameterizations are supported.</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_3pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>, model <span class="op">=</span> <span class="st">"3pl"</span>, prior <span class="op">=</span> <span class="st">"dpm"</span>,</span>
<span>  niter <span class="op">=</span> <span class="fl">20000</span>, nburnin <span class="op">=</span> <span class="fl">5000</span>, seed <span class="op">=</span> <span class="fl">400</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="priors-parametric-vs-semiparametric">5. Priors: Parametric vs Semiparametric<a class="anchor" aria-label="anchor" href="#priors-parametric-vs-semiparametric"></a>
</h2>
<div class="section level3">
<h3 id="normal-parametric-prior">5.1 Normal (Parametric) Prior<a class="anchor" aria-label="anchor" href="#normal-parametric-prior"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>j</mi></msub><mo>∼</mo><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mi>μ</mi><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mspace width="2.0em"></mspace><mi>μ</mi><mo>∼</mo><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>3</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mspace width="2.0em"></mspace><msup><mi>σ</mi><mn>2</mn></msup><mo>∼</mo><mtext mathvariant="normal">Inv-Gamma</mtext><mo stretchy="false" form="prefix">(</mo><mn>2.01</mn><mo>,</mo><mn>1.01</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">
\theta_j \sim N(\mu, \sigma^2), \qquad
\mu \sim N(0, 3), \qquad
\sigma^2 \sim \text{Inv-Gamma}(2.01, 1.01)
</annotation></semantics></math></p>
<p>Standard assumption in most IRT software. Works well when the ability
distribution is approximately unimodal and symmetric.</p>
</div>
<div class="section level3">
<h3 id="dpm-semiparametric-prior">5.2 DPM (Semiparametric) Prior<a class="anchor" aria-label="anchor" href="#dpm-semiparametric-prior"></a>
</h3>
<p>The DPM prior uses the Chinese Restaurant Process (CRP)
representation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>j</mi></msub><mo>∣</mo><mi>α</mi><mo>∼</mo><mtext mathvariant="normal">CRP</mtext><mo stretchy="false" form="prefix">(</mo><mi>α</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mspace width="2.0em"></mspace><msub><mi>θ</mi><mi>j</mi></msub><mo>∣</mo><msub><mi>z</mi><mi>j</mi></msub><mo>∼</mo><mi>N</mi><mspace width="-0.167em"></mspace><mo minsize="120%" maxsize="120%" stretchy="true" form="prefix">(</mo><msub><mover><mi>μ</mi><mo accent="true">̃</mo></mover><msub><mi>z</mi><mi>j</mi></msub></msub><mo>,</mo><mspace width="0.278em"></mspace><msubsup><mover><mi>σ</mi><mo accent="true">̃</mo></mover><msub><mi>z</mi><mi>j</mi></msub><mn>2</mn></msubsup><mo minsize="120%" maxsize="120%" stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">
z_j \mid \alpha \sim \text{CRP}(\alpha), \qquad
\theta_j \mid z_j \sim N\!\big(\tilde{\mu}_{z_j},\; \tilde{\sigma}^2_{z_j}\big)
</annotation></semantics></math></p>
<p>Each cluster
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
draws from the base measure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>G</mi><mn>0</mn></msub><annotation encoding="application/x-tex">G_0</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>μ</mi><mo accent="true">̃</mo></mover><mi>m</mi></msub><mo>∼</mo><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mi>μ</mi><mn>2</mn></msubsup><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mspace width="2.0em"></mspace><msubsup><mover><mi>σ</mi><mo accent="true">̃</mo></mover><mi>m</mi><mn>2</mn></msubsup><mo>∼</mo><mtext mathvariant="normal">Inv-Gamma</mtext><mo stretchy="false" form="prefix">(</mo><msub><mi>ν</mi><mn>1</mn></msub><mo>,</mo><msub><mi>ν</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">
\tilde{\mu}_m \sim N(0, \sigma^2_\mu), \qquad
\tilde{\sigma}^2_m \sim \text{Inv-Gamma}(\nu_1, \nu_2)
</annotation></semantics></math></p>
<p>The concentration parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
controls the expected number of clusters.</p>
</div>
<div class="section level3">
<h3 id="hyperparameter-defaults">5.3 Hyperparameter Defaults<a class="anchor" aria-label="anchor" href="#hyperparameter-defaults"></a>
</h3>
<table class="table">
<colgroup>
<col width="19%">
<col width="15%">
<col width="65%">
</colgroup>
<thead><tr class="header">
<th align="left">Parameter</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><mi>μ</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma^2_\mu</annotation></semantics></math></td>
<td align="left">2</td>
<td align="left">Base measure: cluster mean prior variance</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ν</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\nu_1</annotation></semantics></math></td>
<td align="left">2.01</td>
<td align="left">Base measure: Inv-Gamma shape for cluster variance</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ν</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\nu_2</annotation></semantics></math></td>
<td align="left">1.01</td>
<td align="left">Base measure: Inv-Gamma rate for cluster variance</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math></td>
<td align="left">50</td>
<td align="left">CRP truncation level (maximum clusters)</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></td>
<td align="left">Gamma(1, 3)</td>
<td align="left">Concentration parameter prior (Paganin default)</td>
</tr>
</tbody>
</table>
<p>These can be modified via <code>base_measure</code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span><span class="va">data</span>, model <span class="op">=</span> <span class="st">"rasch"</span>, prior <span class="op">=</span> <span class="st">"dpm"</span>,</span>
<span>              base_measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>s2_mu <span class="op">=</span> <span class="fl">4</span>, nu1 <span class="op">=</span> <span class="fl">2.5</span>, nu2 <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>              M <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="when-to-choose-the-dpm-prior">5.4 When to Choose the DPM Prior<a class="anchor" aria-label="anchor" href="#when-to-choose-the-dpm-prior"></a>
</h3>
<ul>
<li>
<strong>Non-normal populations.</strong> Heterogeneous test-taker
groups (e.g., mixing advanced and introductory students).</li>
<li>
<strong>Multimodal distributions.</strong> Floor/ceiling effects or
distinct subgroups.</li>
<li>
<strong>Exploratory analysis.</strong> When you have little prior
information about the ability distribution shape.</li>
<li>
<strong>Shrinkage calibration.</strong> The DPM prior produces less
severe shrinkage when the true distribution is non-Normal.</li>
</ul>
<p>When the true distribution is Normal, the DPM converges to a single
cluster and reproduces the Normal-prior results with only a modest
computation-time increase.</p>
</div>
<div class="section level3">
<h3 id="normal-vs--dpm-when-normality-fails">5.5 Normal vs. DPM: When Normality Fails<a class="anchor" aria-label="anchor" href="#normal-vs--dpm-when-normality-fails"></a>
</h3>
<p>The guidelines above are easier to appreciate with a concrete
example. The pre-computed bimodal simulation ships with the package: 200
persons drawn from a two-group mixture
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>∼</mo><mn>0.5</mn><mspace width="0.167em"></mspace><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mi>−</mi><mn>1.5</mn><mo>,</mo><mn>0.5</mn><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mn>0.5</mn><mspace width="0.167em"></mspace><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mn>1.5</mn><mo>,</mo><mn>0.5</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\theta \sim 0.5\,N(-1.5, 0.5) +
0.5\,N(1.5, 0.5)</annotation></semantics></math>) assessed on 25 Rasch
items
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>≈</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\bar{w} \approx 0.8</annotation></semantics></math>).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_bm</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">find_extdata</span><span class="op">(</span><span class="st">"vignette_sim_bimodal.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit_bm_n</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">find_extdata</span><span class="op">(</span><span class="st">"vignette_fit_rasch_normal_bimodal.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit_bm_d</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu">find_extdata</span><span class="op">(</span><span class="st">"vignette_fit_rasch_dpm_bimodal.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>WAIC provides a model-level comparison:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dpmirt_compare.html">dpmirt_compare</a></span><span class="op">(</span><span class="va">fit_bm_n</span>, <span class="va">fit_bm_d</span><span class="op">)</span></span>
<span><span class="co">#&gt;          model     waic delta_waic</span></span>
<span><span class="co">#&gt; 1 RASCH-normal 4009.778   0.000000</span></span>
<span><span class="co">#&gt; 2    RASCH-dpm 4010.544   0.766108</span></span></code></pre></div>
<p>In this example the two WAIC values are nearly identical
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi mathvariant="normal">Δ</mi><mtext mathvariant="normal">WAIC</mtext><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">|\Delta\text{WAIC}| &lt; 2</annotation></semantics></math>),
which is expected: WAIC measures predictive accuracy for the <em>binary
responses</em>, and both priors predict item responses equally well. The
DPM’s real advantage shows in the <em>recovered ability
distribution</em> — a difference that WAIC does not capture but the
density plot below makes visually obvious.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">true_theta</span> <span class="op">&lt;-</span> <span class="va">sim_bm</span><span class="op">$</span><span class="va">theta</span></span>
<span><span class="va">pm_normal</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">fit_bm_n</span><span class="op">$</span><span class="va">theta_samp</span><span class="op">)</span></span>
<span><span class="va">pm_dpm</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">fit_bm_d</span><span class="op">$</span><span class="va">theta_samp</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_bm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  value  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">true_theta</span>, <span class="va">pm_normal</span>, <span class="va">pm_dpm</span><span class="op">)</span>,</span>
<span>  source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True"</span>, <span class="st">"Normal (PM)"</span>, <span class="st">"DPM (PM)"</span><span class="op">)</span>,</span>
<span>                      each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">true_theta</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True"</span>, <span class="st">"Normal (PM)"</span>, <span class="st">"DPM (PM)"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_bm</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">source</span>, colour <span class="op">=</span> <span class="va">source</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.25</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True"</span>         <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">reference</span>,</span>
<span>                                <span class="st">"Normal (PM)"</span> <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">parametric</span>,</span>
<span>                                <span class="st">"DPM (PM)"</span>    <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">semiparametric</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True"</span>         <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">reference</span>,</span>
<span>                                  <span class="st">"Normal (PM)"</span> <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">parametric</span>,</span>
<span>                                  <span class="st">"DPM (PM)"</span>    <span class="op">=</span> <span class="va">pal</span><span class="op">$</span><span class="va">semiparametric</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Recovering a Bimodal Population"</span>,</span>
<span>       x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>, legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="models-and-workflow_files/figure-html/bimodal-density-1.png" class="r-plt" alt="True bimodal density (gray) versus posterior mean estimates under Normal (blue) and DPM (orange) priors.  The Normal prior forces a unimodal fit; the DPM prior recovers both modes." width="85%"><p class="caption">
True bimodal density (gray) versus posterior mean estimates under Normal
(blue) and DPM (orange) priors. The Normal prior forces a unimodal fit;
the DPM prior recovers both modes.
</p>
</div>
<blockquote>
<p><strong>Take-away.</strong> When the true distribution departs from
normality, the DPM prior produces posterior mean estimates that track
the true distributional shape far more accurately than the Normal prior.
WAIC may not detect this advantage because it evaluates item-response
prediction, not ability-distribution recovery. For practical guidance on
choosing the posterior summary that best serves your inferential goal,
see <code><a href="../articles/posterior-summaries.html">vignette("posterior-summaries")</a></code>.</p>
</blockquote>
<p><strong>Practical recommendation.</strong> For applied researchers
who suspect non-normality, fit both priors and compare them using (1)
WAIC for item-response prediction and (2) a density plot of posterior
mean estimates for distributional recovery. When the population is truly
non-normal and reliability is at least moderate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‾</mo></mover><mo>≥</mo><mn>0.7</mn></mrow><annotation encoding="application/x-tex">\bar{w} \ge 0.7</annotation></semantics></math>),
the density comparison will typically reveal the DPM’s advantage even
when WAIC values are similar.</p>
</div>
</div>
<div class="section level2">
<h2 id="identification-strategies">6. Identification Strategies<a class="anchor" aria-label="anchor" href="#identification-strategies"></a>
</h2>
<table class="table">
<colgroup>
<col width="18%">
<col width="13%">
<col width="13%">
<col width="54%">
</colgroup>
<thead><tr class="header">
<th align="left">Strategy</th>
<th align="center">Rasch</th>
<th align="center">2PL/3PL</th>
<th align="left">How It Works</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">constrained_ability</td>
<td align="center">Yes</td>
<td align="center">Yes</td>
<td align="left">Fix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>∼</mo><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\theta \sim N(0, 1)</annotation></semantics></math>;
no hyperparameters</td>
</tr>
<tr class="even">
<td align="left">constrained_item</td>
<td align="center">Yes (default)</td>
<td align="center">Yes</td>
<td align="left">Mean-center
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
during MCMC (+ geom-mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda = 1</annotation></semantics></math>)</td>
</tr>
<tr class="odd">
<td align="left">unconstrained</td>
<td align="center">Yes</td>
<td align="center">Yes (default)</td>
<td align="left">No constraints; post-hoc rescaling via
dpmirt_rescale()</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Paganin’s finding.</strong> The unconstrained + post-hoc
rescaling approach yields the most efficient MCMC sampler for DPM-IRT
models. <code>constrained_ability</code> is
<strong>incompatible</strong> with the DPM prior (DPMirt will raise an
error) since the DPM’s purpose is to learn the ability distribution from
data.</p>
</blockquote>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Rasch with unconstrained + post-hoc rescaling</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span><span class="va">data</span>, model <span class="op">=</span> <span class="st">"rasch"</span>, prior <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>              identification <span class="op">=</span> <span class="st">"unconstrained"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2PL with in-model constrained_item centering</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span><span class="va">data</span>, model <span class="op">=</span> <span class="st">"2pl"</span>, prior <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>              identification <span class="op">=</span> <span class="st">"constrained_item"</span><span class="op">)</span></span></code></pre></div>
<p><strong>How to choose.</strong> For DPM models, use the defaults
(<code>"constrained_item"</code> for Rasch, <code>"unconstrained"</code>
for 2PL/3PL). For Normal-prior models all three are valid;
<code>"constrained_ability"</code> gives the strongest
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">N(0,1)</annotation></semantics></math>
shrinkage.</p>
</div>
<div class="section level2">
<h2 id="chain-continuation">7. Chain Continuation<a class="anchor" aria-label="anchor" href="#chain-continuation"></a>
</h2>
<p>When an initial run needs more iterations,
<code><a href="../reference/dpmirt_resume.html">dpmirt_resume()</a></code> continues the sampler from its current
state without recompilation.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Initial fit</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span><span class="va">data</span>, model <span class="op">=</span> <span class="st">"rasch"</span>, prior <span class="op">=</span> <span class="st">"dpm"</span>,</span>
<span>              niter <span class="op">=</span> <span class="fl">5000</span>, nburnin <span class="op">=</span> <span class="fl">1000</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Trace looks non-stationary...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"trace"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Resume: add 10,000 more iterations (no burn-in needed)</span></span>
<span><span class="va">resumed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_resume.html">dpmirt_resume</a></span><span class="op">(</span><span class="va">fit</span>, niter_more <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></code></pre></div>
<p>With the step-by-step workflow:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_sample.html">dpmirt_sample</a></span><span class="op">(</span><span class="va">compiled</span>, niter <span class="op">=</span> <span class="fl">5000</span>, nburnin <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">resumed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_resume.html">dpmirt_resume</a></span><span class="op">(</span><span class="va">compiled</span>, niter_more <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p><code><a href="../reference/dpmirt_resume.html">dpmirt_resume()</a></code> requires the compiled model’s C++
pointers to be alive (same R session). If pointers are expired,
recompile.</p>
</blockquote>
<p>The returned <code>dpmirt_samples</code> object can then be passed
through <code><a href="../reference/dpmirt_rescale.html">dpmirt_rescale()</a></code> (which returns a
<code>dpmirt_fit</code>) and <code><a href="../reference/dpmirt_estimates.html">dpmirt_estimates()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="model-comparison-with-waic">8. Model Comparison with WAIC<a class="anchor" aria-label="anchor" href="#model-comparison-with-waic"></a>
</h2>
<p>Every <code>dpmirt_fit</code> stores a WAIC (Watanabe–Akaike
Information Criterion) value, computed automatically during sampling.
<strong>Lower WAIC indicates better out-of-sample
prediction.</strong></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_compare.html">dpmirt_compare</a></span><span class="op">(</span><span class="va">fit_rasch_n</span>, <span class="va">fit_rasch_dpm</span><span class="op">)</span></span>
<span><span class="va">comparison</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt_compare.html">dpmirt_compare</a></span><span class="op">(</span><span class="va">fit_rasch_n</span>, <span class="va">fit_rasch_dpm</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">comparison</span>, digits <span class="op">=</span> <span class="fl">2</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">model</th>
<th align="right">waic</th>
<th align="right">delta_waic</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">RASCH-dpm</td>
<td align="right">6078.17</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">RASCH-normal</td>
<td align="right">6079.03</td>
<td align="right">0.86</td>
</tr>
</tbody>
</table>
<p>The <code>delta_waic</code> column shows the difference from the best
model. You can compare any number of fits:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dpmirt_compare.html">dpmirt_compare</a></span><span class="op">(</span><span class="va">fit_rasch_n</span>, <span class="va">fit_rasch_dpm</span>, <span class="va">fit_2pl</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p><strong>Interpreting WAIC differences.</strong></p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi mathvariant="normal">Δ</mi><mtext mathvariant="normal">WAIC</mtext><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">|\Delta\text{WAIC}| &lt; 2</annotation></semantics></math>:
Models essentially equivalent.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>&lt;</mo><mo stretchy="false" form="prefix">|</mo><mi mathvariant="normal">Δ</mi><mtext mathvariant="normal">WAIC</mtext><mo stretchy="false" form="prefix">|</mo><mo>&lt;</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">2 &lt; |\Delta\text{WAIC}| &lt; 10</annotation></semantics></math>:
Moderate preference.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">|</mo><mi mathvariant="normal">Δ</mi><mtext mathvariant="normal">WAIC</mtext><mo stretchy="false" form="prefix">|</mo><mo>&gt;</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">|\Delta\text{WAIC}| &gt; 10</annotation></semantics></math>:
Strong preference.</li>
</ul>
</blockquote>
</div>
<div class="section level2">
<h2 id="data-formats">9. Data Formats<a class="anchor" aria-label="anchor" href="#data-formats"></a>
</h2>
<div class="section level3">
<h3 id="matrix-format-default">Matrix Format (Default)<a class="anchor" aria-label="anchor" href="#matrix-format-default"></a>
</h3>
<p>Binary matrix with persons in rows and items in columns. Missing
responses coded as <code>NA</code>.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">response</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></span>
<span><span class="co">#&gt; [1,]    1    0    1    1    0    1</span></span>
<span><span class="co">#&gt; [2,]    0    1    0    1    1    0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="long-format">Long Format<a class="anchor" aria-label="anchor" href="#long-format"></a>
</h3>
<p>A data.frame with columns for person, item, and response. DPMirt
detects the format automatically and converts internally.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">response_long</span><span class="op">)</span></span>
<span><span class="co">#&gt;   person item response</span></span>
<span><span class="co">#&gt; 1      1    1        1</span></span>
<span><span class="co">#&gt; 2      1    2        0</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dpmirt.html">dpmirt</a></span><span class="op">(</span><span class="va">response_long</span>, model <span class="op">=</span> <span class="st">"rasch"</span>, prior <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>If the long-to-matrix conversion produces a very large or sparse
matrix, verify dimensions with <code><a href="../reference/dpmirt_spec.html">dpmirt_spec()</a></code> before running
the full pipeline.</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="visualizations">10. Visualizations<a class="anchor" aria-label="anchor" href="#visualizations"></a>
</h2>
<p>DPMirt provides 12 plot types via <code>plot(fit, type = ...)</code>.
When <strong>ggplot2</strong> is installed it is used automatically;
otherwise base R graphics are produced.</p>
<table class="table">
<thead><tr class="header">
<th align="left">Type</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">density</td>
<td align="left">Kernel density of posterior mean theta</td>
</tr>
<tr class="even">
<td align="left">items</td>
<td align="left">Item parameter estimates with posterior intervals</td>
</tr>
<tr class="odd">
<td align="left">trace</td>
<td align="left">Log-likelihood trace (convergence diagnostic)</td>
</tr>
<tr class="even">
<td align="left">clusters</td>
<td align="left">Active cluster count trace and posterior (DPM
only)</td>
</tr>
<tr class="odd">
<td align="left">dp_density</td>
<td align="left">DP mixture density with credible band (DPM only)</td>
</tr>
<tr class="even">
<td align="left">icc</td>
<td align="left">Item Characteristic Curves</td>
</tr>
<tr class="odd">
<td align="left">wright_map</td>
<td align="left">Wright map: items and persons on common logit
scale</td>
</tr>
<tr class="even">
<td align="left">parameter_trace</td>
<td align="left">Trace plots for individual parameters</td>
</tr>
<tr class="odd">
<td align="left">caterpillar</td>
<td align="left">Caterpillar plot of sorted estimates with CIs</td>
</tr>
<tr class="even">
<td align="left">density_compare</td>
<td align="left">Overlaid densities from two fits</td>
</tr>
<tr class="odd">
<td align="left">info</td>
<td align="left">Test and item information functions (2PL/3PL)</td>
</tr>
<tr class="even">
<td align="left">pp_check</td>
<td align="left">Posterior predictive check</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_rasch_dpm</span>, type <span class="op">=</span> <span class="st">"density"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="models-and-workflow_files/figure-html/plot-density-guide-1.png" class="r-plt" alt="Posterior density of person abilities." width="85%"><p class="caption">
Posterior density of person abilities.
</p>
</div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_rasch_dpm</span>, type <span class="op">=</span> <span class="st">"items"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="models-and-workflow_files/figure-html/plot-items-guide-1.png" class="r-plt" alt="Item difficulty estimates with posterior intervals." width="85%"><p class="caption">
Item difficulty estimates with posterior intervals.
</p>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_rasch_dpm</span>, type <span class="op">=</span> <span class="st">"trace"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="models-and-workflow_files/figure-html/plot-trace-guide-1.png" class="r-plt" alt="Log-likelihood trace." width="85%"><p class="caption">
Log-likelihood trace.
</p>
</div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_rasch_dpm</span>, type <span class="op">=</span> <span class="st">"icc"</span>, items <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="models-and-workflow_files/figure-html/plot-icc-guide-1.png" class="r-plt" alt="Item Characteristic Curves for items 1--6." width="85%"><p class="caption">
Item Characteristic Curves for items 1–6.
</p>
</div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_rasch_dpm</span>, type <span class="op">=</span> <span class="st">"wright_map"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="models-and-workflow_files/figure-html/plot-wright-guide-1.png" class="r-plt" alt="Wright map." width="85%"><p class="caption">
Wright map.
</p>
</div>
</div>
<div class="section level2">
<h2 id="summary-and-whats-next">11. Summary and What’s Next?<a class="anchor" aria-label="anchor" href="#summary-and-whats-next"></a>
</h2>
<p>This vignette covered the full model and workflow space in
DPMirt:</p>
<ul>
<li>
<strong>Two workflow modes</strong>: one-step <code><a href="../reference/dpmirt.html">dpmirt()</a></code>
and the step-by-step pipeline for compile-once sampling.</li>
<li>
<strong>Three IRT models</strong>: Rasch, 2PL, and 3PL, each with
Normal or DPM priors.</li>
<li>
<strong>Two parameterizations</strong> for 2PL/3PL: IRT and
slope–intercept.</li>
<li>
<strong>Three identification strategies</strong>:
constrained_ability, constrained_item, and unconstrained + post-hoc
rescaling.</li>
<li>
<strong>Chain continuation</strong> with
<code><a href="../reference/dpmirt_resume.html">dpmirt_resume()</a></code>.</li>
<li>
<strong>Model comparison</strong> with WAIC via
<code><a href="../reference/dpmirt_compare.html">dpmirt_compare()</a></code>.</li>
<li>
<strong>Twelve built-in plot types</strong> for posterior
visualization.</li>
</ul>
<table class="table">
<colgroup>
<col width="18%">
<col width="18%">
<col width="63%">
</colgroup>
<thead><tr class="header">
<th align="left">Topic</th>
<th align="left">Vignette</th>
<th align="left">What</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Choosing an estimator</td>
<td align="left"><em>Posterior Summaries</em></td>
<td align="left">In-depth PM vs CB vs GR comparison; shrinkage
diagnostics; loss evaluation</td>
</tr>
<tr class="even">
<td align="left">Setting DPM priors</td>
<td align="left"><em>Prior Elicitation</em></td>
<td align="left">Principled choice of the concentration parameter via
DPprior</td>
</tr>
<tr class="odd">
<td align="left">NIMBLE internals</td>
<td align="left"><em>NIMBLE Internals</em></td>
<td align="left">Customizing samplers, NIMBLE compilation model,
advanced tuning</td>
</tr>
</tbody>
</table>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/joonho112" class="external-link">JoonHo Lee</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
